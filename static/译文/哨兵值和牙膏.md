# {å“¨å…µå€¼å’Œç‰™è†}(The sentinel toothpaste: a useful programming technique for everyday life)

åŸæ–‡é“¾æ¥ï¼š[The sentinel toothpaste: a useful programming technique for everyday life](https://dunkels.com/adam/sentinel-toothpaste/)

- - -

è¿™æ˜¯æˆ‘åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­å‘ç°çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç¼–ç¨‹æŠ€å·§ï¼š[å“¨å…µå€¼](https://en.wikipedia.org/wiki/Sentinel_value)ã€‚æˆ‘æ¯å¤©ä½¿ç”¨è¿™ä¸ªæŠ€å·§æ¥ç®¡ç†æˆ‘çš„ç‰™è†ã€‚

åœ¨ç¼–ç¨‹ä¸­ï¼Œå“¨å…µå€¼å¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªåˆ—è¡¨çš„æœ«å°¾ã€‚å½“ä½ æœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œä½ å¯ä»¥å°†åˆ—è¡¨çš„æœ€åä¸€é¡¹å…ƒç´ è®¾ä¸ºä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œè¿™æ ·ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çŸ¥é“ä½ æ˜¯å¦éå†åˆ°äº†åˆ—è¡¨çš„æœ«å°¾ï¼šå½“ä½ éå†åˆ°çš„å€¼æ˜¯é‚£ä¸ªç‰¹æ®Šå€¼ï¼Œä½ å°±éå†åˆ°åˆ—è¡¨çš„æœ«å°¾ã€‚

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Emoji çš„å¯è§†åŒ–è¡¨ç¤ºï¼š

| ğŸ˜€ | ğŸ¥° | ğŸ˜ | ğŸ¤— | ğŸ™„ | ğŸ˜œ | ğŸ˜®â€ğŸ’¨ | ğŸˆ |

ä¸Šé¢è¡¨æ ¼ä¸­çš„çŒ«çŒ«ä¸æ˜¯ä¸ªç¬‘è„¸ï¼ˆå’Œå…¶å®ƒè¡¨æƒ…ä¸åŒï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨çŒ«çŒ«è¡¨æƒ…æ¥è¡¨ç¤ºè¿™ä¸ªåˆ—è¡¨çš„æœ«å°¾ã€‚

## ä¸€ä¸ªå…¸å‹ç”¨ä¾‹

è¿™ä¸ªç¼–ç¨‹æŠ€å·§çš„ä¸€ä¸ªå…¸å‹ç”¨ä¾‹å°±æ˜¯ï¼ˆC è¯­è¨€ä¸­ï¼‰ä½¿ç”¨å­—ç¬¦ ``\0`` ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚è¦è®¡ç®—è¿™ç§å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥éå†å­—ç¬¦ä¸²ç›´åˆ°æ‰¾åˆ° null å­—ç¬¦ï¼Œè¿™é‡Œçš„ null å­—ç¬¦å°±æ˜¯å“¨å…µå€¼ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªå€¼ä¸º ``String`` çš„å­—ç¬¦ä¸²ï¼Œå…¶æœ€åçš„ ``\0`` å­—ç¬¦å°±æ˜¯å­—ç¬¦ä¸²çš„å“¨å…µå€¼ï¼š

| S | t | r | i | n | g | \0 |

## å¦ä¸€ä¸ªå…¸å‹ç”¨ä¾‹

å¦ä¸€ä¸ªå…¸å‹ç”¨ä¾‹å°±æ˜¯é“¾è¡¨æ•°æ®ç»“æ„ä¸­çš„ ``null`` å€¼æŒ‡é’ˆã€‚å¦‚æœæ‰€æœ‰é“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®éƒ½ä¸ä¸º ``null``ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ``null`` å€¼æŒ‡é’ˆæ¥è¡¨ç¤ºé“¾è¡¨çš„ç»“æŸã€‚

## å“¨å…µå€¼å’Œç‰™è†

æˆ‘å‘ç°è¿™ä¸ªç¼–ç¨‹æŠ€å·§å¯¹äºæ—¥å¸¸ç”Ÿæ´»æå…¶æœ‰ç”¨ï¼Œæ¯”å¦‚ï¼Œç”¨æ¥ç®¡ç†ç‰™è†ç®¡ã€‚

å½“ä½ åˆ·ç‰™çš„æ—¶å€™å‘ç°ç‰™è†ç”¨å®Œé€šå¸¸ä¸æ˜¯ä»¶å¥½äº‹ã€‚æ‰€ä»¥å½“æˆ‘ä¹°ç‰™è†æ—¶ï¼Œæˆ‘æ€»æ˜¯ä¹°è®¸å¤šï¼Œå¹¶ä¸”æ€»æ˜¯ç¡®ä¿å…¶ä¸­ä¸€ç®¡å’Œå…¶å®ƒçš„ï¼ˆå¤–è§‚ï¼‰ä¸åŒï¼Œè¿™å°±æ˜¯å“¨å…µç‰™è†ã€‚

![å“¨å…µç‰™è†](.å“¨å…µå€¼å’Œç‰™è†/sentinel-toothpaste.jpg)

è¿™æ ·ï¼Œå½“æˆ‘å‘ç°åªå‰©ä¸‹è¿™ç®¡ç‰¹æ®Šçš„å“¨å…µç‰™è†æ—¶ï¼Œæˆ‘å°±çŸ¥é“æˆ‘éœ€è¦ä¹°ç‰™è†äº†ï¼Œå¹¶ä¸”æˆ‘è¿˜æœ‰å……è¶³çš„æ—¶é—´ã€‚

## æˆ‘å¦‚ä½•å­¦åˆ°è¿™ä¸ªæŠ€å·§

æˆ‘ç¬¬ä¸€æ¬¡çŸ¥é“è¿™ä¸ªå“¨å…µå€¼æŠ€å·§æ˜¯åœ¨çŸ¥åçš„è®¡ç®—æœºç§‘å­¦å®¶å…¼æ•™æˆ [Lennart Andersson](https://cs.lth.se/lennart-andersson/) çš„ç¼–ç¨‹è¯¾ä¸Šï¼Œè¿™ä¹Ÿæ˜¯æˆ‘çš„ç¬¬ä¸€é—¨è®¡ç®—æœºç§‘å­¦è¯¾å’Œç¼–ç¨‹è¯¾ã€‚æˆ‘ä»ä»–é‚£å­¦åˆ°äº†å¾ˆå¤šæå…¶æœ‰ç”¨çš„ç¼–ç¨‹æŠ€å·§ï¼Œè¿™äº›æŠ€å·§åœ¨æˆ‘çš„èŒä¸šç”Ÿæ¶¯ä¸­ä¹Ÿå‘æŒ¥äº†å¾ˆå¤§çš„ç”¨å¤„ã€‚ä½†å“¨å…µå€¼æ˜¯å”¯ä¸€çš„ä¸€ä¸ªæˆ‘å‘ç°åœ¨è®¡ç®—æœºç¼–ç¨‹ä¹‹å¤–ï¼Œåœ¨ç”Ÿæ´»ä¸­ä¹Ÿååˆ†æœ‰ç”¨çš„æŠ€å·§ã€‚

- - -

> è¯‘è€…æ³¨ï¼šåé¢è¿˜æœ‰ä¸€äº›ä½œè€…ä» Lennart æ•™æˆå­¦åˆ°çš„ä¸œè¥¿ï¼Œä¸ªäººè§‰å¾—ç”¨å¤„ä¸å¤§ï¼Œå°±ä¸ç¿»è¯‘äº†ï¼Œç›´æ¥è´´åŸæ–‡ã€‚

Here are a few of the useful things I learned from Lennart:

- How to efficiently write parsers for formal languages, such as mathematical expressions and programming languages.
- How satisfyingly compact functional programming techniques can be, particularly with map, reduce, and filter operations, even in imperative languages.
- That (some) printers werenâ€™t just dumb devices that would print bitmaps, but that they were running a fully-fledged language called PostScript. So you could manually write a piece of code that you could send to the printer, which would run it and generate output â€“ on the paper. What a realization!
- How to avoid comparing floating point values directly with each other â€“ instead, subtract them from each other and check that the difference is small. That is, instead of checking a == b, check abs(a - b) < 0.0001 (or some other small quantity). This is a nifty way to protect against small numerical errors in floating point repressentation.
- The importance of external vs internal repressentation of data structures: we were given a lab assignment to write a small Excel/VisiCalc clone. We were free to do it in any way we wanted, with one exception â€“ we were not allowed to use a two-dimensional array to repressent the contents of the sheet. The purpose was to teach us that the externally visible repressentation (a two-dimensional sheet of cells) was in no way related to the best way to repressent the same data internally, inside our program. This has stuck with me ever since.
