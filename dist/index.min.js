import t from"../build.config.js";let e=null;async function s(t){return e&&e.abort(),e=new AbortController,await fetch(t,{signal:e.signal}).then((async t=>{const s=await t.json();return e=null,s})).catch((e=>(console.log("JSON request error: "+t),console.error(e),null)))}const n=t.language,i=["zh","en"];const r=function(t){for(const[e,s]of Object.entries(i))if(t===s)return(...t)=>t[e];return console.warn("Unexpected language: "+t),(...t)=>t[1]}(n);class a extends Error{constructor(t){super(),this.message=`"${t}" is a abstract method that should be overrided.`}}class o{static loadErrMsg=r("加载失败","load error");static renderErrMsg=r("渲染失败","render error");name="";_module=null;_targetElList=null;async importModule(t){throw new a("importModule")}async beforeRender(t){}renderItem(t){throw new a("renderItem")}renderAll(t){for(const t of this._targetElList())try{this.renderItem(t)}catch(e){this.renderErrResolver(e,t)}}loadErrResolver(t){console.error(t),this._targetElList().forEach((t=>t.textContent=this.name+" "+o.loadErrMsg))}renderErrResolver(t,e){console.error(t),e.textContent=this.name+" "+o.renderErrMsg}async render(t){if(null===this._module)try{this._module=await this.importModule(t)}catch(t){return void this.loadErrResolver(t)}await this.beforeRender(t),this.renderAll(t)}}function l(t){const e=document.createElement("link");e.rel="stylesheet",e.href=t,document.head.appendChild(e)}const c=new class extends o{name="Highlight.js";_targetElList=()=>document.querySelectorAll("pre.code-block code");constructor(){super()}async#t(t=[]){const e=t.filter((t=>!this._module.getLanguage(t))).map((t=>function(t){switch(t){case"../../libs/highlight-es/languages/armasm.js":return import("./libs/highlight-es/languages/armasm.js");case"../../libs/highlight-es/languages/asciidoc.js":return import("./libs/highlight-es/languages/asciidoc.js");case"../../libs/highlight-es/languages/bash.js":return import("./libs/highlight-es/languages/bash.js");case"../../libs/highlight-es/languages/c.js":return import("./libs/highlight-es/languages/c.js");case"../../libs/highlight-es/languages/clojure.js":return import("./libs/highlight-es/languages/clojure.js");case"../../libs/highlight-es/languages/cmake.js":return import("./libs/highlight-es/languages/cmake.js");case"../../libs/highlight-es/languages/cpp.js":return import("./libs/highlight-es/languages/cpp.js");case"../../libs/highlight-es/languages/csharp.js":return import("./libs/highlight-es/languages/csharp.js");case"../../libs/highlight-es/languages/css.js":return import("./libs/highlight-es/languages/css.js");case"../../libs/highlight-es/languages/dart.js":return import("./libs/highlight-es/languages/dart.js");case"../../libs/highlight-es/languages/django.js":return import("./libs/highlight-es/languages/django.js");case"../../libs/highlight-es/languages/dockerfile.js":return import("./libs/highlight-es/languages/dockerfile.js");case"../../libs/highlight-es/languages/elixir.js":return import("./libs/highlight-es/languages/elixir.js");case"../../libs/highlight-es/languages/erlang.js":return import("./libs/highlight-es/languages/erlang.js");case"../../libs/highlight-es/languages/excel.js":return import("./libs/highlight-es/languages/excel.js");case"../../libs/highlight-es/languages/go.js":return import("./libs/highlight-es/languages/go.js");case"../../libs/highlight-es/languages/gradle.js":return import("./libs/highlight-es/languages/gradle.js");case"../../libs/highlight-es/languages/groovy.js":return import("./libs/highlight-es/languages/groovy.js");case"../../libs/highlight-es/languages/haml.js":return import("./libs/highlight-es/languages/haml.js");case"../../libs/highlight-es/languages/haskell.js":return import("./libs/highlight-es/languages/haskell.js");case"../../libs/highlight-es/languages/http.js":return import("./libs/highlight-es/languages/http.js");case"../../libs/highlight-es/languages/ini.js":return import("./libs/highlight-es/languages/ini.js");case"../../libs/highlight-es/languages/java.js":return import("./libs/highlight-es/languages/java.js");case"../../libs/highlight-es/languages/javascript.js":return import("./libs/highlight-es/languages/javascript.js");case"../../libs/highlight-es/languages/json.js":return import("./libs/highlight-es/languages/json.js");case"../../libs/highlight-es/languages/julia.js":return import("./libs/highlight-es/languages/julia.js");case"../../libs/highlight-es/languages/kotlin.js":return import("./libs/highlight-es/languages/kotlin.js");case"../../libs/highlight-es/languages/latex.js":return import("./libs/highlight-es/languages/latex.js");case"../../libs/highlight-es/languages/less.js":return import("./libs/highlight-es/languages/less.js");case"../../libs/highlight-es/languages/lisp.js":return import("./libs/highlight-es/languages/lisp.js");case"../../libs/highlight-es/languages/llvm.js":return import("./libs/highlight-es/languages/llvm.js");case"../../libs/highlight-es/languages/lua.js":return import("./libs/highlight-es/languages/lua.js");case"../../libs/highlight-es/languages/makefile.js":return import("./libs/highlight-es/languages/makefile.js");case"../../libs/highlight-es/languages/markdown.js":return import("./libs/highlight-es/languages/markdown.js");case"../../libs/highlight-es/languages/mathematica.js":return import("./libs/highlight-es/languages/mathematica.js");case"../../libs/highlight-es/languages/matlab.js":return import("./libs/highlight-es/languages/matlab.js");case"../../libs/highlight-es/languages/nginx.js":return import("./libs/highlight-es/languages/nginx.js");case"../../libs/highlight-es/languages/nim.js":return import("./libs/highlight-es/languages/nim.js");case"../../libs/highlight-es/languages/nix.js":return import("./libs/highlight-es/languages/nix.js");case"../../libs/highlight-es/languages/objectivec.js":return import("./libs/highlight-es/languages/objectivec.js");case"../../libs/highlight-es/languages/ocaml.js":return import("./libs/highlight-es/languages/ocaml.js");case"../../libs/highlight-es/languages/perl.js":return import("./libs/highlight-es/languages/perl.js");case"../../libs/highlight-es/languages/php.js":return import("./libs/highlight-es/languages/php.js");case"../../libs/highlight-es/languages/powershell.js":return import("./libs/highlight-es/languages/powershell.js");case"../../libs/highlight-es/languages/python.js":return import("./libs/highlight-es/languages/python.js");case"../../libs/highlight-es/languages/ruby.js":return import("./libs/highlight-es/languages/ruby.js");case"../../libs/highlight-es/languages/rust.js":return import("./libs/highlight-es/languages/rust.js");case"../../libs/highlight-es/languages/scala.js":return import("./libs/highlight-es/languages/scala.js");case"../../libs/highlight-es/languages/scss.js":return import("./libs/highlight-es/languages/scss.js");case"../../libs/highlight-es/languages/shell.js":return import("./libs/highlight-es/languages/shell.js");case"../../libs/highlight-es/languages/sql.js":return import("./libs/highlight-es/languages/sql.js");case"../../libs/highlight-es/languages/stata.js":return import("./libs/highlight-es/languages/stata.js");case"../../libs/highlight-es/languages/stylus.js":return import("./libs/highlight-es/languages/stylus.js");case"../../libs/highlight-es/languages/swift.js":return import("./libs/highlight-es/languages/swift.js");case"../../libs/highlight-es/languages/toml.js":return import("./libs/highlight-es/languages/toml.js");case"../../libs/highlight-es/languages/typescript.js":return import("./libs/highlight-es/languages/typescript.js");case"../../libs/highlight-es/languages/vim.js":return import("./libs/highlight-es/languages/vim.js");case"../../libs/highlight-es/languages/wasm.js":return import("./libs/highlight-es/languages/wasm.js");case"../../libs/highlight-es/languages/x86asm.js":return import("./libs/highlight-es/languages/x86asm.js");case"../../libs/highlight-es/languages/xml.js":return import("./libs/highlight-es/languages/xml.js");case"../../libs/highlight-es/languages/xquery.js":return import("./libs/highlight-es/languages/xquery.js");case"../../libs/highlight-es/languages/yaml.js":return import("./libs/highlight-es/languages/yaml.js");default:return new Promise((function(e,s){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))}))}}(`../../libs/highlight-es/languages/${t.toLowerCase()}.js`)));await Promise.all(e).then((e=>e.forEach(((e,s)=>{const n=t[s],i=e.default;this._module.registerLanguage(n,i)})))).catch(this.loadErrResolver)}renderItem(t){this._module.highlightElement(t)}async beforeRender(t=new Set){await this.#t(Array.from(t))}async importModule(){l("./dist/libs/highlight-es/github-dark.css");return(await import("./libs/highlight-es/highlight.min.js")).default}};var h=c.render.bind(c);const{katexOptions:g}=t;const u=new class extends o{name="KaTeX";_targetElList=()=>document.querySelectorAll(".math");constructor(){super()}renderErrResolver(t,e){t instanceof this._module.ParseError?e.innerHTML=("Error in LaTeX '"+texString+"': "+t.message).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):(e.textContent=this.name+" "+o.renderErrMsg,console.error(t))}renderItem(t){const e=t.textContent;this._module.render(e,t,g)}async importModule(){l("./dist/libs/katex/katex.min.css");return(await import("./libs/katex/katex.min.js")).default}};var d=u.render.bind(u);const p=new class{events=new Map;emit(t,...e){const s=this.events.get(t);s&&s.forEach((t=>{t.apply(null,e)}))}on(t,e){const s=this.events.get(t);s?s.push(e):this.events.set(t,[e])}off(t,e){const s=this.events.get(t);if(s)if(1===s.length)this.events.delete(t);else{const t=s.indexOf(e);s.splice(t,1)}}};function m(t={},e={}){for(const s of Object.keys(e))s in t?"object"==typeof t[s]&&m(t[s],e[s]):t[s]=e[s];return t}class b extends o{static loadErrMsg=r("图表加载失败","Chart load error");static renderErrMsg=r("图表渲染失败","Chart render error");name=void 0;loadErrResolver(t){console.error(t),this._targetElList().forEach((t=>t.textContent=b.loadErrMsg))}renderErrResolver(t,e){console.error(t),e.textContent=b.renderErrMsg}renderItem(t,e){throw new a("renderItem")}renderAll(){for(const t of this._targetElList()){const e=t.__ChartContent__;try{this.renderItem(t,e)}catch(e){this.renderErrResolver(e,t)}}}}let[f,w,j]=[null,null,null];const y=t.echartsOptions;function _(t={},e){const s=["color","backgroundColor","darkMode","textStyle","aria","axisPointer","animation","animationThreshold","animationDuration","animationEasing","animationDelay","animationDurationUpdate","animationEasingUpdate","animationDelayUpdate","stateAnimation","blendMode","hoverLayerThreshold","options","useUTC","media"];for(const n in t)if(!s.includes(n))if("series"!==n){switch(n){case"xAxis":case"yAxis":e.components.add("grid");continue;case"radiusAxis":case"angleAxis":e.components.add("polar");continue;case"parallelAxis":e.components.add("parallel");continue}e.components.add(n)}else for(const s of t.series)"type"in s&&e.charts.add(s.type)}const v=new class extends b{_targetElList=()=>document.querySelectorAll(".echarts-container");#e=new MutationObserver((t=>{for(const t of this._targetElList())this._module.dispose(t),this.renderItem(t)}));#s(){this._targetElList().forEach((t=>f.getInstanceByDom(t).resize()))}renderItem(t){const e=document.body.classList.contains("dark")?"another-dark":"light",s=this._module.init(t,e),n=t.__ChartOptions__,i=m({},y),r=m(i,n);s.setOption(r)}async beforeRender(){const t=Array.from(this._targetElList()).map((t=>t.__ChartOptions__));try{await async function(t){const e={charts:new Set,components:new Set};_(y,e),t.forEach((t=>_(t,e)));const s=Array.from(e.charts).map(w),n=Array.from(e.components).map(j);await Promise.all(s.concat(n)).then(f.use)}(t)}catch(t){this.loadErrResolver(t)}}async importModule(){const[t,e]=await Promise.all([import("./libs/echarts/core.js"),import("./chunks/echartsAnotherDarkTheme.min.js")]);f=t.default,w=t.importChart,j=t.importComponent,f.registerTheme("another-dark",e.default);const s=document.body;return this.#e.observe(s,{attributes:!0,attributeFilter:["class"]}),p.on("catalog-toggle",(()=>{setTimeout(this.#s.bind(this),1e3)})),window.addEventListener("resize",function(t,e){let s=null;return function(...n){s&&clearTimeout(s),s=setTimeout((()=>t(...n)),e)}}(this.#s.bind(this),200)),f}};var L=v.render.bind(v);function T(t,e){const s=document.createElement("script");return s.src=t,s.type="text/javascript",document.head.appendChild(s),new Promise(((n,i)=>{s.onload=function(){if(!(e in globalThis)){const t=`Module ${e} does not support this import method.`;console.error(t),i(t)}const t=globalThis[e];globalThis[e]=void 0,n(t)},s.onerror=function(s){console.error(`Error loading dynamically imported module "${e}": ${t}`),i(s)}}))}globalThis.raphael=null;const{flowchartOptions:x}=t;const E=new class extends b{_targetElList=()=>document.querySelectorAll(".flowchart-container");constructor(){super()}renderItem(t,e){this._module.parse(e).drawSVG(t,x)}async importModule(){globalThis.raphael=await T("./dist/libs/flowchart.js/raphael.min.js","raphael");return await T("./dist/libs/flowchart.js/flowchart.min.js","flowchart")}};var k=E.render.bind(E);const C=new class extends b{_targetElList=()=>document.querySelectorAll(".sequencechart-container");constructor(){super()}renderItem(t,e){const s=new this._module(e);t.appendChild(s.dom())}async importModule(){return(await import("./libs/sequence-diagram/sequence-diagram-web.mjs")).SequenceDiagram}};var M=C.render.bind(C);const{language:q,ganttOptions:S}=t;"language"in S||(S.language=q);const H=new class extends b{_targetElList=()=>document.querySelectorAll(".ganttchart-container");renderItem(t,e){new this._module(t,e,S)}async importModule(){l("./dist/libs/frappe-gantt/frappe-gantt.min.css");return(await import("./libs/frappe-gantt/frappe-gantt.min.js")).default}};var A=H.render.bind(H);const{railroadOptions:O}=t;const R=new class extends b{_targetElList=()=>document.querySelectorAll(".railroad-container");renderItem(t,e){const s=this._module.concat(t);new Function("Diagram","ComplexDiagram","Sequence","Stack","OptionalSequence","AlternatingSequence","Choice","HorizontalChoice","MultipleChoice","Optional","OneOrMore","ZeroOrMore","Group","Start","End","Terminal","NonTerminal","Comment","Skip","Block","targetElement",e+".addTo(targetElement)").apply(null,s)}async importModule(){l("./dist/libs/railroad-diagrams/railroad.css");const t=await import("./libs/railroad-diagrams/railroad.min.js"),{default:e,Options:s}=t;return Object.assign(s,{VS:O.verticalGap,AR:O.arcRadius,INTERNAL_ALIGNMENT:O.internalAlignment,CHAR_WIDTH:O.charWidth,COMMENT_CHAR_WIDTH:O.commentCharWidth}),[e.Diagram,e.ComplexDiagram,e.Sequence,e.Stack,e.OptionalSequence,e.AlternatingSequence,e.Choice,e.HorizontalChoice,e.MultipleChoice,e.Optional,e.OneOrMore,e.ZeroOrMore,e.Group,e.Start,e.End,e.Terminal,e.NonTerminal,e.Comment,e.Skip,e.Block]}};var I=R.render.bind(R);const{qrcodeOptions:N}=t;const $=new class extends b{_targetElList=()=>document.querySelectorAll(".qrcode-container");#e=new MutationObserver(this.renderAll.bind(this));renderItem(t){const e=getComputedStyle(document.body),s=e.getPropertyValue("--default-tx-color"),n=e.getPropertyValue("--chart-bg-color"),i=Object.assign({},N),r=t.__QRCodeContent__,a=i.width||256;i.color=s,i.background=n,i.content=r||i.content||(()=>{throw new Error("No QRCode content provided.")})();const o=new this._module(i);t.style.width=a+"px",t.innerHTML=o.svg()}async importModule(){const t=await T("./dist/libs/qrcode-svg/qrcode.min.js","QRCode"),e=document.body;return this.#e.observe(e,{attributes:!0,attributeFilter:["class"]}),t}};var P=$.render.bind($);const W=new Map([["echarts",L],["flow-chart",k],["sequence-chart",M],["gantt-chart",A],["railroad-chart",I],["qrcode",P]]);function D(t){return Object.entries(t).filter((([t,e])=>null!=e)).map((([t,e])=>`${t}="${(t=>t.toString().replaceAll('"',"&quot;"))(e)}"`)).join(" ")}function G(t,e="",s=null){if("document"in globalThis){if("text"===t)return document.createTextNode(e);const n=document.createElement(t);return function(t,e){if(e)for(const[s,n]of Object.entries(e))void 0!==n&&(n instanceof Function?t[s]=n:t.setAttribute(s,n))}(n,s),function(t,e){if(e instanceof Array)for(const s of e)t.appendChild(s);else if(e instanceof HTMLElement)t.appendChild(e);else{if("string"!=typeof e)throw Error("Unexpected element content: "+e);t.textContent=e}}(n,e),n}switch(e instanceof Array&&(e=e.join("")),t){case"text":return e;case"hr":case"br":return`<${t}>`;case"img":case"input":return`<${t} ${s?D(s):""}>`}return`<${t}${s?" "+D(s):""}>${e}</${t}>`}function U(t,e){if(!t.includes(e))return null;let s="",n=!1;for(;t.length;){const i=t.slice(0,1);if(t=t.substr(1),"\\"!==i){if(i===e&&!n)break;s+=i,n=!1}else n=!n}return s}const B=new Map([["#","strong"],["`","code"],["_","u"],["/","i"],["-","del"],[":","span.dim"],[",","sub"],["'","sup"],["$","span.math"]]),z=new Map([["[","]"],["{","}"]]);let F=null;if("undefined"==typeof window){const t=await import("../builder/utils/renderer/index.js");F=e=>t.render(e,"katex")}class Q{constructor(t){this.content=t}toHTML=()=>G("text",this.content)}class V{constructor(t,e){const s=B.get(t);if(s.includes(".")){const[t,e]=s.split(".");this.tagName=t,this.className=e}else this.tagName=s;this.content=e,"math"===this.className&&"object"==typeof window&&(globalThis.__ContainsFormula__=!0)}toHTML(){if("math"===this.className&&"undefined"==typeof window){const t=G("img","",{src:"./"+F(this.content)});return G("span",t,{class:"math"})}const t=void 0===this.className?null:{class:this.className};return G(this.tagName,J(this.content),t)}}class X{constructor(t,e){this.content=t,this.address=e}toHTML(){const t=J(this.content);if(this.address.startsWith("http"))return G("a",t,{href:this.address,target:"_blank"});return G("a",t,{href:"#"+("static/"+this.address)})}}class Z{constructor(t,e){this.content=t,this.notation=e}toHTML(){const t=G("rp","("),e=G("rp",")"),s=G("rt",this.notation);return G("ruby",J(this.content).concat([t,s,e]),{"data-notation":this.notation})}}function J(t){const e=function(t){function e(){const e=t.charAt(0);return t=t.substring(1),e}function s(t){let e;return"["===t?e=X:"{"===t&&(e=Z),e}const n=[];let i="",r="",a="",o=!1,l=!1;for(;t.length;){const c=e();if(B.has(c)){if(o){l?r+=c:i+=c;continue}if(l&&c!=a){r+=c;continue}const s=e();if(s!=c){l?r+=c:i+=c,t=s+t;continue}l?(n.push(new V(c,r)),r="",a=""):(n.push(new Q(i)),i="",a=c),l=!l;continue}if(["[","{"].includes(c)&&!l&&!o){const r=c,a=z.get(r);n.push(new Q(i)),i="";let o=r;const l=U(t,a);if(null!=l){o+=t.slice(0,l.length+1),t=t.substr(l.length+1);const i=e();if(o+=i,"("===i){const e=U(t,")");if(null!=e){let i=s(r);t=t.substr(e.length+1),n.push(new i(l,e));continue}}}i+=o;continue}if("\\"===c){o=!o;continue}let h;o?(h="\\"+c,o=!1):h=c,l?r+=h:i+=h}return r.length&&n.push(new V(a,r)),i.length&&n.push(new Q(i)),n}(t);let s=e.filter((t=>!(t instanceof Q&&!t.content.length))).map((t=>t.toHTML()));return"object"!=typeof window&&t===s[0]?(t=>t.replaceAll("<","&lt;").replaceAll(">","&gt;"))(t):s}class K{constructor(t){const e=t.split(" "),s=e[0];let n=0;for(const t of s)"#"===t&&(n+=1);n>6&&(n=0);const i=e.slice(1).join(" ");this.tagName="h"+n,this.content=J(i)}toHTML(){const t=void 0===this.id?null:{id:this.id};return G(this.tagName,this.content,t)}static pattern=t=>t.match(/^(#+ )/)}class Y{tagName="p";constructor(t){this.content=t.trimStart()}toHTML(){const t=J(this.content);return G(this.tagName,t)}}class tt{tagName="blockquote";children=[];constructor(t){this.children=t}toHTML(){const t=this.children.map((t=>t.toHTML()));return G(this.tagName,t)}static pattern=t=>">"===t||t.startsWith("> ")}class et{toHTML=()=>G("hr");static pattern=t=>t.match(/(-\s*-\s*-)|(\*\s*\*\s*\*)/)&&!t.match(/[a-zA-Z0-9]/)}class st{children=[];constructor(t){this.isOrdered=Boolean(st.orderedPattern(t)),this.tagName=this.isOrdered?"ol":"ul",this.children=[st.getContent(t,this.isOrdered)]}push=t=>this.children.push(t);toHTML(){const t=[];for(const e of this.children)if("string"==typeof e){const s=J(e);t.push(G("li",s))}else t.push(e.toHTML());return G(this.tagName,t)}static unorderedPattern=t=>Boolean(t.match(/^([\s\t]*[+-]+ )/));static orderedPattern=t=>Boolean(t.match(/^([\s\t]*[0-9]+. )/));static isListPattern=t=>st.orderedPattern(t)||st.unorderedPattern(t);static getContent(t,e){return e?t.match(/(?<=^([\s\t]*[0-9]+. )).+$/g)[0]:t.match(/(?<=^([\s\t]*[+-]+ )).+$/g)[0]}}class nt{headerCells=[""];bodyRows=[[""]];constructor(t,e){this.headerCells=t,this.bodyRows=e}#n=t=>G("th",t);#i=t=>G("td",J(t));#r=t=>G("tr",t.map(this.#n));#a=t=>G("tr",t.map(this.#i));toHTML(){const t=G("thead",this.#r(this.headerCells)),e=G("tbody",this.bodyRows.map(this.#a));return G("div",G("table",[t,e]),{class:"table"})}static pattern=t=>t.startsWith("| ")}class it{source="";description="";constructor(t){t=t.substr(2),this.description=U(t,"]"),t=t.substr(this.description.length+2),this.source=U(t,")")}static containerGenerator(t){return G("div",t,{class:"media-container"})}static patternGenerator(t){return e=>e.startsWith(t+"[")&&e.endsWith(")")}static replaceContentGenerator(t,e){return`${e}<br>${G("a",r("从这里下载！","Download Here!"),{href:t})}`}static srcUrlResolver(t){let e;if(t.startsWith("http"))e=t;else{e=location.hash.slice(1).split("/").slice(0,-1).join("/")+"/"+t}return e}}class rt extends it{static pattern=it.patternGenerator("!");toHTML(){const t=G("img","",{src:it.srcUrlResolver(this.source),alt:this.description,loading:"lazy",tabindex:0});return t.onclick=t=>window.open(t.target.src),t.onerror=t=>{const e=t.target;e.onclick=null,e.title=this.description,e.classList.add("load-error")},it.containerGenerator(t)}}class at extends it{static pattern=it.patternGenerator(":");toHTML(){const t=it.srcUrlResolver(this.source),e=G("audio",it.replaceContentGenerator(t,this.description),{src:t,controls:!0});return it.containerGenerator(e)}}class ot extends it{static pattern=it.patternGenerator("?");toHTML(){const t=it.srcUrlResolver(this.source),e=G("video",it.replaceContentGenerator(t,this.description),{src:t,controls:"true"});return it.containerGenerator(e)}}const lt=t=>it.patternGenerator("@")(t)||t.startsWith("@@@");class ct extends it{toHTML(){const t=it.srcUrlResolver(this.source),e=G("iframe",this.description,{src:t,title:this.description,sandbox:"allow-scripts",loading:"lazy"});return it.containerGenerator(e)}}class ht{constructor(t,e){this.lang=e,this.content=t}append(t){this.content+=t}toHTML(){const t=["plaintext","text",""].includes(this.lang);let e,s;t||globalThis.__LanguageList__.add(this.lang),t?(s="nohighlight",e="PLAINTEXT"):(s=`language-${this.lang}`,e=this.lang.toUpperCase());const n=G("code",this.content,{class:s,tabindex:0});return G("pre",n,{class:"code-block","data-language":e})}static pattern=t=>t.startsWith("```")}class gt{summary="";content="";constructor(t,e){this.summary=e,this.content=At(t)}toHTML(){const t=G("summary",this.summary),e=G("details",t),s=G("div",G("div",this.content.map((t=>t.toHTML())),{class:"details-children"}),{class:"details-children-container"});return G("div",[e,s],{class:"details"})}static pattern=t=>t.startsWith(">>>")}class ut{content="";description="";constructor(t,e){this.content=t,this.description=e}toHTML(){return globalThis.__ContainsFormula__=!0,G("div",this.content,{class:"math",title:this.description})}static pattern=t=>t.startsWith("$$$")}class dt{static#o=t=>`<style>\n@media (prefers-color-scheme: dark) {\n  :root {\n    color: white;\n    background-color: #121212;\n  }\n}\n</style>\n<script>\nconst rootEl = document.documentElement\nfunction postHeight() {\n    const parent = window.parent\n    const height = parseFloat(getComputedStyle(rootEl).height)\n    parent.postMessage({\n        height,\n        id: "${t}"\n    }, "*")\n}\nwindow.addEventListener("load", postHeight)\nwindow.addEventListener("message", e => {\n  const { fontSize } = e.data\n  rootEl.style.fontSize = fontSize\n  postHeight()\n})\n<\/script>`;constructor(t,e){globalThis.__IframeCounter__+=1,this.id="iframe_"+globalThis.__IframeCounter__,this.description=e,this.content=t+dt.#o(this.id)}toHTML(){const t=G("iframe",this.description,{id:this.id,title:this.description,srcdoc:this.content,sandbox:"allow-scripts"});return it.containerGenerator(t)}}class pt{constructor(t){const e=new Function("let option;"+t+";return option")();this.chartOptions=e,globalThis.__ChartTypeList__.add("echarts")}toHTML(){const t=G("div","",{class:"echarts-container"});return t.__ChartOptions__=this.chartOptions,t}}class mt{constructor(t){this.content=t,globalThis.__ChartTypeList__.add("flow-chart")}toHTML(){const t=G("div","",{class:"flowchart-container"});return t.__ChartContent__=this.content,t}}class bt{constructor(t){this.content=t,globalThis.__ChartTypeList__.add("sequence-chart")}toHTML(){const t=G("div","",{class:"sequencechart-container"});return t.__ChartContent__=this.content,t}}class ft{constructor(t){this.content=new Function(`const tasks = [${t}]; return tasks`)(),globalThis.__ChartTypeList__.add("gantt-chart")}toHTML(){const t=G("div","",{class:"ganttchart-container"});return t.__ChartContent__=this.content,t}}class wt{constructor(t){this.content=t,globalThis.__ChartTypeList__.add("railroad-chart")}toHTML(){const t=G("div","",{class:"railroad-container"});return t.__ChartContent__=this.content,t}}class jt{constructor(t){this.content=t,globalThis.__ChartTypeList__.add("qrcode")}toHTML(){const t=G("div","",{class:"qrcode-container"});return t.__QRCodeContent__=this.content,t}}class yt{constructor(t){this.content=t}toHTML(){return G("span",this.content)}}class _t{static pattern=t=>t.startsWith("!!!");#l=null;constructor(t,e){switch(e){case"":case"echarts":this.#l=new pt(t);break;case"flow":case"flowchart":case"flow chart":case"flow-chart":this.#l=new mt(t);break;case"sequence":case"sequencechart":case"sequence char":case"sequence-chart":this.#l=new bt(t);break;case"gantt":case"ganttchart":case"gantt chart":case"gantt-chart":this.#l=new ft(t);break;case"rail":case"railroad":case"railroadchart":case"railroad chart":case"railroad-chart":this.#l=new wt(t);break;case"qrcode":case"qr-code":case"qr code":this.#l=new jt(t);break;default:const s="Unknown chart type: "+e;console.error(s),this.#l=new yt(s)}}toHTML(){const t=this.#l.toHTML();return it.containerGenerator(t)}}function vt(t){let e=0,s=0;for(const n of t){if(n.match(/[^\s\t]/))break;"\t"!==n?(" "===n&&(s+=1),2===s&&(s=0,e+=1)):e+=1}return e}function Lt(t,e){const s=vt(t),n=new st(t);for(;e.length&&st.isListPattern(e[0]);){const t=e.shift(),i=vt(t),r=st.orderedPattern(t);if(i>s)n.push(Lt(t,e));else{if(i!==s||r!==n.isOrdered){e.unshift(t);break}n.push(st.getContent(t,r))}}return n}function Tt(t,e){let s=t.slice(2)+"\n";for(;e.length;){const t=e.shift();if(!tt.pattern(t)){e.unshift(t);break}s+=t.slice(2)+"\n"}const n=At(s);return new tt(n)}function xt(t){return t.split("|").filter((t=>t.length>0)).map((t=>t.trim()))}function Et(t,e){const s=t,n=[];for(;e.length;){const t=e.shift();if(!nt.pattern(t)){e.unshift(t);break}n.push(t)}const i=xt(s),r=n.map(xt);return new nt(i,r)}function kt(t,e){return function(s,n){const i=s.slice(3);let r="";for(;n.length;){const e=n.shift();if(e===t)break;r+=e+"\n"}return new e(r,i)}}const Ct=kt("```",ht),Mt=kt("!!!",_t),qt=kt(">>>",gt),St=kt("$$$",ut);function Ht(t,e){const s=kt("@@@",dt);return t.startsWith("@@@")?s(t,e):new ct(t)}function At(t){const e=function(t){return-1!=t.indexOf("\r")?t.split("\r\n"):t.split("\n")}(t),s=[];for(;e.length;){const t=e.shift();t.length&&(K.pattern(t)?s.push(new K(t)):et.pattern(t)?s.push(new et):tt.pattern(t)?s.push(Tt(t,e)):st.isListPattern(t)?s.push(Lt(t,e)):nt.pattern(t)?s.push(Et(t,e)):rt.pattern(t)?s.push(new rt(t)):at.pattern(t)?s.push(new at(t)):ot.pattern(t)?s.push(new ot(t)):gt.pattern(t)?s.push(qt(t,e)):ut.pattern(t)?s.push(St(t,e)):ht.pattern(t)?s.push(Ct(t,e)):_t.pattern(t)?s.push(Mt(t,e)):lt(t)?s.push(Ht(t,e)):s.push(new Y(t)))}return s}function Ot(t){return function(e){"Enter"!==e.key&&" "!==e.key||t.click()}}function Rt(){document.body.scrollTop=0,document.documentElement.scrollTop=0}const It=document.querySelector("article"),Nt=r("空文章","Empty Article");function $t(e,s){globalThis.__LanguageList__=new Set,globalThis.__ChartTypeList__=new Set,globalThis.__ContainsFormula__=!1,globalThis.__IframeCounter__=0;const n=At(s);if(t.enableCatalog){const t=function(t){return t.filter((t=>t instanceof K)).map(((t,e)=>({id:t.id="headline-"+e,content:t.content.map((t=>t.cloneNode(!0))),level:t.tagName})))}(n);p.emit("article-rendered",t)}let i=n.map((t=>t.toHTML()));i.length||(i=el("h1",Nt)),e.innerHTML="",i.forEach((t=>e.appendChild(t))),e.style.display="block",e.querySelectorAll("[tabindex='0']").forEach((t=>{t.onkeydown=Ot(t)})),Rt(),h(globalThis.__LanguageList__).then((()=>globalThis.__LanguageList__=null)),d(globalThis.__ContainsFormula__).then((()=>globalThis.__ContainsFormula__=!1)),async function(t=new Set){for(const e of t){if(!W.has(e)){console.error("Unknown chart type: "+e);continue}const t=W.get(e);await t()}}(globalThis.__ChartTypeList__).then((()=>globalThis.__ChartTypeList__=null))}function Pt(t){const e=new Date(t.timestamp),s=G("code",(new Intl.DateTimeFormat).format(e)),n=G("span",t.title,{class:"underline-target"});return G("li",[s,G("text",": "),n],{tabindex:0,class:"underline-through","data-target-blog":t.link})}function Wt(t){const e=G("span",t,{class:"underline-target"});return G("li",e,{class:"underline-through",tabindex:0})}p.on("catalog-toggle",(()=>{It.classList.toggle("with-catalog")})),p.on("catalog-closed",(()=>{It.classList.remove("with-catalog")}));const Dt=document.querySelector("main"),Gt=document.querySelector("article"),Ut=Dt.querySelector("#article-list"),Bt=Dt.querySelector("#directory-description"),zt=Dt.querySelector("paging-view");function Ft(t,e){const{current:s,total:n}=t;zt.setPage(s,n),Bt.innerHTML="","directoryDescription"in t&&$t(Bt,t.directoryDescription),Ut.innerHTML="",t.content.map(e).forEach((t=>Ut.appendChild(t))),Ut.querySelectorAll("[tabindex='0']").forEach((t=>{t.onkeydown=Ot(t)})),Gt.style.display="none",Dt.style.display="block",document.body.scrollTop=0,document.documentElement.scrollTop=0}async function Qt(t){const n=document.querySelector("main"),i=document.querySelector("article"),r="./.index/";if(!location.hash)return void Xt.homepage();const a=location.hash.slice(1);if(n.classList.add("disabled"),Xt.isIn.newestPage()){const t=r+"newest_"+Zt.current(),e=await s(t);if(!e)return;Ft(e,Pt)}else if(Xt.isIn.directory()){const t=r+a.split("/").slice(0,-1).join("+")+"_"+Zt.current(),e=await s(t);if(!e)return;Ft(e,Wt)}else if(Xt.isIn.article()){const t=await async function(t){return e&&e.abort(),e=new AbortController,await fetch(t,{signal:e.signal}).then((async t=>{if(200!=t.status)throw t.status;const s=await t.text();return e=null,s})).catch((e=>{if("number"!=typeof e)return console.error(e),null;switch(e){case 404:return"# 404 Not Found";case 500:return"# 500 Internal Server Error";case DOMException:console.error(e);break;default:return console.log("Markdown request error: "+t),console.error(e),"# Unexpected request error"}}))}("./"+a);if(!t)return;n.style.display="none",$t(i,t)}else Xt.homepage();n.setAttribute("data-is-root","static/"===a),n.classList.remove("disabled")}window.addEventListener("hashchange",Qt),window.addEventListener("load",Qt);const Vt="static/",Xt={homepage(){location.hash=Vt},open(t){location.hash+=t},jumpTo(t){location.hash=t},parent(){if(this.isIn.root()||this.isIn.newestPage())return Vt;const t=location.hash.slice(1).split("/");if(this.isIn.directory())return t.slice(0,-2).join("/")+"/";if(this.isIn.article())return t.slice(0,-1).join("/")+"/";throw new Error("Unexpected hash: "+location.hash)},isIn:{root:()=>location.hash==="#"+Vt,newestPage:()=>"#newest/"===location.hash,directory:()=>location.hash.startsWith("#static")&&location.hash.endsWith("/"),article:()=>location.hash.startsWith("#static")&&location.hash.endsWith(".md")}};const Zt=new class{#c=[1];current=()=>this.#c[this.length()-1];next=()=>this.#c[this.length()-1]+=1;prev=()=>this.#c[this.length()-1]-=1;jumpTo=t=>this.#c[this.length()-1]=Number(t);length=()=>this.#c.length;back(){this.#c.pop(),this.#c.length||this.#c.push(1)}open(){this.#c.push(1)}},Jt=t=>G("button",G("span",t,{class:"underline-target"}),{class:"icon-btn underline-side"});class Kt extends HTMLElement{#h={};constructor(){super(),this.#h.input=G("input","1",{type:"number",min:1,max:1}),this.#h.maxPage=G("span","1");const t=this.#h.prevBtn=Jt(r("上一页","Prev")),e=this.#h.nextBtn=Jt(r("下一页","Next"));t.id="prev-btn",t.classList.add("left"),e.id="next-btn",e.classList.add("right");const s=G("label",[this.#h.input,G("text","/"),this.#h.maxPage]);this.#g();for(const n of[t,s,e])this.appendChild(n)}#g(){this.#h.input.addEventListener("keydown",(t=>{if("Enter"!==t.key)return;const e=t.target.value;if(!/^\d+$/.test(e))return void(t.target.value=1);const s=Number(e);s>0&&s<=this.#h.input.max?(Zt.jumpTo(s),Qt()):t.target.value=1})),this.#h.prevBtn.addEventListener("click",(()=>{Zt.current()>0&&(Zt.prev(),Qt())})),this.#h.nextBtn.addEventListener("click",(()=>{Zt.current()<this.#h.input.max&&(Zt.next(),Qt())}))}setPage(t,e){let s=!1,n=!1,i=!1;1===e?i=!0:(1===t&&(s=!0),t===e&&(n=!0)),this.#h.prevBtn.disabled=i||s,this.#h.nextBtn.disabled=i||n,this.#h.maxPage.textContent=e,this.#h.input.value=t,this.#h.input.max=e,this.classList.toggle("hidden",i)}}customElements.define("paging-view",Kt);var Yt=Object.freeze({__proto__:null,default:Zt});const te=document.querySelector("main"),ee=te.querySelector("#previous-dir li"),se=te.querySelector("#article-list");async function ne(t){await function(t){switch(t){case"../../components/catalog.js":return import("./chunks/catalog.min.js");case"../../components/fab.js":return import("./chunks/fab.min.js");case"../../components/paging.js":return Promise.resolve().then((function(){return Yt}));default:return new Promise((function(e,s){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+t)))}))}}(`../../components/${t}.js`),l(`./dist/chunks/${t}.min.css`)}ee.addEventListener("click",(()=>{Zt.back(),Xt.jumpTo(Xt.parent())})),se.addEventListener("click",(t=>{const e=t.target;e!==se&&(e.getAttribute("data-target-blog")?(Zt.open(),Xt.jumpTo(e.getAttribute("data-target-blog"))):(e.innerText.endsWith("/")&&Zt.open(),Xt.open(e.innerText)))})),t.enableFab&&ne("fab"),t.enableCatalog&&ne("catalog");const ie=document.querySelector("#light-btn"),re=document.querySelector("#dark-btn");ie.onkeydown=Ot(ie),re.onkeydown=Ot(re),window.addEventListener("popstate",(()=>{location.hash.endsWith("/")&&Zt.back()})),window.addEventListener("message",(t=>{if("null"!=t.origin)return;const{id:e,height:s}=t.data;document.getElementById(e).style.height=s+"px"})),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").catch((function(t){console.error("Registration failed with "+t)}));export{p as a,Rt as b,G as e,r as l,Xt as p};
//# sourceMappingURL=index.min.js.map
