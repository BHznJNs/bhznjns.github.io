{"version":3,"file":"index.min.js","sources":["../src/scripts/pageManager.js","../src/scripts/fetchResources.js","../src/scripts/keydownEvent.js","../build.config.js","../src/scripts/importer.js","../src/utils/markdown/utils/el.js","../src/utils/markdown/utils/getInterval.js","../src/utils/markdown/inline.js","../src/utils/markdown/node.js","../src/utils/markdown/utils/getIndent.js","../src/utils/markdown/resolvers/listResolver.js","../src/utils/markdown/resolvers/quoteResolver.js","../src/utils/markdown/resolvers/tableResolver.js","../src/utils/markdown/resolvers/blockResolvers.js","../src/utils/markdown/index.js","../src/utils/markdown/utils/getLines.js","../src/utils/render.js","../src/index.js"],"sourcesContent":["class PageManager {\r\n    #pageList = [1]\r\n\r\n    current() {\r\n        const length = this.#pageList.length\r\n        return this.#pageList[length - 1]\r\n    }\r\n    next() {\r\n        const length = this.#pageList.length\r\n        this.#pageList[length - 1] += 1\r\n    }\r\n    previous() {\r\n        const length = this.#pageList.length\r\n        this.#pageList[length - 1] -= 1\r\n    }\r\n\r\n    back() {\r\n        // called when \"popstate\" emited\r\n        this.#pageList.pop()\r\n        if (!this.#pageList.length) {\r\n            this.#pageList.push(1)\r\n        }\r\n    }\r\n    open() {\r\n        // called when enter directory\r\n        this.#pageList.push(1)\r\n    }\r\n}\r\nexport default new PageManager()\r\n","let controller = null\r\n\r\nexport async function fetchJSON(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            const json = await res.json()\r\n            controller = null\r\n            return json\r\n        })\r\n        .catch(err => {\r\n            console.log(\"JSON request error: \" + path)\r\n            console.error(err)\r\n            return null\r\n        })\r\n}\r\n\r\nexport async function fetchMD(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            if (res.status != 200) {\r\n                throw res.status\r\n            }\r\n            const text = await res.text()\r\n            controller = null\r\n            return text\r\n        })\r\n        .catch(err => {\r\n            if (typeof err != \"number\") {\r\n                console.error(err)\r\n                return null\r\n            }\r\n\r\n            switch (err) {\r\n                // render error code in markdown format\r\n                case 404:\r\n                    return \"# 404 Not Found\"\r\n                case 500:\r\n                    return \"# 500 Internal Server Error\"\r\n                case DOMException:\r\n                    console.error(err)\r\n                    break\r\n                default:\r\n                    console.log(\"Markdown request error: \" + path)\r\n                    console.error(err)\r\n                    return \"# Unexpected request error\"\r\n            }\r\n        })\r\n}\r\n","export default function(el) {\r\n    return function(e) {\r\n        if (e.key == \"Enter\" || e.key == \" \") {\r\n            el.click()\r\n        }\r\n    }\r\n}\r\n","export default {\r\n    /**\r\n     * homepage: String\r\n     * the URL that this site deployed, is used to generate the rss.xml file\r\n     * 此站点部署的 URL，用于生成 rss.xml 文件\r\n     */\r\n    homepage: \"https://bhznjns.github.io/markdown-blog/\",\r\n\r\n    /**\r\n     * footer: String\r\n     * the footer for this site, can be deleted if you do not need it\r\n     * 站点的脚注，如果你不需要可以删除\r\n     */\r\n    footer: `Powerd by <a href='https://github.com/BHznJNs/markdown-blog'>MarkdownBlog</a>`,\r\n\r\n    /**\r\n     * language: String\r\n     * \"zh\" => Simplified Chinese 简体中文\r\n     * \"en\" => English            英文\r\n     */\r\n    language: \"zh\",\r\n\r\n    /**\r\n     * enableRSS: Boolean | Object<value: Boolean, ignoreDir: [String]>\r\n     * used to enable / disable the RSS function, if you do not want add blogs in some directory to the `rss.xml` , just add it into the `ignoreDir`\r\n     * 用来启用/禁用 RSS 发布功能，如果你不想将某些文件夹的内容添加到 `rss.xml` 中，将其添加到 `ignoreDir` 中\r\n     */\r\n    enableRSS: {\r\n        value: true,\r\n        ignoreDir: [\r\n            // directories in `static`\r\n            \"学习笔记/\"\r\n        ]\r\n    },\r\n\r\n    /**\r\n     * enableNewest: Boolean | Object<value: Boolean, ignoreDir: [String]>\r\n     * used to enable / disable the Newest function, if you do not want add blogs in some directory, just add it into the `ignoreDir`\r\n     * 用来启用/禁用 最新博文 功能，如果你不想将某些文件夹的内容添加到其中，将其添加到 `ignoreDir` 中\r\n     */\r\n    enableNewest: {\r\n        value: true,\r\n        ignoreDir: []\r\n    },\r\n\r\n    /**\r\n     * pageCapacity: Number\r\n     * defined the amount of the items in every page\r\n     * 定义每一页展示的博文数\r\n     */\r\n    pageCapacity: 10,\r\n\r\n    /**\r\n     * RSSCapacity: Number\r\n     * defined the amount of the items in `rss.xml`\r\n     * 定义 `rss.xml` 中包含的博文个数\r\n     */\r\n    RSSCapacity: 16,\r\n\r\n    /**\r\n     * previewPort: Number\r\n     * defined the port id for preview server\r\n     * 为预览服务器定义端口\r\n     */\r\n    previewPort: 3000,\r\n\r\n    /**\r\n     * katexOptions: Object\r\n     * options for katex.js rendering, see here: https://katex.org/docs/options\r\n     * katex.js 用于渲染数学公式的配置项，见此：https://katex.org/docs/options\r\n     */\r\n    katexOptions: null\r\n}\r\n","import config from \"../../build.config.js\"\r\n\r\nconst { katexOptions } = config\r\n\r\nlet hljs  = null\r\nlet katex = null\r\n\r\nexport async function importHighlighter() {\r\n    function importLangDefs() {\r\n        // dynamically import language definitions\r\n        const languageListArr = Array.from(globalThis.__LanguageList__)\r\n        const langDefImporters = languageListArr\r\n            .filter(name => !hljs.getLanguage(name))\r\n            .map(lang => import(`../libs/highlight-es/languages/${lang.toLowerCase()}.js`))\r\n\r\n        Promise.all(langDefImporters)\r\n            .then(langDefs => langDefs.forEach((defModule, index) => {\r\n                const name = languageListArr[index]\r\n                const def  = defModule.default\r\n                hljs.registerLanguage(name, def)\r\n            }))\r\n            .then(() => hljs.highlightAll())\r\n            .catch(err => console.error(err))\r\n    }\r\n\r\n    if (globalThis.__LanguageList__.size == 0) {\r\n        // no code blocks\r\n        return\r\n    }\r\n    if (hljs) {\r\n        importLangDefs()\r\n        return\r\n    }\r\n\r\n    // import highlight.js itself\r\n    await import(\"../libs/highlight-es/highlight.js\")\r\n        .then(module => hljs = module.default)\r\n        .then(importLangDefs)\r\n        .catch(err => console.error(err))\r\n}\r\n\r\nexport async function importTexRenderer() {\r\n    function renderFormula() {\r\n        // render all formula element\r\n        document.querySelectorAll(\".math\")\r\n            .forEach(el => {\r\n                const texString = el.textContent\r\n                try {\r\n                    katex.render(texString, el, katexOptions)\r\n                } catch(e) {\r\n                    if (e instanceof katex.ParseError) {\r\n                        // KaTeX can't parse the expression\r\n                        el.innerHTML = (\"Error in LaTeX '\" + texString + \"': \" + e.message)\r\n                            .replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n                    } else {\r\n                        // other error\r\n                        throw e\r\n                    }\r\n                }\r\n            })\r\n    }\r\n\r\n    if (!globalThis.__ContainsFormula__) {\r\n        // no formula\r\n        return\r\n    }\r\n    if (katex) {\r\n        renderFormula()\r\n        return\r\n    }\r\n\r\n    const tasks = [import(\"../libs/katex/katex.js\"), fetch(\"dist/katex.min.css\")]\r\n    await Promise.all(tasks)\r\n        .then(([module, cssRes]) => {\r\n            // set katex js module & render\r\n            katex = module.default\r\n            renderFormula()\r\n            return cssRes.text()\r\n        })\r\n        .then(cssText => {\r\n            // set katex css\r\n            const style = document.createElement(\"style\")\r\n            style.textContent = cssText\r\n            document.head.appendChild(style)\r\n        })\r\n        .catch(err => console.error(err))\r\n}","function propSetter(el, props) {\r\n    if (!props) {\r\n        return\r\n    }\r\n    for (const [key, val] of Object.entries(props)) {\r\n        if (val == undefined) {\r\n            continue\r\n        }\r\n        el.setAttribute(key, val)\r\n    }\r\n}\r\n\r\nfunction propToString(props) {\r\n    // input: {prop: \"value\"}\r\n    // output: \"prop='value'\"\r\n    const htmlValueFormater = val => val.toString().replaceAll(\"\\\"\", \"&quot;\") \r\n    const resultPropStr = Object.entries(props)\r\n        .filter(([_, val]) => val != undefined)\r\n        .map(([key, val]) => `${key}=\"${htmlValueFormater(val)}\"`)\r\n        .join(\" \")\r\n    return resultPropStr\r\n}\r\n\r\nfunction contentSetter(el, content) {\r\n    if (content instanceof Array) {\r\n        // array of html element\r\n        for (const childEl of content) {\r\n            el.appendChild(childEl)\r\n        }\r\n    } else if (content instanceof HTMLElement) {\r\n        // single element\r\n        el.appendChild(content)\r\n    } else if (typeof content == \"string\") {\r\n        // common text\r\n        el.textContent = content\r\n    } else {\r\n        throw Error(\"Unexpected element content: \" + content)\r\n    }\r\n}\r\n\r\nexport default function el(tagName, content, props=null) {\r\n    if (\"document\" in globalThis) {\r\n        // in browser\r\n        if (tagName == \"text\") {\r\n            return document.createTextNode(content)\r\n        }\r\n\r\n        const targetEl = document.createElement(tagName)\r\n        propSetter(targetEl, props)\r\n        contentSetter(targetEl, content)\r\n        return targetEl\r\n    } else {\r\n        // in node.js\r\n        if (content instanceof Array) {\r\n            content = content.join(\"\")\r\n        }\r\n        switch (tagName) {\r\n            case \"text\":\r\n                return content\r\n            case \"hr\":\r\n                return \"<hr>\"\r\n            case \"img\":\r\n                return `<img ${props ? propToString(props) : \"\"}>`\r\n        }\r\n        return `<${tagName}${props ? \" \" + propToString(props) : \"\"}>${content}</${tagName}>`\r\n    }\r\n}\r\n","// (\"abc]\", \"]\") -> \"abc\"\r\nexport default function getInterval(text, endSign) {\r\n    if (!text.includes(endSign)) {\r\n        return null\r\n    }\r\n\r\n    let intervalText = \"\"\r\n    let isEscape = false\r\n\r\n    while (text.length) {\r\n        const ch = text.slice(0, 1)\r\n        text = text.substr(1)\r\n\r\n        if (ch == \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n        if (ch == endSign && !isEscape) {\r\n            break\r\n        }\r\n        intervalText += ch\r\n        isEscape = false\r\n    }\r\n\r\n    return intervalText\r\n}\r\n","import el from \"./utils/el.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\n\r\n// identifier character to HTML tag\r\nconst KeyToken_TagName_map = new Map([\r\n    [\"#\", \"strong\"],\r\n    [\"`\", \"code\"],\r\n    [\"_\", \"u\"],\r\n    [\"/\", \"i\"],\r\n    [\"-\", \"del\"],\r\n    [\":\", \"span.dim\"],\r\n    [\",\", \"sub\"],\r\n    [\"'\", \"sup\"],\r\n    [\"$\", \"span.math\"],\r\n])\r\n\r\nconst PairedParenMap = new Map([\r\n    [\"[\", \"]\"],\r\n    [\"{\", \"}\"],\r\n])\r\n\r\n// --- --- --- --- --- ---\r\n\r\nclass TextToken {\r\n    constructor(content) {\r\n        this.content = content\r\n    }\r\n    toHTML = () => el(\"text\", this.content)\r\n}\r\nclass KeyToken {\r\n    constructor(tagSign, content) {\r\n        const tag = KeyToken_TagName_map.get(tagSign)\r\n        if (tag.includes(\".\")) {\r\n            const [realTagName, className] = tag.split(\".\")\r\n            this.tagName = realTagName\r\n            this.className = className\r\n        } else {\r\n            this.tagName = tag\r\n        }\r\n        this.content = content\r\n\r\n        if (this.className == \"math\") {\r\n            // set this global variable to import\r\n            // the math formula renderer module\r\n            globalThis.__ContainsFormula__ = true\r\n        }\r\n    }\r\n\r\n    toHTML() {\r\n        const elOption = this.className == undefined ? null : {\"class\": this.className}\r\n        const thisEl = el(this.tagName, parser(this.content), elOption)\r\n        return thisEl\r\n    }\r\n}\r\n\r\nclass LinkToken {\r\n    constructor(content, address) {\r\n        this.content = content\r\n        this.address = address\r\n    }\r\n\r\n    toHTML() {\r\n        const displayContent = parser(this.content)\r\n        if (this.address.startsWith(\"http\")) {\r\n            // internet links\r\n            return el(\"a\", displayContent, {\r\n                href: this.address,\r\n                target: \"_blank\"\r\n            })\r\n        }\r\n\r\n        // static resources or links\r\n        const actualAddress = \"static/\" + this.address\r\n        return el(\"a\", displayContent, {\r\n            href: \"#\" + actualAddress\r\n        })\r\n    }\r\n}\r\nclass PhoneticToken {\r\n    constructor(content, notation) {\r\n        this.content  = content\r\n        this.notation = notation\r\n    }\r\n    toHTML() {\r\n        const ignoredLeftParenthesis = el(\"rp\", \"(\")\r\n        const ignoredRightParenthesis = el(\"rp\", \")\")\r\n        const notationEl = el(\"rt\", this.notation)\r\n\r\n        const content = parser(this.content).concat([\r\n            ignoredLeftParenthesis,\r\n            notationEl,\r\n            ignoredRightParenthesis,\r\n        ])\r\n        return el(\"ruby\", content, {\r\n            \"data-notation\": this.notation\r\n        })\r\n    }\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nexport default function parser(source) {\r\n    function getFirstChar() {\r\n        const ch = source.charAt(0)\r\n        source = source.substring(1)\r\n        return ch\r\n    }\r\n    function getSpecialTokenClass(tokenSign) {\r\n        let targetTokenType\r\n        if (tokenSign == \"[\") {\r\n            targetTokenType = LinkToken\r\n        } else if (tokenSign == \"{\") {\r\n            targetTokenType = PhoneticToken\r\n        } else { /* unreachable */ }\r\n        return targetTokenType\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const tokens = []\r\n    let textTerm = \"\" // text\r\n    let keyTerm  = \"\" // inline style content\r\n    let keyStart = \"\"\r\n    let isEscape = false\r\n    let isInKey  = false\r\n\r\n    while (source.length) {\r\n        const ch = getFirstChar()\r\n\r\n        // key rules resolve\r\n        if (KeyToken_TagName_map.has(ch)) {\r\n            if (isEscape) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                continue\r\n            }\r\n\r\n            if (isInKey && ch != keyStart) {\r\n                keyTerm += ch\r\n                continue\r\n            }\r\n\r\n            const nextCh = getFirstChar()\r\n            if (nextCh != ch) {\r\n                textTerm += ch\r\n                source = nextCh + source\r\n                continue\r\n            }\r\n\r\n            if (isInKey) {\r\n                tokens.push(new KeyToken(ch, keyTerm))\r\n                keyTerm  = \"\"\r\n                keyStart = \"\"\r\n            } else {\r\n                tokens.push(new TextToken(textTerm))\r\n                textTerm = \"\"\r\n                keyStart = ch\r\n            }\r\n            isInKey = !isInKey\r\n            continue\r\n        }\r\n\r\n        // special inline rules resolve\r\n        if ([\"[\", \"{\"].includes(ch) && !isInKey && !isEscape) {\r\n            const specialTokenSign = ch\r\n            const pairedTokenSign = PairedParenMap.get(specialTokenSign)\r\n\r\n            tokens.push(new TextToken(textTerm))\r\n            textTerm = \"\"\r\n\r\n            let removedContent = specialTokenSign\r\n            // the actual displayed content for special inline elements\r\n            const displayContent = getInterval(source, pairedTokenSign)\r\n            if (displayContent != null) {\r\n                removedContent += source.slice(0, displayContent.length + 1)\r\n                source = source.substr(displayContent.length + 1)\r\n\r\n                const nextCh = getFirstChar()\r\n                removedContent += nextCh\r\n                if (nextCh == \"(\") {\r\n                    // the hidden displayed content for special inline elements\r\n                    const hiddenContent = getInterval(source, \")\")\r\n                    if (hiddenContent != null) {\r\n                        let targetTokenType = getSpecialTokenClass(specialTokenSign)\r\n                        source = source.substr(hiddenContent.length + 1)\r\n                        tokens.push(new targetTokenType(displayContent, hiddenContent))\r\n                        continue\r\n                    }\r\n                }\r\n            }\r\n            textTerm += removedContent\r\n            continue\r\n        }\r\n\r\n        // --- --- --- --- --- ---\r\n\r\n        if (ch == \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n\r\n        let text\r\n        if (isEscape) {\r\n            text = \"\\\\\" + ch\r\n            isEscape = false\r\n        } else {\r\n            text = ch\r\n        }\r\n\r\n        if (isInKey) {\r\n            keyTerm += text\r\n        } else {\r\n            textTerm += text\r\n        }\r\n    }\r\n\r\n    if (keyTerm.length) {\r\n        tokens.push(new KeyToken(keyStart, keyTerm))\r\n    }\r\n    if (textTerm.length) {\r\n        tokens.push(new TextToken(textTerm))\r\n    }\r\n    return tokens\r\n        .filter(token =>\r\n            !(token instanceof TextToken && !token.content.length))\r\n        .map(token => token.toHTML())\r\n}\r\n\r\n// test cases\r\n// console.log(parser(\"##bo//itelic//ld##\"))\r\n// console.log(parser(\"##bo[link text](http://www.com)ld##\"))\r\n// console.log(parser(\"asd[asd\"))\r\n// console.log(parser(\"asd[asd]asd\"))\r\n// console.log(parser(\"asd[asd](asd\"))\r\n// console.log(parser(\"asd[asd](asd)\"))\r\n// console.log(parser(\"asd[##link##](asd)\"))\r\n// console.log(parser(\"##asd[link##](asd)\"))\r\n// console.log(parser(\"##asd[link](asd)##\"))\r\n// console.log(parser(\"::dimmed::\"))\r\n// console.log(parser(\"$$f_c = \\\\frac{1}{abc}$$\"))\r\n","import config from \"../../../build.config.js\"\r\nimport mdResolver from \"./index.js\"\r\nimport inlineResolver from \"./inline.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\nimport el from \"./utils/el.js\"\r\n\r\nconst { language } = config\r\n\r\nclass BaseNode {\r\n    tagName = \"\"\r\n    content = \"\"\r\n\r\n    toHTML() {\r\n        const inline = inlineResolver(this.content)\r\n        return el(this.tagName, inline)\r\n    }\r\n}\r\n\r\nexport class Headline extends BaseNode {\r\n    constructor(content) {\r\n        super()\r\n\r\n        // \"### test\" -> \"###\"\r\n        const splited = content.split(\" \")\r\n        const numberSignStr = splited[0]\r\n        let numberSignCount = 0\r\n        for (const ch of numberSignStr) {\r\n            if (ch == '#') {\r\n                numberSignCount += 1\r\n            }\r\n        }\r\n\r\n        if (numberSignCount > 6) {\r\n            numberSignCount = 0\r\n        }\r\n\r\n        this.tagName = \"h\" + numberSignCount\r\n        this.content = splited.slice(1).join(\" \")\r\n    }\r\n\r\n    static pattern = source => source.match(/^(#+ )/)\r\n}\r\n\r\nexport class Para extends BaseNode {\r\n    tagName = \"p\"\r\n\r\n    constructor(content) {\r\n        super()\r\n        this.content = content.trimStart()\r\n    }\r\n}\r\n\r\nexport class Quote extends BaseNode {\r\n    tagName = \"blockquote\"\r\n    children = []\r\n\r\n    constructor(children) {\r\n        super()\r\n        this.children = children\r\n    }\r\n    toHTML() {\r\n        const innerNodes = this.children\r\n            .map(node => node.toHTML())\r\n        return el(this.tagName, innerNodes)\r\n    }\r\n\r\n    static pattern = source =>\r\n        (source == \">\") || source.startsWith(\"> \")\r\n}\r\n\r\nexport class Divider extends BaseNode {\r\n    toHTML = () => el(\"hr\", [])\r\n    static pattern = source =>\r\n        source.match(/(-\\s*-\\s*-)|(\\*\\s*\\*\\s*\\*)/) && !source.match(/[a-zA-Z0-9]/)\r\n}\r\n\r\nexport class List extends BaseNode {\r\n    children = []\r\n\r\n    constructor(content) {\r\n        super()\r\n\r\n        this.isOrdered = Boolean(List.orderedPattern(content))\r\n        this.tagName   = (this.isOrdered) ? \"ol\" : \"ul\"\r\n        this.children  = [List.getContent(content, this.isOrdered)]\r\n    }\r\n\r\n    push = child => this.children.push(child)\r\n\r\n    toHTML() {\r\n        const childrenHTML = []\r\n        for (const child of this.children) {\r\n            if (typeof child == \"string\") {\r\n                const inline = inlineResolver(child)\r\n                childrenHTML.push(el(\"li\", inline))\r\n            } else {\r\n                childrenHTML.push(child.toHTML())\r\n            }\r\n        }\r\n        return el(this.tagName, childrenHTML)\r\n    }\r\n\r\n    static unorderedPattern = (source) => Boolean(source.match(/^([\\s\\t]*[+-]+ )/))\r\n    static orderedPattern = (source) => Boolean(source.match(/^([\\s\\t]*[0-9]+. )/))\r\n\r\n    static isListPattern = (source) =>\r\n        List.orderedPattern(source) || List.unorderedPattern(source)\r\n\r\n    static getContent(line, isOrdered) {\r\n        if (isOrdered) {\r\n            // \"1. ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[0-9]+. )).+$/g)[0]\r\n        } else {\r\n            // \"- ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[+-]+ )).+$/g)[0]\r\n        }\r\n    }\r\n}\r\n\r\nexport class Table extends BaseNode {\r\n    headerCells = [\"\"]   // [string]\r\n    bodyRows    = [[\"\"]] // [[string]]\r\n\r\n    constructor(headerCells, bodyRows) {\r\n        super()\r\n\r\n        this.headerCells = headerCells\r\n        this.bodyRows    = bodyRows\r\n    }\r\n\r\n    #tableHeaderCell = content => el(\"th\", content)\r\n    #tableBodyCell   = content => el(\"td\", inlineResolver(content))\r\n    #tableHeaderRow  = row => el(\"tr\", row.map(this.#tableHeaderCell))\r\n    #tableBodyRow    = row => el(\"tr\", row.map(this.#tableBodyCell))\r\n\r\n    toHTML() {\r\n        const tableHeader = el(\r\n            \"thead\",\r\n            this.#tableHeaderRow(this.headerCells)\r\n        )\r\n        const tableBody = el(\r\n            \"tbody\",\r\n            this.bodyRows\r\n                .map(this.#tableBodyRow)\r\n        )\r\n        return el(\"div\", el(\"table\", [tableHeader, tableBody]), {\r\n            \"class\": \"table\"\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"| \")\r\n}\r\n\r\n// --- --- --- --- -\r\n// media nodes start\r\n// --- --- --- --- -\r\n\r\nclass MediaNode extends BaseNode {\r\n    source = \"\"\r\n    description = \"\"    \r\n    constructor(mdText) {\r\n        super()\r\n\r\n        mdText = mdText.substr(2)\r\n        this.description = getInterval(mdText, \"]\")\r\n        mdText = mdText.substr(this.description.length + 2)\r\n        this.source = getInterval(mdText, \")\")\r\n    }\r\n\r\n    static containerGenerator(content) {\r\n        return el(\"div\", content, {\r\n            \"class\": \"media-container\"\r\n        })\r\n    }\r\n\r\n    static patternGenerator(identifierSign) {\r\n        return (source) =>\r\n            source.startsWith(identifierSign + \"[\") && source.endsWith(\")\")\r\n    }\r\n\r\n    static replaceContentGenerator(href, description) {\r\n        let downloadEl\r\n        if (language == \"cn\") {\r\n            downloadEl = el(\"a\", \"从这里下载！\", { href })\r\n        } else if (language == \"en\") {\r\n            downloadEl = el(\"a\", \"Download this!\", { href })\r\n        }\r\n        const replaceContent = `${description}<br>${downloadEl}`\r\n        return replaceContent\r\n    }\r\n\r\n    static srcUrlResolver(rawUrl) {\r\n        let actualUrl\r\n        if (rawUrl.startsWith(\"http\")) {\r\n            actualUrl = rawUrl\r\n        } else {\r\n            if (\"location\" in globalThis) {\r\n                // in browser\r\n                const hash = location.hash.slice(1)\r\n                // get the parent directory path\r\n                const currentPath = hash.split(\"/\").slice(0, -1).join(\"/\")\r\n                actualUrl = currentPath + \"/\" + rawUrl\r\n            } else {\r\n                // in nodejs\r\n                const path = globalThis.__ResourcePath__\r\n                actualUrl = path + \"/\" + rawUrl\r\n            }\r\n        }\r\n        return actualUrl\r\n    }\r\n}\r\n\r\nexport class Image extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"!\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const imageEl = el(\"img\", [], {\r\n            src: actualUrl,\r\n            alt: this.description,\r\n            tabindex: 0,\r\n        })\r\n        if (typeof window == \"object\") {\r\n            imageEl.onclick = e =>\r\n                window.open(e.target.src)\r\n            imageEl.onerror = e => {\r\n                const target = e.target\r\n                target.onclick = null\r\n                target.classList.add(\"load-error\")\r\n            }\r\n        }\r\n        return MediaNode.containerGenerator(imageEl)\r\n    }\r\n}\r\n\r\nexport class Audio extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\":\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const audioEl = el(\"audio\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: true,\r\n        })\r\n        return MediaNode.containerGenerator(audioEl)\r\n    }\r\n}\r\n\r\nexport class Video extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"?\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const videoEl = el(\"video\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: \"true\",\r\n        })\r\n        return MediaNode.containerGenerator(videoEl)\r\n    }\r\n}\r\n\r\nexport const isIframePattern = (source) =>\r\n    MediaNode.patternGenerator(\"@\")(source)\r\n    || source.startsWith(\"@@@\")\r\n\r\nexport class Iframe extends MediaNode {\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            src: actualUrl,\r\n            title: this.description,\r\n            sandbox: \"allow-scripts\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// media nodes end\r\n// --- --- --- ---\r\n\r\n// --- --- --- --- -\r\n// block nodes start\r\n// --- --- --- --- -\r\n\r\nexport class CodeBlock extends BaseNode {\r\n    constructor(content, lang) {\r\n        super()\r\n\r\n        this.lang = lang\r\n        if (typeof window == \"object\") {\r\n            // in browser\r\n            this.content = content\r\n        } else {\r\n            // in node.js\r\n            this.content = content\r\n                .replaceAll(\"<\", \"&lt;\")\r\n                .replaceAll(\">\", \"&gt;\")\r\n        }\r\n    }\r\n    append(content) {\r\n        this.content += content\r\n    }\r\n    toHTML() {\r\n        const isPlaintext = [\"plaintext\", \"text\", \"\"].includes(this.lang)\r\n        if (typeof window == \"object\" && !isPlaintext) {\r\n            globalThis.__LanguageList__.add(this.lang)\r\n        }\r\n        \r\n        let langName\r\n        let langClass\r\n        if (isPlaintext) {\r\n            langClass = \"nohighlight\"\r\n            langName  = \"PLAINTEXT\"\r\n        } else {\r\n            langClass = `language-${this.lang}`\r\n            langName  = this.lang.toUpperCase()\r\n        }\r\n\r\n        const codeEl = el(\"code\", this.content, {\r\n            \"class\": langClass\r\n        })\r\n        return el(\"pre\", codeEl, {\r\n            \"data-language\": langName\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"```\")\r\n}\r\n\r\nexport class DetailsBlock extends BaseNode {\r\n    summary = \"\"\r\n    content = \"\"\r\n\r\n    constructor(content, summary) {\r\n        super()\r\n        \r\n        this.summary = summary\r\n        this.content = mdResolver(content)\r\n    }\r\n    toHTML() {\r\n        const summaryEl = el(\"summary\", this.summary)\r\n        const detailsEl = el(\"details\", summaryEl)\r\n\r\n        const innerNodes = this.content\r\n            .map(node => node.toHTML())\r\n        const childrenEl = el(\"div\", el(\"div\", innerNodes, {\r\n            \"class\": \"details-children\"\r\n        }), {\r\n            \"class\": \"details-children-container\"\r\n        })\r\n        return el(\"div\", [detailsEl, childrenEl], {\r\n            \"class\": \"details\"\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\">>>\")\r\n}\r\n\r\nexport class FormulaBlock extends BaseNode {\r\n    content = \"\"\r\n    description = \"\"\r\n\r\n    constructor(content, description) {\r\n        super()\r\n\r\n        this.content = content\r\n        this.description = description\r\n    }\r\n    toHTML() {\r\n        globalThis.__ContainsFormula__ = true\r\n        return el(\"div\", this.content, {\r\n            \"class\": \"math\",\r\n            title: this.description,\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\"$$$\")\r\n}\r\n\r\nexport class IframeBlock extends BaseNode {\r\n    // injected html codes, used to auto darkmode and send height message\r\n    static #injectedCodes = id => `\\\r\n<style>\r\n@media (prefers-color-scheme: dark) {\r\n  :root {\r\n    color: white;\r\n    background-color: #121212;\r\n  }\r\n}\r\n</style>\r\n<script>\r\nwindow.addEventListener(\"load\", (e) => {\r\n  const iframeRootEl = e.target.documentElement\r\n  const parent = window.parent\r\n  const height = parseFloat(getComputedStyle(iframeRootEl).height)\r\n  parent.postMessage({\r\n    height,\r\n    id: \"${id}\"\r\n  }, \"*\")\r\n})\r\n</script>`\r\n\r\n    constructor(content, description) {\r\n        super()\r\n\r\n        globalThis.__IframeCounter__ += 1\r\n        this.id = \"iframe_\" + globalThis.__IframeCounter__\r\n        this.description = description\r\n\r\n        if (typeof window == \"object\") {\r\n            // in browser\r\n            this.content = content + IframeBlock.#injectedCodes(this.id)\r\n        } else {\r\n            // in node.js\r\n            this.content = content\r\n        }\r\n    }\r\n\r\n    toHTML() {\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            id: this.id,\r\n            title: this.description,\r\n            srcdoc: this.content,\r\n            sandbox: \"allow-scripts\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// block nodes end\r\n// --- --- --- ---\r\n","export default function(line) {\r\n    let indentCount = 0\r\n    let spaceCount = 0\r\n\r\n    for (const ch of line) {\r\n        if (ch.match(/[^\\s\\t]/)) {\r\n            break\r\n        }\r\n\r\n        if (ch == \"\\t\") {\r\n            indentCount += 1\r\n            continue\r\n        }\r\n        if (ch == \" \") {\r\n            spaceCount += 1\r\n        }\r\n        if (spaceCount == 2) {\r\n            spaceCount = 0\r\n            indentCount += 1\r\n        }\r\n    }\r\n    return indentCount\r\n}\r\n","import { List } from \"../node.js\"\r\nimport getIndent from \"../utils/getIndent.js\"\r\n\r\nexport default function listResolver(currentLine, lines) {\r\n    const currentIndent = getIndent(currentLine)\r\n    const currentNode = new List(currentLine)\r\n\r\n    while (lines.length && List.isListPattern(lines[0])) {\r\n        const nextLine = lines.shift()\r\n        const nextIndent = getIndent(nextLine)\r\n        const isNextOrdered = List.orderedPattern(nextLine)\r\n\r\n        if (nextIndent > currentIndent) {\r\n            currentNode.push(listResolver(nextLine, lines))\r\n        } else if (nextIndent == currentIndent && isNextOrdered == currentNode.isOrdered) {\r\n            currentNode.push(List.getContent(nextLine, isNextOrdered))\r\n        } else {\r\n            lines.unshift(nextLine)\r\n            break\r\n        }\r\n    }\r\n    return currentNode\r\n}","import mdResolver from \"../index.js\"\r\nimport { Quote } from \"../node.js\"\r\n\r\nexport default function(firstLine, lines) {\r\n    let quotedContent = firstLine.slice(2) + \"\\n\"\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Quote.pattern(l)) {\r\n            quotedContent += l.slice(2) + \"\\n\"\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n    const children = mdResolver(quotedContent)\r\n    const node = new Quote(children)\r\n    return node\r\n}\r\n","import { Table } from \"../node.js\"\r\n\r\n// input: \"| content | content |\"\"\r\n// output: [\"content\",\"content\"]\r\nfunction tableLineConverter(tableLine) {\r\n    const splited = tableLine.split(\"|\")\r\n    const result = splited\r\n        .filter(item => item.length > 0)\r\n        .map(item => item.trim())\r\n    return result\r\n}\r\n\r\nexport default function(firstLine, lines) {\r\n    const headerText = firstLine\r\n    const contentLines = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Table.pattern(l)) {\r\n            contentLines.push(l)\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n\r\n    const headerCells = tableLineConverter(headerText)\r\n    const contentRows = contentLines.map(tableLineConverter)\r\n    const tableNode = new Table(headerCells, contentRows)\r\n    return tableNode\r\n}\r\n","import { CodeBlock, DetailsBlock, FormulaBlock, Iframe, IframeBlock } from \"../node.js\"\r\n\r\nfunction blockResolverGenerator(endSign, targetClass) {\r\n    return function(firstLine, lines) {\r\n        const description = firstLine.slice(3)\r\n\r\n        let content = \"\"\r\n        while (lines.length) {\r\n            const l = lines.shift()\r\n\r\n            if (l == endSign) {\r\n                break\r\n            }\r\n\r\n            content += l + \"\\n\"\r\n        }\r\n        return new targetClass(content, description)\r\n    }\r\n}\r\n\r\nexport const codeResolver = blockResolverGenerator(\"```\", CodeBlock)\r\nexport const detailsResolver = blockResolverGenerator(\">>>\", DetailsBlock)\r\nexport const formulaResolver = blockResolverGenerator(\"$$$\", FormulaBlock)\r\nexport function iframeResolver(firstLine, lines) {\r\n    const blockResolver = blockResolverGenerator(\"@@@\", IframeBlock)\r\n\r\n    if (!firstLine.startsWith(\"@@@\")) {\r\n        // link to out resource\r\n        return new Iframe(firstLine)\r\n    }\r\n    return blockResolver(firstLine, lines)\r\n}\r\n","import {\r\n    Headline, Quote, Divider,\r\n    List, Para, Table,\r\n    Image, Audio, Video,\r\n    FormulaBlock, CodeBlock,\r\n    isIframePattern,\r\n    DetailsBlock\r\n} from \"./node.js\"\r\nimport {\r\n    listResolver, quoteResolver, tableResolver,\r\n    codeResolver, formulaResolver, iframeResolver, detailsResolver,\r\n} from \"./resolvers/index.js\"\r\nimport getLines from \"./utils/getLines.js\"\r\n\r\nexport default function mdResolver(source) {\r\n    const lines = getLines(source)\r\n    const nodes = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (l.length == 0) {\r\n            continue\r\n        }\r\n\r\n        if (Headline.pattern(l)) {\r\n            nodes.push(new Headline(l))\r\n        } else\r\n        if (Divider.pattern(l)) {\r\n            nodes.push(new Divider)\r\n        } else\r\n        if (Quote.pattern(l)) {\r\n            nodes.push(quoteResolver(l, lines))\r\n        } else\r\n        if (List.isListPattern(l)) {\r\n            nodes.push(listResolver(l, lines))\r\n        } else\r\n        if (Table.pattern(l)) {\r\n            nodes.push(tableResolver(l, lines))\r\n        } else\r\n        if (Image.pattern(l)) {\r\n            nodes.push(new Image(l))\r\n        } else\r\n        if (Audio.pattern(l)) {\r\n            nodes.push(new Audio(l))\r\n        } else\r\n        if (Video.pattern(l)) {\r\n            nodes.push(new Video(l))\r\n        } else\r\n        if (DetailsBlock.pattern(l)) {\r\n            nodes.push(detailsResolver(l, lines))\r\n        } else\r\n        if (FormulaBlock.pattern(l)) {\r\n            nodes.push(formulaResolver(l, lines))\r\n        } else\r\n        if (CodeBlock.pattern(l)) {\r\n            nodes.push(codeResolver(l, lines))\r\n        } else\r\n        if (isIframePattern(l)) {\r\n            nodes.push(iframeResolver(l, lines))\r\n        } else {\r\n            nodes.push(new Para(l))\r\n        }\r\n    }\r\n    return nodes\r\n}","export default function(source) {\r\n    if (source.indexOf(\"\\r\") != -1) {\r\n        return source.split(\"\\r\\n\")\r\n    } else {\r\n        return source.split(\"\\n\")\r\n    }\r\n}","import keydownEvent from \"../scripts/keydownEvent.js\"\r\nimport { importHighlighter, importTexRenderer } from \"../scripts/importer.js\"\r\nimport el from \"./markdown/utils/el.js\"\r\nimport mdResolver from \"./markdown/index.js\"\r\nimport pageManager from \"../scripts/pageManager.js\"\r\n\r\nconst articleEl        = document.querySelector(\"article:not(#directory-description)\")\r\nconst mainEl           = document.querySelector(\"main\")\r\nconst dirDescriptionEl = mainEl.querySelector(\"#directory-description\")\r\nconst parentDirBtn     = mainEl.querySelector(\"#previous-dir li\")\r\nconst articleList      = mainEl.querySelector(\"#article-list\")\r\n\r\n// ----------------\r\n// article renderer\r\n// ----------------\r\n\r\nfunction mdEntry(mdContent) {\r\n    // language names to import\r\n    globalThis.__LanguageList__ = new Set()\r\n    // to deside whether to import `katex`\r\n    globalThis.__ContainsFormula__ = false\r\n    // used to dynamic generate iframe id\r\n    globalThis.__IframeCounter__ = 0\r\n\r\n    const structure = mdResolver(mdContent)\r\n\r\n    let resultNodes = structure\r\n        .map(node => node.toHTML())\r\n    if (!resultNodes.length) {\r\n        resultNodes = el(\"h1\", \"404 Not Found\")\r\n    }\r\n    return resultNodes\r\n}\r\n\r\nexport function articleRender(articleContent) {\r\n    const resultNodes = mdEntry(articleContent)\r\n    articleEl.innerHTML = \"\"\r\n    resultNodes.forEach(el => articleEl.appendChild(el))\r\n\r\n    mainEl.style.display = \"none\"\r\n    articleEl.style.display = \"block\"\r\n    articleEl.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n    // return to the top\r\n    document.body.scrollTop = 0\r\n    document.documentElement.scrollTop = 0\r\n\r\n    importHighlighter().then(() => globalThis.__LanguageList__ = null)\r\n    importTexRenderer().then(() => globalThis.__ContainsFormula__ = false)\r\n}\r\n\r\n// --------------\r\n// index renderer\r\n// --------------\r\n\r\nparentDirBtn.addEventListener(\"click\", () => {\r\n    const splited = location.hash.split(\"/\")\r\n    pageManager.back()\r\n    // return to parent\r\n    location.hash = splited.slice(0, -2).join(\"/\") + \"/\"\r\n})\r\narticleList.addEventListener(\"click\", (e) => {\r\n    const target = e.target\r\n\r\n    if (target == articleList) {\r\n        // when click on the `articleList` itself\r\n        // ignore this event.\r\n        return\r\n    }\r\n\r\n    if (!target.getAttribute(\"data-target-blog\")) {\r\n        if (target.innerText.endsWith(\"/\")) {\r\n            // open directory\r\n            pageManager.open()\r\n        }\r\n        location.hash += target.innerText\r\n    } else {\r\n        // in `newest` page\r\n        pageManager.open()\r\n        location.hash = target.getAttribute(\"data-target-blog\")\r\n    }\r\n})\r\n\r\nexport function newestItemRenderer(item) {\r\n    const createDate = new Date(item.timestamp)\r\n    const formatedDate = new Intl.DateTimeFormat().format(createDate)\r\n    const dateEl  = el(\"code\", formatedDate)\r\n    const titleEl = el(\"span\", item.title)\r\n    return el(\"li\",\r\n        [dateEl, el(\"text\", \": \"), titleEl],\r\n        {\r\n            tabindex: 0,\r\n            \"data-target-blog\": item.link\r\n        }\r\n    )\r\n}\r\nexport function directoryItemRenderer(item) {\r\n    return el(\"li\", el(\"span\", item), {\r\n        tabindex: 0\r\n    })\r\n}\r\n\r\nexport function indexRender(indexing, itemResolver) {\r\n    // calculate properties\r\n    const {current, total} = indexing\r\n    let isFirstPage = false\r\n    let isLastPage = false\r\n    let isOnlyPage = false\r\n    if (total == 1) {\r\n        isOnlyPage = true\r\n    } else {\r\n        if (current == 1) {\r\n            isFirstPage = true\r\n        }\r\n        if (current == total) {\r\n            isLastPage = true\r\n        }\r\n    }\r\n    mainEl.setAttribute(\"data-is-first-page\", isFirstPage)\r\n    mainEl.setAttribute(\"data-is-last-page\", isLastPage)\r\n    mainEl.setAttribute(\"data-is-only-page\", isOnlyPage)\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    dirDescriptionEl.innerHTML = \"\"\r\n    if (\"directoryDescription\" in indexing) {\r\n        // render directory description\r\n        const resultNodes = mdEntry(indexing.directoryDescription)\r\n        resultNodes.forEach(el => dirDescriptionEl.appendChild(el))\r\n        dirDescriptionEl.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n            el.onkeydown = keydownEvent(el)\r\n        })\r\n\r\n        importHighlighter().then(() => globalThis.__LanguageList__ = null)\r\n        importTexRenderer().then(() => globalThis.__ContainsFormula__ = false)\r\n    }\r\n\r\n    // reset articleList content\r\n    articleList.innerHTML = \"\"\r\n    indexing.content\r\n        .map(itemResolver)\r\n        .forEach(el =>\r\n            articleList.appendChild(el)\r\n        )\r\n\r\n    // set keyboard event\r\n    articleList.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    articleEl.style.display = \"none\"\r\n    mainEl.style.display = \"block\"\r\n\r\n    // return to the top\r\n    document.body.scrollTop = 0\r\n    document.documentElement.scrollTop = 0\r\n}\r\n","import \"./styles/style.css\"\r\nimport \"./libs/katex/katex.css\"\r\n\r\nimport pageManager from \"./scripts/pageManager.js\"\r\nimport { fetchJSON, fetchMD } from \"./scripts/fetchResources.js\"\r\nimport keydownEvent from \"./scripts/keydownEvent.js\"\r\nimport { articleRender, directoryItemRenderer, indexRender, newestItemRenderer } from \"./utils/render.js\"\r\n\r\nconst indexDirPath = \"./.index/\"\r\n\r\n// ---------------------------\r\n// Buttons event setting start\r\n// ---------------------------\r\n\r\nconst lightBtn = document.querySelector(\"#light-btn\")\r\nconst darkBtn = document.querySelector(\"#dark-btn\")\r\nconst previousBtn = document.querySelector(\"button#previous\")\r\nconst nextBtn = document.querySelector(\"button#next\")\r\n\r\nlightBtn.onkeydown = keydownEvent(lightBtn)\r\ndarkBtn.onkeydown = keydownEvent(darkBtn)\r\npreviousBtn.addEventListener(\"click\", () => {\r\n    if (pageManager.current() > 0) {\r\n        pageManager.previous()\r\n        hashEvent()\r\n    }\r\n})\r\nnextBtn.addEventListener(\"click\", () => {\r\n    pageManager.next()\r\n    hashEvent()\r\n})\r\n\r\n// -------------------------\r\n// Buttons event setting end\r\n// -------------------------\r\n\r\n\r\n// ---------------------\r\n// Hash controller start\r\n// ---------------------\r\n\r\nconst mainEl = document.querySelector(\"main\")\r\n\r\nasync function hashEvent() {\r\n    if (!location.hash) {\r\n        location.hash = \"static/\"\r\n        return\r\n    }\r\n\r\n    const hash = location.hash.slice(1) // remove '#'\r\n    mainEl.classList.add(\"disabled\")\r\n\r\n    if (hash == \"newest/\") {\r\n        // open newest page\r\n        const indexPath = indexDirPath + \"newest_\" + pageManager.current()\r\n        const newestIndex = await fetchJSON(indexPath)\r\n        if (!newestIndex) return\r\n        indexRender(newestIndex, newestItemRenderer)\r\n    } else\r\n    if (hash.startsWith(\"static\") && hash.endsWith(\"/\")) {\r\n        // open directory\r\n        const splited = hash.split(\"/\").slice(0, -1)\r\n        const indexFilePath = indexDirPath + splited.join(\"+\") + \"_\" + pageManager.current()\r\n        const index = await fetchJSON(indexFilePath)\r\n        if (!index) return\r\n        indexRender(index, directoryItemRenderer)\r\n    } else\r\n    if (hash.startsWith(\"static\") && hash.endsWith(\".md\")) {\r\n        // open article\r\n        const articleContent = await fetchMD(\"./\" + hash)\r\n        if (!articleContent) return\r\n        articleRender(articleContent)\r\n    } else {\r\n        // the hash \"#static/\" is the homepage\r\n        location.hash = \"static/\"\r\n        return\r\n    }\r\n\r\n    // delay this operation\r\n    mainEl.setAttribute(\"data-is-root\", hash == \"static/\")\r\n    mainEl.classList.remove(\"disabled\")\r\n}\r\n\r\nwindow.addEventListener(\"load\", hashEvent)\r\nwindow.addEventListener(\"hashchange\", hashEvent)\r\nwindow.addEventListener(\"popstate\", () => {\r\n    if (location.hash.endsWith(\"/\")) {\r\n        // in a directory\r\n        pageManager.back()\r\n    }\r\n})\r\nwindow.addEventListener(\"message\", (e) => {\r\n    if (e.origin != \"null\") {\r\n        return\r\n    }\r\n    const { id, height } = e.data\r\n    const targetIframeEl = document.getElementById(id)\r\n    targetIframeEl.style.height = height + \"px\"\r\n}, false)\r\n\r\n// -------------------\r\n// Hash controller end\r\n// -------------------"],"names":["pageManager","pageList","current","length","this","next","previous","back","pop","push","open","controller","async","fetchJSON","path","abort","AbortController","fetch","signal","then","json","res","catch","err","console","log","error","keydownEvent","el","e","key","click","config","homepage","footer","language","enableRSS","value","ignoreDir","enableNewest","pageCapacity","RSSCapacity","previewPort","katexOptions","hljs","katex","importHighlighter","importLangDefs","languageListArr","Array","from","globalThis","__LanguageList__","langDefImporters","filter","name","getLanguage","map","lang","__variableDynamicImportRuntime0__","toLowerCase","Promise","all","langDefs","forEach","defModule","index","def","default","registerLanguage","highlightAll","size","import","module","importTexRenderer","renderFormula","document","querySelectorAll","texString","textContent","render","ParseError","innerHTML","message","replace","__ContainsFormula__","tasks","cssRes","text","cssText","style","createElement","head","appendChild","propToString","props","Object","entries","_","val","undefined","toString","replaceAll","htmlValueFormater","join","tagName","content","createTextNode","targetEl","setAttribute","propSetter","childEl","HTMLElement","Error","contentSetter","getInterval","endSign","includes","intervalText","isEscape","ch","slice","substr","KeyToken_TagName_map","Map","PairedParenMap","TextToken","constructor","toHTML","KeyToken","tagSign","tag","get","realTagName","className","split","elOption","class","parser","LinkToken","address","displayContent","startsWith","href","target","PhoneticToken","notation","ignoredLeftParenthesis","ignoredRightParenthesis","notationEl","concat","source","getFirstChar","charAt","substring","getSpecialTokenClass","tokenSign","targetTokenType","tokens","textTerm","keyTerm","keyStart","isInKey","has","nextCh","specialTokenSign","pairedTokenSign","removedContent","hiddenContent","token","BaseNode","inline","inlineResolver","Headline","super","splited","numberSignStr","numberSignCount","static","match","Para","trimStart","Quote","children","innerNodes","node","Divider","List","isOrdered","Boolean","orderedPattern","getContent","child","childrenHTML","unorderedPattern","line","Table","headerCells","bodyRows","tableHeaderCell","tableBodyCell","tableHeaderRow","row","tableBodyRow","tableHeader","tableBody","MediaNode","description","mdText","containerGenerator","patternGenerator","identifierSign","endsWith","replaceContentGenerator","downloadEl","srcUrlResolver","rawUrl","actualUrl","location","hash","__ResourcePath__","Image","imageEl","src","alt","tabindex","window","onclick","onerror","classList","add","Audio","audioEl","controls","Video","videoEl","isIframePattern","Iframe","iframeEl","title","sandbox","CodeBlock","append","isPlaintext","langName","langClass","toUpperCase","codeEl","DetailsBlock","summary","mdResolver","summaryEl","detailsEl","childrenEl","FormulaBlock","IframeBlock","id","__IframeCounter__","injectedCodes","srcdoc","getIndent","indentCount","spaceCount","listResolver","currentLine","lines","currentIndent","currentNode","isListPattern","nextLine","shift","nextIndent","isNextOrdered","unshift","quoteResolver","firstLine","quotedContent","l","pattern","tableLineConverter","tableLine","item","trim","tableResolver","headerText","contentLines","contentRows","blockResolverGenerator","targetClass","codeResolver","detailsResolver","formulaResolver","iframeResolver","blockResolver","indexOf","getLines","nodes","articleEl","querySelector","mainEl","dirDescriptionEl","parentDirBtn","articleList","mdEntry","mdContent","Set","resultNodes","newestItemRenderer","createDate","Date","timestamp","dateEl","Intl","DateTimeFormat","format","titleEl","link","directoryItemRenderer","indexRender","indexing","itemResolver","total","isFirstPage","isLastPage","isOnlyPage","directoryDescription","onkeydown","display","body","scrollTop","documentElement","addEventListener","getAttribute","innerText","indexDirPath","lightBtn","darkBtn","previousBtn","nextBtn","hashEvent","indexPath","newestIndex","indexFilePath","articleContent","status","DOMException","fetchMD","articleRender","remove","origin","height","data","getElementById"],"mappings":"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"}