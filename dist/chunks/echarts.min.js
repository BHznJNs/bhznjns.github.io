import e from"../../user/build.config.js";class t extends Error{constructor(e){super(),this.message=`"${e}" is a abstract method that should be overrided.`}}const r=e.language,n=["zh","en"];const o=function(e){for(const[t,r]of Object.entries(n))if(e===r)return(...e)=>e[t];return console.warn("Unexpected language: "+e),(...e)=>e[1]}(r);class s{static loadErrMsg=o("加载失败","load error");static renderErrMsg=o("渲染失败","render error");name="";_module=null;_targetElList=null;async importModule(e){throw new t("importModule")}async beforeRender(e){}loadCondition(e){throw new t("loadCondition")}renderItem(e){throw new t("renderItem")}renderAll(e){for(const e of this._targetElList())try{this.renderItem(e)}catch(t){this.renderErrResolver(t,e)}}loadErrResolver(e){console.error(e),this._targetElList().forEach((e=>e.textContent=this.name+" "+s.loadErrMsg))}renderErrResolver(e,t){console.error(e),t.textContent=this.name+" "+s.renderErrMsg}async render(e){if(this.loadCondition(e)){if(null===this._module)try{this._module=await this.importModule(e)}catch(e){return void this.loadErrResolver(e)}await this.beforeRender(e),this.renderAll(e)}}}class i extends s{static loadErrMsg=o("图表加载失败","Chart load error");static renderErrMsg=o("图表渲染失败","Chart render error");name=void 0;loadCondition(){return!0}loadErrResolver(e){console.error(e),this._targetElList().forEach((e=>e.textContent=i.loadErrMsg))}renderErrResolver(e,t){console.error(e),t.textContent=i.renderErrMsg}renderItem(e,r){throw new t("renderItem")}renderAll(){for(const e of this._targetElList()){const t=e.__ChartContent__;try{this.renderItem(e,t)}catch(t){this.renderErrResolver(t,e)}}}}function a(e,t){let r=null;return function(...n){r&&clearTimeout(r),r=setTimeout((()=>e(...n)),t)}}const l=new class{events=new Map;emit(e,...t){const r=this.events.get(e);r&&r.forEach((e=>{e.apply(null,t)}))}on(e,t){const r=this.events.get(e);r?r.push(t):this.events.set(e,[t])}off(e,t){const r=this.events.get(e);if(r)if(1===r.length)this.events.delete(e);else{const e=r.indexOf(t);r.splice(e,1)}}};function d(e={},t={}){for(const r of Object.keys(t)){const n="object"==typeof e[r],o="object"==typeof t[r],s=r in e;if(!s||n)if(s&&n)o&&d(e[r],t[r]);else if(!s)if(o){let n;n="undefined"!=typeof structuredClone?structuredClone(t[r]):JSON.parse(JSON.stringify(t[r])),e[r]=n}else e[r]=t[r]}return e}let[c,h,u]=[null,null,null];const m=e.echartsOptions;function f(e={},t){const r=["width","height","color","backgroundColor","darkMode","textStyle","aria","axisPointer","animation","animationThreshold","animationDuration","animationEasing","animationDelay","animationDurationUpdate","animationEasingUpdate","animationDelayUpdate","stateAnimation","blendMode","hoverLayerThreshold","options","useUTC","media"];for(const n in e)if(!r.includes(n))if("series"!==n){switch(n){case"xAxis":case"yAxis":t.components.add("grid");continue;case"radiusAxis":case"angleAxis":t.components.add("polar");continue;case"parallelAxis":t.components.add("parallel");continue}t.components.add(n)}else{const{series:r}=e;if(!(r instanceof Array)){t.charts.add(r.type);continue}for(const e of r)"type"in e&&t.charts.add(e.type)}}const p=new class extends i{_targetElList=()=>document.querySelectorAll(".echarts-container");#e=new MutationObserver((e=>{for(const e of this._targetElList())this._module.dispose(e),this.renderItem(e)}));#t(){this._targetElList().forEach((e=>c.getInstanceByDom(e).resize()))}#r(e,t){t.width&&(e.style.minWidth="100%",e.style.width=t.width+"px",delete t.width),t.height&&(e.style.height=t.height+"px",delete t.height)}renderItem(e){this.#r(e,e.__ChartOptions__);const t=document.body.classList.contains("dark"),r=t?"another-dark":"light",n=this._module.init(e,r),o=structuredClone(m),s=function(e,t){let r=e;if(t&&"calendar"in e){const t={splitLine:{lineStyle:{color:"white"}},dayLabel:{color:"#eee"},monthLabel:{color:"#eee"},itemStyle:{color:"none",borderWidth:.5}};e.calendar instanceof Array?e.calendar.forEach((e=>d(e,t))):d(e.calendar,t)}return r}(structuredClone(e.__ChartOptions__),t),i=d(o,s);n.setOption(i)}async beforeRender(){const e=Array.from(this._targetElList()).map((e=>e.__ChartOptions__));try{await async function(e){const t={charts:new Set,components:new Set};f(m,t),e.forEach((e=>f(e,t)));const r=Array.from(t.charts).map(h),n=Array.from(t.components).map(u);await Promise.all(r.concat(n)).then(c.use)}(e)}catch(e){this.loadErrResolver(e)}}async importModule(){const[e,t]=await Promise.all([import("../libs/echarts/core.js"),import("./echartsAnotherDarkTheme.min.js")]);c=e.default,h=e.importChart,u=e.importComponent,c.registerTheme("another-dark",t.default);const r=document.body;return this.#e.observe(r,{attributes:!0,attributeFilter:["class"]}),l.on("catalog-toggle",(()=>{setTimeout(this.#t.bind(this),1e3)})),window.addEventListener("resize",a(this.#t.bind(this),200)),c}};var g=p.render.bind(p);export{i as C,s as D,l as a,a as d,g as e,o as l};
//# sourceMappingURL=echarts.min.js.map
