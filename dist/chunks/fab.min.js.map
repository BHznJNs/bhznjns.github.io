{"version":3,"file":"fab.min.js","sources":["../../src/scripts/textScaler.js","../../src/utils/getRem.js","../../src/components/fab.js"],"sourcesContent":["import getRem from \"../utils/getRem.js\"\r\n\r\nconst articleEl = document.querySelector(\"article\")\r\n\r\nlet fontSizeOffset = 0\r\nfunction setIframesRem(fontSize) {\r\n    const embeddedIframes = document.querySelectorAll(\"article iframe[srcdoc]\")\r\n    embeddedIframes.forEach(el =>\r\n        el.contentWindow.postMessage({ fontSize }, \"*\"))\r\n}\r\nfunction textScalerCreator(callback) {\r\n    return function() {\r\n        callback()\r\n        const baseSize = getRem()\r\n        const targetFontSize = baseSize + fontSizeOffset + \"px\"\r\n        articleEl.style.fontSize = targetFontSize\r\n        setIframesRem(targetFontSize)\r\n    }\r\n}\r\nexport const enlargeText  = textScalerCreator(() => fontSizeOffset += 1)\r\nexport const downsizeText = textScalerCreator(() => fontSizeOffset -= 1)\r\n","export default function() {\r\n    const remPx = getComputedStyle(document.documentElement).fontSize\r\n    const remInt = Number.parseInt(remPx)\r\n    return remInt\r\n}","import \"../styles/components/fab.css\"\r\nimport pathManager from \"../scripts/pathManager.js\"\r\nimport config from \"../../build.config.js\"\r\nimport el from \"../utils/el.js\"\r\nimport backToTop from \"../utils/backToTop.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\nimport { downsizeText, enlargeText } from \"../scripts/textScaler.js\"\r\nimport eventbus from \"../utils/eventbus/inst.js\"\r\n\r\nconst fabItem = (imgName, title) => el(\"button\",\r\n    el(\"img\", \"\", {\r\n        src: `./dist/imgs/fab-${imgName}.svg`,\r\n        loading: \"lazy\",\r\n        onerror() {\r\n            this.src = \"./dist/imgs/broken-image.svg\"\r\n        }\r\n    }),\r\n    { title }\r\n)\r\n\r\nclass FabIcon extends HTMLElement {\r\n    #switcher = null\r\n    #subItems = {}\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        const switcher = this.#switcher = fabItem(\"switch\"        , languageSelector(\"切换浮动操作按钮\", \"Switch The FAB\"))\r\n        this.#subItems.backToParent     = fabItem(\"back-to-parent\", languageSelector(\"返回父级\"       , \"Back to Parent\"))\r\n        this.#subItems.backToTop        = fabItem(\"back-to-top\"   , languageSelector(\"返回顶部\"       , \"Back to Top\"   ))\r\n        this.#subItems.enlargeText      = fabItem(\"zoom-out\"      , languageSelector(\"放大文本\"       , \"Enlarge Text\"  ))\r\n        this.#subItems.downsizeText     = fabItem(\"zoom-in\"       , languageSelector(\"缩小文本\"       , \"Downsize Text\" ))\r\n        if (config.enableCatalog) {\r\n            this.#subItems.catalogSwitcher =\r\n                fabItem(\"catalog\", languageSelector(\"开启/关闭菜单\" , \"Open/Close Catalog\"))\r\n        }\r\n\r\n        const subFabItem = config.fabOrdering\r\n            .map(fabItem => this.#subItems[fabItem])\r\n            .filter(fabItem => fabItem !== undefined)\r\n        for (const [index, item] of Object.entries(subFabItem)) {\r\n            item.style.setProperty(\"--fab-item-index\", Number(index) + 1)\r\n        }\r\n\r\n        switcher.id = \"switcher\"\r\n        this.classList.add(\"hidden\")\r\n        this.classList.add(\"unseen\")\r\n        this.#appendEvent()\r\n        this.style.setProperty(\"--fab-item-count\", subFabItem.length + 1)\r\n        for (const el of [switcher].concat(subFabItem)) {\r\n            this.appendChild(el)\r\n        }\r\n    }\r\n\r\n    #appendEvent() {\r\n        this.#switcher.addEventListener(\"click\", () => {\r\n            this.classList.remove(\"unseen\")\r\n            this.classList.toggle(\"hidden\")\r\n        })\r\n        this.#subItems.backToParent.addEventListener(\"click\", () => {\r\n            pathManager.jumpTo(pathManager.parent())\r\n        })\r\n        this.#subItems.backToTop.addEventListener(\"click\", backToTop)\r\n        this.#subItems.enlargeText.addEventListener(\"click\", enlargeText)\r\n        this.#subItems.downsizeText.addEventListener(\"click\", downsizeText)\r\n        this.#subItems.catalogSwitcher.addEventListener(\"click\", () => {\r\n            eventbus.emit(\"catalog-toggle\")\r\n        })\r\n\r\n        const toggleCatalogSwitcherState = () => {\r\n            const catalogSwitcher = this.#subItems.catalogSwitcher\r\n            const isInArticle = pathManager.isIn.article()\r\n            catalogSwitcher.disabled = !isInArticle\r\n        }\r\n        window.addEventListener(\"hashchange\", toggleCatalogSwitcherState)\r\n        toggleCatalogSwitcherState()\r\n    }\r\n}\r\ncustomElements.define(\"fab-icon\", FabIcon)\r\n"],"names":["articleEl","document","querySelector","fontSizeOffset","textScalerCreator","callback","targetFontSize","remPx","getComputedStyle","documentElement","fontSize","Number","parseInt","getRem","style","querySelectorAll","forEach","el","contentWindow","postMessage","enlargeText","downsizeText","fabItem","imgName","title","src","loading","onerror","this","FabIcon","HTMLElement","switcher","subItems","constructor","super","languageSelector","backToParent","backToTop","catalogSwitcher","subFabItem","config","fabOrdering","map","filter","undefined","index","item","Object","entries","setProperty","id","classList","add","appendEvent","length","concat","appendChild","addEventListener","remove","toggle","pathManager","jumpTo","parent","eventbus","emit","toggleCatalogSwitcherState","isInArticle","isIn","article","disabled","window","customElements","define"],"mappings":"uEAEA,MAAMA,EAAYC,SAASC,cAAc,WAEzC,IAAIC,EAAiB,EAMrB,SAASC,EAAkBC,GACvB,OAAO,WACHA,IACA,MACMC,ECdC,WACX,MAAMC,EAAQC,iBAAiBP,SAASQ,iBAAiBC,SAEzD,OADeC,OAAOC,SAASL,EAEnC,CDSyBM,GACiBV,EAAiB,KAT3D,IAAuBO,EAUfV,EAAUc,MAAMJ,SAAWJ,EAVZI,EAWDJ,EAVML,SAASc,iBAAiB,0BAClCC,SAAQC,GACpBA,EAAGC,cAAcC,YAAY,CAAET,YAAY,MAS9C,CACL,CACO,MAAMU,EAAehB,GAAkB,IAAMD,GAAkB,IACzDkB,EAAejB,GAAkB,IAAMD,GAAkB,IEXhEmB,EAAU,CAACC,EAASC,IAAUP,EAAG,SACnCA,EAAG,MAAO,GAAI,CACVQ,IAAK,mBAAmBF,QACxBG,QAAS,OACT,OAAAC,GACIC,KAAKH,IAAM,8BACd,IAEL,CAAED,UAGN,MAAMK,UAAgBC,YAClBC,GAAY,KACZC,GAAY,CAAE,EAEd,WAAAC,GACIC,QAEA,MAAMH,EAAWH,MAAKG,EAAYT,EAAQ,SAAkBa,EAAiB,WAAY,mBACzFP,MAAKI,EAAUI,aAAmBd,EAAQ,iBAAkBa,EAAiB,OAAe,mBAC5FP,MAAKI,EAAUK,UAAmBf,EAAQ,cAAkBa,EAAiB,OAAe,gBAC5FP,MAAKI,EAAUZ,YAAmBE,EAAQ,WAAkBa,EAAiB,OAAe,iBAC5FP,MAAKI,EAAUX,aAAmBC,EAAQ,UAAkBa,EAAiB,OAAe,kBAExFP,MAAKI,EAAUM,gBACXhB,EAAQ,UAAWa,EAAiB,UAAY,uBAGxD,MAAMI,EAAaC,EAAOC,YACrBC,KAAIpB,GAAWM,MAAKI,EAAUV,KAC9BqB,QAAOrB,QAAuBsB,IAAZtB,IACvB,IAAK,MAAOuB,EAAOC,KAASC,OAAOC,QAAQT,GACvCO,EAAKhC,MAAMmC,YAAY,mBAAoBtC,OAAOkC,GAAS,GAG/Dd,EAASmB,GAAK,WACdtB,KAAKuB,UAAUC,IAAI,UACnBxB,KAAKuB,UAAUC,IAAI,UACnBxB,MAAKyB,IACLzB,KAAKd,MAAMmC,YAAY,mBAAoBV,EAAWe,OAAS,GAC/D,IAAK,MAAMrC,IAAM,CAACc,GAAUwB,OAAOhB,GAC/BX,KAAK4B,YAAYvC,EAExB,CAED,EAAAoC,GACIzB,MAAKG,EAAU0B,iBAAiB,SAAS,KACrC7B,KAAKuB,UAAUO,OAAO,UACtB9B,KAAKuB,UAAUQ,OAAO,SAAS,IAEnC/B,MAAKI,EAAUI,aAAaqB,iBAAiB,SAAS,KAClDG,EAAYC,OAAOD,EAAYE,SAAS,IAE5ClC,MAAKI,EAAUK,UAAUoB,iBAAiB,QAASpB,GACnDT,MAAKI,EAAUZ,YAAYqC,iBAAiB,QAASrC,GACrDQ,MAAKI,EAAUX,aAAaoC,iBAAiB,QAASpC,GACtDO,MAAKI,EAAUM,gBAAgBmB,iBAAiB,SAAS,KACrDM,EAASC,KAAK,iBAAiB,IAGnC,MAAMC,EAA6B,KAC/B,MAAM3B,EAAkBV,MAAKI,EAAUM,gBACjC4B,EAAcN,EAAYO,KAAKC,UACrC9B,EAAgB+B,UAAYH,CAAW,EAE3CI,OAAOb,iBAAiB,aAAcQ,GACtCA,GACH,EAELM,eAAeC,OAAO,WAAY3C"}