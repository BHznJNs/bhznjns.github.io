{"version":3,"file":"catalog.min.js","sources":["../../src/components/catalog.js","../../src/utils/throttle.js"],"sourcesContent":["import \"../styles/components/catalog.css\"\r\nimport pathManager from \"../scripts/pathManager\"\r\nimport throttle from \"../utils/throttle.js\"\r\nimport eventbus from \"../utils/eventbus/inst.js\"\r\nimport el from \"../utils/dom/el.js\"\r\nimport { scrollToEl } from \"../utils/dom/scrollControl.js\"\r\n\r\nfunction catalogItemRenderer({ level, content, id }) {\r\n    const contentEl = el(\"div\",\r\n        el(\"span\", content, {\r\n            \"class\": \"underline-target\"\r\n        })\r\n    )\r\n    return el(\"li\", contentEl, {\r\n        \"class\": [\r\n            \"level-\" + level,\r\n            \"underline-through\",\r\n        ].join(\" \"),\r\n        \"data-target-headline\": id\r\n    })\r\n}\r\n\r\nclass Catalog extends HTMLElement {\r\n    rootNode = null\r\n    constructor() {\r\n        super()\r\n\r\n        this.rootNode = el(\"ol\")\r\n        this.classList.add(\"hidden\")\r\n        this.appendChild(this.rootNode)\r\n        this.#appendEvent()\r\n    }\r\n\r\n    #appendEvent() {\r\n        this.rootNode.addEventListener(\"click\", throttle(e => {\r\n            const targetId = e.target.getAttribute(\"data-target-headline\")\r\n            if (!targetId) {\r\n                return\r\n            }\r\n            const targetHeadlineEl = document.getElementById(targetId)\r\n            scrollToEl(targetHeadlineEl, 16)\r\n        }, 200))\r\n        window.addEventListener(\"hashchange\", () => {\r\n            if (pathManager.isIn.article()) {\r\n                return\r\n            }\r\n            this.classList.add(\"hidden\")\r\n            eventbus.emit(\"catalog-closed\")\r\n        })\r\n        eventbus.on(\"catalog-toggle\", () => {\r\n            this.classList.toggle(\"hidden\")\r\n        })\r\n        eventbus.on(\r\n            \"article-rendered\",\r\n            this.render.bind(this)\r\n        )\r\n    }\r\n\r\n    // input: [{ level, content }]\r\n    async render(items) {\r\n        this.rootNode.innerHTML = \"\"\r\n        items\r\n            .map(catalogItemRenderer)\r\n            .forEach(el => this.rootNode.appendChild(el))\r\n    }\r\n}\r\ncustomElements.define(\"article-catalog\", Catalog)\r\n","export default function(callback, waitMillisecond) {\r\n    let timer = null\r\n    let hasBeenCalled = false\r\n\r\n    return function(...args) {\r\n        let result\r\n        if (!hasBeenCalled) {\r\n            result = callback(...args)\r\n            hasBeenCalled = true;\r\n        }\r\n\r\n        timer = setTimeout(() => {\r\n            hasBeenCalled = false\r\n        }, waitMillisecond)\r\n        return result\r\n    }\r\n}\r\n"],"names":["catalogItemRenderer","level","content","id","contentEl","el","class","join","Catalog","HTMLElement","rootNode","constructor","super","this","classList","add","appendChild","appendEvent","addEventListener","callback","waitMillisecond","hasBeenCalled","args","result","setTimeout","throttle","e","targetId","target","getAttribute","targetHeadlineEl","document","getElementById","scrollToEl","window","pathManager","isIn","article","eventbus","emit","on","toggle","render","bind","items","innerHTML","map","forEach","customElements","define"],"mappings":"kFAOA,SAASA,GAAoBC,MAAEA,EAAKC,QAAEA,EAAOC,GAAEA,IAC3C,MAAMC,EAAYC,EAAG,MACjBA,EAAG,OAAQH,EAAS,CAChBI,MAAS,sBAGjB,OAAOD,EAAG,KAAMD,EAAW,CACvBE,MAAS,CACL,SAAWL,EACX,qBACFM,KAAK,KACP,uBAAwBJ,GAEhC,CAEA,MAAMK,UAAgBC,YAClBC,SAAW,KACX,WAAAC,GACIC,QAEAC,KAAKH,SAAWL,EAAG,MACnBQ,KAAKC,UAAUC,IAAI,UACnBF,KAAKG,YAAYH,KAAKH,UACtBG,MAAKI,GACR,CAED,EAAAA,GACIJ,KAAKH,SAASQ,iBAAiB,QClCxB,SAASC,EAAUC,GAE9B,IAAIC,GAAgB,EAEpB,OAAO,YAAYC,GACf,IAAIC,EASJ,OARKF,IACDE,EAASJ,KAAYG,GACrBD,GAAgB,GAGZG,YAAW,KACfH,GAAgB,CAAK,GACtBD,GACIG,CACV,CACL,CDkBgDE,EAASC,IAC7C,MAAMC,EAAWD,EAAEE,OAAOC,aAAa,wBACvC,IAAKF,EACD,OAEJ,MAAMG,EAAmBC,SAASC,eAAeL,GACjDM,EAAWH,EAAkB,GAAG,GACjC,MACHI,OAAOhB,iBAAiB,cAAc,KAC9BiB,EAAYC,KAAKC,YAGrBxB,KAAKC,UAAUC,IAAI,UACnBuB,EAASC,KAAK,kBAAiB,IAEnCD,EAASE,GAAG,kBAAkB,KAC1B3B,KAAKC,UAAU2B,OAAO,SAAS,IAEnCH,EAASE,GACL,mBACA3B,KAAK6B,OAAOC,KAAK9B,MAExB,CAGD,YAAM6B,CAAOE,GACT/B,KAAKH,SAASmC,UAAY,GAC1BD,EACKE,IAAI9C,GACJ+C,SAAQ1C,GAAMQ,KAAKH,SAASM,YAAYX,IAChD,EAEL2C,eAAeC,OAAO,kBAAmBzC"}