{"version":3,"file":"catalog.min.js","sources":["../../src/components/catalog.js","../../src/utils/throttle.js"],"sourcesContent":["import pathManager from \"../scripts/pathManager\"\r\nimport \"../styles/components/catalog.css\"\r\nimport el from \"../utils/el.js\"\r\nimport eventbus from \"../utils/eventbus/inst.js\"\r\nimport throttle from \"../utils/throttle\"\r\n\r\nfunction catalogItemRenderer({ level, content, id }) {\r\n    const contentEl = el(\"span\", content, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    return el(\"li\", contentEl, {\r\n        \"class\": [\r\n            \"level-\" + level,\r\n            \"underline-through\",\r\n        ].join(\" \"),\r\n        \"data-target-headline\": id\r\n    })\r\n}\r\n\r\nfunction scrollToTarget(e) {\r\n    const targetId = e.target.getAttribute(\"data-target-headline\")\r\n    if (!targetId) {\r\n        return\r\n    }\r\n    const targetHeadlineEl = document.getElementById(targetId)\r\n    const scrollTargetPos = targetHeadlineEl.offsetTop\r\n    const scrollOffset = -16\r\n    window.scroll({\r\n        top: scrollTargetPos + scrollOffset,\r\n        behavior: \"smooth\",\r\n    })\r\n}\r\n\r\nclass Catalog extends HTMLElement {\r\n    rootNode = null\r\n    constructor() {\r\n        super()\r\n\r\n        this.rootNode = el(\"ol\")\r\n        this.classList.add(\"hidden\")\r\n        this.appendChild(this.rootNode)\r\n        this.#appendEvent()\r\n    }\r\n\r\n    #appendEvent() {\r\n        this.rootNode.addEventListener(\"click\", throttle(scrollToTarget, 200))\r\n        window.addEventListener(\"hashchange\", () => {\r\n            if (pathManager.isIn.article()) {\r\n                return\r\n            }\r\n            this.classList.add(\"hidden\")\r\n            eventbus.emit(\"catalog-closed\")\r\n        })\r\n        eventbus.on(\"catalog-toggle\", () => {\r\n            this.classList.toggle(\"hidden\")\r\n        })\r\n        eventbus.on(\r\n            \"article-rendered\",\r\n            this.render.bind(this)\r\n        )\r\n    }\r\n\r\n    // input: [{ level, content }]\r\n    async render(items) {\r\n        this.rootNode.innerHTML = \"\"\r\n        items\r\n            .map(catalogItemRenderer)\r\n            .forEach(el => this.rootNode.appendChild(el))\r\n    }\r\n}\r\ncustomElements.define(\"article-catalog\", Catalog)\r\n","export default function(callback, waitMillisecond) {\r\n    let timer = null\r\n    let hasBeenCalled = false\r\n\r\n    return function(...args) {\r\n        let result\r\n        if (!hasBeenCalled) {\r\n            result = callback(...args)\r\n            hasBeenCalled = true;\r\n        }\r\n\r\n        timer = setTimeout(() => {\r\n            hasBeenCalled = false\r\n        }, waitMillisecond)\r\n        return result\r\n    }\r\n}\r\n"],"names":["catalogItemRenderer","level","content","id","contentEl","el","class","join","scrollToTarget","e","targetId","target","getAttribute","scrollTargetPos","document","getElementById","offsetTop","window","scroll","top","behavior","Catalog","HTMLElement","rootNode","constructor","super","this","classList","add","appendChild","appendEvent","addEventListener","callback","waitMillisecond","hasBeenCalled","args","result","setTimeout","throttle","pathManager","isIn","article","eventbus","emit","on","toggle","render","bind","items","innerHTML","map","forEach","customElements","define"],"mappings":"6CAMA,SAASA,GAAoBC,MAAEA,EAAKC,QAAEA,EAAOC,GAAEA,IAC3C,MAAMC,EAAYC,EAAG,OAAQH,EAAS,CAClCI,MAAS,qBAEb,OAAOD,EAAG,KAAMD,EAAW,CACvBE,MAAS,CACL,SAAWL,EACX,qBACFM,KAAK,KACP,uBAAwBJ,GAEhC,CAEA,SAASK,EAAeC,GACpB,MAAMC,EAAWD,EAAEE,OAAOC,aAAa,wBACvC,IAAKF,EACD,OAEJ,MACMG,EADmBC,SAASC,eAAeL,GACRM,UAEzCC,OAAOC,OAAO,CACVC,IAAKN,GAFa,GAGlBO,SAAU,UAElB,CAEA,MAAMC,UAAgBC,YAClBC,SAAW,KACX,WAAAC,GACIC,QAEAC,KAAKH,SAAWlB,EAAG,MACnBqB,KAAKC,UAAUC,IAAI,UACnBF,KAAKG,YAAYH,KAAKH,UACtBG,MAAKI,GACR,CAED,EAAAA,GACIJ,KAAKH,SAASQ,iBAAiB,QC7CxB,SAASC,EAAUC,GAE9B,IAAIC,GAAgB,EAEpB,OAAO,YAAYC,GACf,IAAIC,EASJ,OARKF,IACDE,EAASJ,KAAYG,GACrBD,GAAgB,GAGZG,YAAW,KACfH,GAAgB,CAAK,GACtBD,GACIG,CACV,CACL,CD6BgDE,CAAS9B,EAAgB,MACjES,OAAOc,iBAAiB,cAAc,KAC9BQ,EAAYC,KAAKC,YAGrBf,KAAKC,UAAUC,IAAI,UACnBc,EAASC,KAAK,kBAAiB,IAEnCD,EAASE,GAAG,kBAAkB,KAC1BlB,KAAKC,UAAUkB,OAAO,SAAS,IAEnCH,EAASE,GACL,mBACAlB,KAAKoB,OAAOC,KAAKrB,MAExB,CAGD,YAAMoB,CAAOE,GACTtB,KAAKH,SAAS0B,UAAY,GAC1BD,EACKE,IAAIlD,GACJmD,SAAQ9C,GAAMqB,KAAKH,SAASM,YAAYxB,IAChD,EAEL+C,eAAeC,OAAO,kBAAmBhC"}