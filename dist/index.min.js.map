{"version":3,"file":"index.min.js","sources":["../src/scripts/fetchResources.js","../build.config.js","../src/scripts/importer.js","../src/utils/el.js","../src/utils/markdown/utils/getInterval.js","../src/utils/markdown/inline.js","../src/utils/htmlEntityReplace.js","../src/utils/languageSelector.js","../src/utils/markdown/node.js","../src/utils/markdown/utils/getIndent.js","../src/utils/markdown/resolvers/listResolver.js","../src/utils/markdown/resolvers/quoteResolver.js","../src/utils/markdown/resolvers/tableResolver.js","../src/utils/markdown/resolvers/blockResolvers.js","../src/utils/markdown/index.js","../src/utils/markdown/utils/getLines.js","../src/utils/keydownEvent.js","../src/utils/backToTop.js","../src/utils/eventbus/inst.js","../src/utils/eventbus/index.js","../src/scripts/articleRenderer.js","../src/scripts/indexRenderer.js","../src/scripts/pathManager.js","../src/components/paging.js","../src/scripts/mainManager.js","../src/index.js"],"sourcesContent":["let controller = null\r\n\r\nexport async function fetchJSON(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            const json = await res.json()\r\n            controller = null\r\n            return json\r\n        })\r\n        .catch(err => {\r\n            console.log(\"JSON request error: \" + path)\r\n            console.error(err)\r\n            return null\r\n        })\r\n}\r\n\r\nexport async function fetchMD(path) {\r\n    controller && controller.abort()\r\n    controller = new AbortController()\r\n\r\n    return await fetch(path, { signal: controller.signal })\r\n        .then(async res => {\r\n            if (res.status != 200) {\r\n                throw res.status\r\n            }\r\n            const text = await res.text()\r\n            controller = null\r\n            return text\r\n        })\r\n        .catch(err => {\r\n            if (typeof err != \"number\") {\r\n                console.error(err)\r\n                return null\r\n            }\r\n\r\n            switch (err) {\r\n                // render error code in markdown format\r\n                case 404:\r\n                    return \"# 404 Not Found\"\r\n                case 500:\r\n                    return \"# 500 Internal Server Error\"\r\n                case DOMException:\r\n                    console.error(err)\r\n                    break\r\n                default:\r\n                    console.log(\"Markdown request error: \" + path)\r\n                    console.error(err)\r\n                    return \"# Unexpected request error\"\r\n            }\r\n        })\r\n}\r\n","export default {\r\n    /**\r\n     * homepage: String\r\n     * the URL that this site deployed, is used to generate the rss.xml file\r\n     * 此站点部署的 URL，用于生成 rss.xml 文件\r\n     */\r\n    homepage: \"https://bhznjns.github.io/markdown-blog/\",\r\n\r\n    /**\r\n     * title: String\r\n     * the title of blog HTML document, will be shown in the tabbar of browser\r\n     * 博客 HTML 文档的标题，会被展示在浏览器的标签栏\r\n     */\r\n    title: \"BHznJNs' Blog\",\r\n\r\n    /**\r\n     * footer: String\r\n     * the footer for this site, can be deleted if you do not need it\r\n     * 站点的脚注，如果你不需要可以删除\r\n     */\r\n    footer: \"::Powered by [MarkdownBlog](https://github.com/BHznJNs/markdown-blog)::\",\r\n\r\n    /**\r\n     * language: String\r\n     * \"zh\" => Simplified Chinese 简体中文\r\n     * \"en\" => English            英文\r\n     */\r\n    language: \"zh\",\r\n\r\n    /**\r\n     * enableFab: Boolean\r\n     * used to enable / disable the FAB buttons\r\n     * 用来启用/禁用浮动操作按钮\r\n     */\r\n    enableFab: true,\r\n    /**\r\n     * fabOrdering: [String]\r\n     * defines the ordering of FAB buttons, if you do need some FAB button, just remove it\r\n     * 定义浮动操作按钮的顺序，如果你不需要某个浮动操作按钮，直接将其移除即可\r\n     */\r\n    fabOrdering: [\r\n        \"catalogSwitcher\",\r\n        \"downsizeText\",\r\n        \"enlargeText\",\r\n        \"backToParent\",\r\n        \"backToTop\",\r\n    ],\r\n\r\n    /**\r\n     * enableCatalog: Boolean\r\n     * used to enable / disable the catalog feature\r\n     * 用来启用/禁用文章目录功能\r\n     */\r\n    enableCatalog: true,\r\n\r\n    /**\r\n     * enableRSS: Boolean\r\n     * used to enable / disable the RSS function, if you do not want add blogs in some directory to the `rss.xml` , just add it into the `rssIgnoreDir`\r\n     * 用来启用/禁用 RSS 发布功能，如果你不想将某些文件夹的内容添加到 `rss.xml` 中，将其添加到 `rssIgnoreDir` 中\r\n     */\r\n    enableRSS: true,\r\n    rssIgnoreDir: [\r\n        // directories in `static`\r\n        \"学习笔记/\"\r\n    ],\r\n\r\n    /**\r\n     * enableNewest: Boolean | Object<value: Boolean, ignoreDir: [String]>\r\n     * used to enable / disable the Newest function, if you do not want add blogs in some directory, just add it into the `newestIgnoreDir`\r\n     * 用来启用/禁用 最新博文 功能，如果你不想将某些文件夹的内容添加到其中，将其添加到 `newestIgnoreDir` 中\r\n     */\r\n    enableNewest: true,\r\n    newestIgnoreDir: [],\r\n\r\n    /**\r\n     * pageCapacity: Number\r\n     * defined the amount of the items in every page\r\n     * 定义每一页展示的博文数\r\n     */\r\n    pageCapacity: 10,\r\n\r\n    /**\r\n     * RSSCapacity: Number\r\n     * defined the amount of the items in `rss.xml`\r\n     * 定义 `rss.xml` 中包含的博文个数\r\n     */\r\n    RSSCapacity: 16,\r\n\r\n    /**\r\n     * previewPort: Number\r\n     * defined the port id for preview server\r\n     * 为预览服务器定义端口\r\n     */\r\n    previewPort: 3000,\r\n\r\n    /**\r\n     * katexOptions: Object\r\n     * options for katex.js rendering, see here: https://katex.org/docs/options\r\n     * katex.js 用于渲染数学公式的配置项，见此：https://katex.org/docs/options\r\n     */\r\n    katexOptions: null\r\n}\r\n","import config from \"../../build.config.js\"\r\n\r\nfunction importStyle(path) {\r\n    const linkEl = document.createElement(\"link\")\r\n    linkEl.rel  = \"stylesheet\"\r\n    linkEl.href = path\r\n    document.head.appendChild(linkEl)\r\n}\r\n\r\nexport async function importComponent(name) {\r\n    await import(`../components/${name}.js`)\r\n    importStyle(`./dist/chunks/${name}.min.css`)\r\n}\r\n\r\nconst { katexOptions } = config\r\nlet hljs  = null\r\nlet katex = null\r\n\r\nexport async function importHighlighter() {\r\n    function importLangDefs() {\r\n        // dynamically import language definitions\r\n        const languageListArr = Array.from(globalThis.__LanguageList__)\r\n        const langDefImporters = languageListArr\r\n            .filter(name => !hljs.getLanguage(name))\r\n            .map(lang => import(`../libs/highlight-es/languages/${lang.toLowerCase()}.js`))\r\n\r\n        Promise.all(langDefImporters)\r\n            .then(langDefs => langDefs.forEach((defModule, index) => {\r\n                const name = languageListArr[index]\r\n                const def  = defModule.default\r\n                hljs.registerLanguage(name, def)\r\n            }))\r\n            .then(() => hljs.highlightAll())\r\n            .catch(err => console.error(err))\r\n    }\r\n\r\n    if (!globalThis.__LanguageList__.size) {\r\n        // no code blocks\r\n        return\r\n    }\r\n    if (hljs) {\r\n        importLangDefs()\r\n        return\r\n    }\r\n\r\n    // import highlight.js itself\r\n    await import(\"../libs/highlight-es/highlight.min.js\")\r\n        .then(module => hljs = module.default)\r\n        .then(importLangDefs)\r\n        .catch(err => console.error(err))\r\n}\r\n\r\nexport async function importTexRenderer() {\r\n    function renderFormula() {\r\n        // render all formula element\r\n        document.querySelectorAll(\".math\")\r\n            .forEach(el => {\r\n                const texString = el.textContent\r\n                try {\r\n                    katex.render(texString, el, katexOptions)\r\n                } catch(e) {\r\n                    if (e instanceof katex.ParseError) {\r\n                        // KaTeX can't parse the expression\r\n                        el.innerHTML = (\"Error in LaTeX '\" + texString + \"': \" + e.message)\r\n                            .replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\r\n                    } else {\r\n                        // other error\r\n                        throw e\r\n                    }\r\n                }\r\n            })\r\n    }\r\n\r\n    if (!globalThis.__ContainsFormula__) {\r\n        // no formula\r\n        return\r\n    }\r\n    if (katex) {\r\n        renderFormula()\r\n        return\r\n    }\r\n\r\n    // dynamically import katex style and script \r\n    importStyle(\"./dist/libs/katex/katex.min.css\")\r\n    try {\r\n        const katexModule = await import(\"../libs/katex/katex.min.js\")\r\n        katex = katexModule.default\r\n        renderFormula()\r\n    } catch(e) {\r\n        console.error(e)\r\n    }\r\n}","function propSetter(el, props) {\r\n    if (!props) {\r\n        return\r\n    }\r\n    for (const [key, val] of Object.entries(props)) {\r\n        if (val === undefined) {\r\n            continue\r\n        }\r\n        if (val instanceof Function) {\r\n            el[key] = val\r\n        } else {\r\n            el.setAttribute(key, val)\r\n        }\r\n    }\r\n}\r\n\r\nfunction propToString(props) {\r\n    // input: {prop: \"value\"}\r\n    // output: \"prop='value'\"\r\n    const htmlValueFormater = val => val.toString().replaceAll(\"\\\"\", \"&quot;\") \r\n    const resultPropStr = Object.entries(props)\r\n        .filter(([_, val]) => val != undefined)\r\n        .map(([key, val]) => `${key}=\"${htmlValueFormater(val)}\"`)\r\n        .join(\" \")\r\n    return resultPropStr\r\n}\r\n\r\nfunction contentSetter(el, content) {\r\n    if (content instanceof Array) {\r\n        // array of html element\r\n        for (const childEl of content) {\r\n            el.appendChild(childEl)\r\n        }\r\n    } else if (content instanceof HTMLElement) {\r\n        // single element\r\n        el.appendChild(content)\r\n    } else if (typeof content === \"string\") {\r\n        // common text\r\n        el.textContent = content\r\n    } else {\r\n        throw Error(\"Unexpected element content: \" + content)\r\n    }\r\n}\r\n\r\nexport default function el(tagName, content=\"\", props=null) {\r\n    if (\"document\" in globalThis) {\r\n        // in browser\r\n        if (tagName === \"text\") {\r\n            return document.createTextNode(content)\r\n        }\r\n\r\n        const targetEl = document.createElement(tagName)\r\n        propSetter(targetEl, props)\r\n        contentSetter(targetEl, content)\r\n        return targetEl\r\n    } else {\r\n        // in node.js\r\n        if (content instanceof Array) {\r\n            content = content.join(\"\")\r\n        }\r\n        switch (tagName) {\r\n            case \"text\":\r\n                return content\r\n            case \"hr\":\r\n            case \"br\":\r\n                return `<${tagName}>`\r\n            case \"img\":\r\n            case \"input\":\r\n                return `<${tagName} ${props ? propToString(props) : \"\"}>`\r\n        }\r\n        return `<${tagName}${props ? \" \" + propToString(props) : \"\"}>${content}</${tagName}>`\r\n    }\r\n}\r\n","// (\"abc]\", \"]\") -> \"abc\"\r\nexport default function getInterval(text, endSign) {\r\n    if (!text.includes(endSign)) {\r\n        return null\r\n    }\r\n\r\n    let intervalText = \"\"\r\n    let isEscape = false\r\n\r\n    while (text.length) {\r\n        const ch = text.slice(0, 1)\r\n        text = text.substr(1)\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n        if (ch === endSign && !isEscape) {\r\n            break\r\n        }\r\n        intervalText += ch\r\n        isEscape = false\r\n    }\r\n\r\n    return intervalText\r\n}\r\n","import el from \"../el.js\"\r\nimport htmlEntityReplace from \"../htmlEntityReplace.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\n\r\n// identifier character to HTML tag\r\nconst KeyToken_TagName_map = new Map([\r\n    [\"#\", \"strong\"],\r\n    [\"`\", \"code\"],\r\n    [\"_\", \"u\"],\r\n    [\"/\", \"i\"],\r\n    [\"-\", \"del\"],\r\n    [\":\", \"span.dim\"],\r\n    [\",\", \"sub\"],\r\n    [\"'\", \"sup\"],\r\n    [\"$\", \"span.math\"],\r\n])\r\n\r\nconst PairedParenMap = new Map([\r\n    [\"[\", \"]\"],\r\n    [\"{\", \"}\"],\r\n])\r\n\r\n// --- --- --- --- --- ---\r\n\r\nclass TextToken {\r\n    constructor(content) {\r\n        this.content = content\r\n    }\r\n    toHTML = () => el(\"text\", this.content)\r\n}\r\nclass KeyToken {\r\n    constructor(tagSign, content) {\r\n        const tag = KeyToken_TagName_map.get(tagSign)\r\n        if (tag.includes(\".\")) {\r\n            const [realTagName, className] = tag.split(\".\")\r\n            this.tagName = realTagName\r\n            this.className = className\r\n        } else {\r\n            this.tagName = tag\r\n        }\r\n        this.content = content\r\n\r\n        if (this.className === \"math\") {\r\n            // set this global variable to import\r\n            // the math formula renderer module\r\n            globalThis.__ContainsFormula__ = true\r\n        }\r\n    }\r\n\r\n    toHTML() {\r\n        const elOption = this.className === undefined ? null : {\"class\": this.className}\r\n        const thisEl = el(this.tagName, parseEntry(this.content), elOption)\r\n        return thisEl\r\n    }\r\n}\r\n\r\nclass LinkToken {\r\n    constructor(content, address) {\r\n        this.content = content\r\n        this.address = address\r\n    }\r\n\r\n    toHTML() {\r\n        const displayContent = parseEntry(this.content)\r\n        if (this.address.startsWith(\"http\")) {\r\n            // internet links\r\n            return el(\"a\", displayContent, {\r\n                href: this.address,\r\n                target: \"_blank\"\r\n            })\r\n        }\r\n\r\n        // static resources or links\r\n        const actualAddress = \"static/\" + this.address\r\n        return el(\"a\", displayContent, {\r\n            href: \"#\" + actualAddress\r\n        })\r\n    }\r\n}\r\nclass PhoneticToken {\r\n    constructor(content, notation) {\r\n        this.content  = content\r\n        this.notation = notation\r\n    }\r\n    toHTML() {\r\n        const ignoredLeftParenthesis = el(\"rp\", \"(\")\r\n        const ignoredRightParenthesis = el(\"rp\", \")\")\r\n        const notationEl = el(\"rt\", this.notation)\r\n\r\n        const content = parseEntry(this.content).concat([\r\n            ignoredLeftParenthesis,\r\n            notationEl,\r\n            ignoredRightParenthesis,\r\n        ])\r\n        return el(\"ruby\", content, {\r\n            \"data-notation\": this.notation\r\n        })\r\n    }\r\n}\r\n\r\n// --- --- --- --- --- ---\r\n\r\nfunction parser(source) {\r\n    function getFirstChar() {\r\n        const ch = source.charAt(0)\r\n        source = source.substring(1)\r\n        return ch\r\n    }\r\n    function getSpecialTokenClass(tokenSign) {\r\n        let targetTokenType\r\n        if (tokenSign === \"[\") {\r\n            targetTokenType = LinkToken\r\n        } else if (tokenSign === \"{\") {\r\n            targetTokenType = PhoneticToken\r\n        } else { /* unreachable */ }\r\n        return targetTokenType\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    const tokens = []\r\n    let textTerm = \"\" // text\r\n    let keyTerm  = \"\" // inline style content\r\n    let keyStart = \"\"\r\n    let isEscape = false\r\n    let isInKey  = false\r\n\r\n    while (source.length) {\r\n        const ch = getFirstChar()\r\n\r\n        // key rules resolve\r\n        if (KeyToken_TagName_map.has(ch)) {\r\n            if (isEscape) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                continue\r\n            }\r\n\r\n            if (isInKey && ch != keyStart) {\r\n                keyTerm += ch\r\n                continue\r\n            }\r\n\r\n            const nextCh = getFirstChar()\r\n            if (nextCh != ch) {\r\n                if (isInKey) {\r\n                    keyTerm += ch\r\n                } else {\r\n                    textTerm += ch\r\n                }\r\n                source = nextCh + source\r\n                continue\r\n            }\r\n\r\n            if (isInKey) {\r\n                tokens.push(new KeyToken(ch, keyTerm))\r\n                keyTerm  = \"\"\r\n                keyStart = \"\"\r\n            } else {\r\n                tokens.push(new TextToken(textTerm))\r\n                textTerm = \"\"\r\n                keyStart = ch\r\n            }\r\n            isInKey = !isInKey\r\n            continue\r\n        }\r\n\r\n        // special inline rules resolve\r\n        if ([\"[\", \"{\"].includes(ch) && !isInKey && !isEscape) {\r\n            const specialTokenSign = ch\r\n            const pairedTokenSign = PairedParenMap.get(specialTokenSign)\r\n\r\n            tokens.push(new TextToken(textTerm))\r\n            textTerm = \"\"\r\n\r\n            let removedContent = specialTokenSign\r\n            // the actual displayed content for special inline elements\r\n            const displayContent = getInterval(source, pairedTokenSign)\r\n            if (displayContent != null) {\r\n                removedContent += source.slice(0, displayContent.length + 1)\r\n                source = source.substr(displayContent.length + 1)\r\n\r\n                const nextCh = getFirstChar()\r\n                removedContent += nextCh\r\n                if (nextCh === \"(\") {\r\n                    // the hidden displayed content for special inline elements\r\n                    const hiddenContent = getInterval(source, \")\")\r\n                    if (hiddenContent != null) {\r\n                        let targetTokenType = getSpecialTokenClass(specialTokenSign)\r\n                        source = source.substr(hiddenContent.length + 1)\r\n                        tokens.push(new targetTokenType(displayContent, hiddenContent))\r\n                        continue\r\n                    }\r\n                }\r\n            }\r\n            textTerm += removedContent\r\n            continue\r\n        }\r\n\r\n        // --- --- --- --- --- ---\r\n\r\n        if (ch === \"\\\\\") {\r\n            isEscape = !isEscape\r\n            continue\r\n        }\r\n\r\n        let text\r\n        if (isEscape) {\r\n            text = \"\\\\\" + ch\r\n            isEscape = false\r\n        } else {\r\n            text = ch\r\n        }\r\n\r\n        if (isInKey) {\r\n            keyTerm += text\r\n        } else {\r\n            textTerm += text\r\n        }\r\n    }\r\n\r\n    if (keyTerm.length) {\r\n        tokens.push(new KeyToken(keyStart, keyTerm))\r\n    }\r\n    if (textTerm.length) {\r\n        tokens.push(new TextToken(textTerm))\r\n    }\r\n    return tokens\r\n}\r\n\r\nexport default function parseEntry(source) {\r\n    const tokens = parser(source)\r\n    let resultHTML = tokens\r\n        .filter(token =>\r\n            // remove empty TextToken\r\n            !(token instanceof TextToken && !token.content.length))\r\n        .map(token => token.toHTML())\r\n\r\n    if (typeof window !== \"object\" && source === resultHTML[0]) {\r\n        // for server rendering\r\n        return htmlEntityReplace(source)\r\n    }\r\n    return resultHTML\r\n}\r\n\r\n// test cases\r\n// console.log(parseEntry(\"##bo//itelic//ld##\"))\r\n// console.log(parseEntry(\"##bo[link text](http://www.com)ld##\"))\r\n// console.log(parseEntry(\"::dim[link text](http://www.com)med::\"))\r\n// console.log(parseEntry(\"//ita[link text](http:\\\\/\\\\/www.com)lic//\"))\r\n// console.log(parseEntry(\"``<test>``\"))\r\n// console.log(parseEntry(\"asd[asd\"))\r\n// console.log(parseEntry(\"asd[asd]asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd\"))\r\n// console.log(parseEntry(\"asd[asd](asd)\"))\r\n// console.log(parseEntry(\"asd[##link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link##](asd)\"))\r\n// console.log(parseEntry(\"##asd[link](asd)##\"))\r\n// console.log(parseEntry(\"::dimmed::\"))\r\n// console.log(parseEntry(\"$$f_c = \\\\frac{1}{abc}$$\"))\r\n","export default source => source\r\n    .replaceAll(\"<\", \"&lt;\")\r\n    .replaceAll(\">\", \"&gt;\")\r\n","import config from \"../../build.config.js\"\r\n\r\nconst currentLang = config.language\r\nconst langList = [\"zh\", \"en\"]\r\nfunction languageSelectorCreator(lang) {\r\n    for (const [index, langName] of Object.entries(langList)) {\r\n        if (lang === langName) {\r\n            return (...selections) => selections[index]\r\n        }\r\n    }\r\n    console.warn(\"Unexpected language: \" + lang)\r\n    // default returns English text\r\n    return (...selections) => selections[1]\r\n}\r\nconst languageSelector = languageSelectorCreator(currentLang)\r\nexport default languageSelector\r\n","import mdResolver from \"./index.js\"\r\nimport inlineResolver from \"./inline.js\"\r\nimport getInterval from \"./utils/getInterval.js\"\r\nimport el from \"../el.js\"\r\nimport languageSelector from \"../languageSelector.js\"\r\n\r\nexport class Headline {\r\n    constructor(content) {\r\n        // \"### test\" -> \"###\"\r\n        const splited = content.split(\" \")\r\n        const numberSignStr = splited[0]\r\n        let numberSignCount = 0\r\n        for (const ch of numberSignStr) {\r\n            if (ch === '#') {\r\n                numberSignCount += 1\r\n            }\r\n        }\r\n\r\n        if (numberSignCount > 6) {\r\n            numberSignCount = 0\r\n        }\r\n\r\n        const rawContent = splited.slice(1).join(\" \")\r\n        this.tagName = \"h\" + numberSignCount\r\n        this.content = inlineResolver(rawContent)\r\n    }\r\n    toHTML() {\r\n        const options = this.id === undefined\r\n            ? null\r\n            : { id: this.id }\r\n        return el(this.tagName, this.content, options)\r\n    }\r\n\r\n    static pattern = source => source.match(/^(#+ )/)\r\n}\r\n\r\nexport class Para {\r\n    tagName = \"p\"\r\n\r\n    constructor(content) {\r\n        this.content = content.trimStart()\r\n    }\r\n    toHTML() {\r\n        const inline = inlineResolver(this.content)\r\n        return el(this.tagName, inline)\r\n    }\r\n}\r\n\r\nexport class Quote {\r\n    tagName = \"blockquote\"\r\n    children = []\r\n\r\n    constructor(children) {\r\n        this.children = children\r\n    }\r\n    toHTML() {\r\n        const innerNodes = this.children\r\n            .map(node => node.toHTML())\r\n        return el(this.tagName, innerNodes)\r\n    }\r\n\r\n    static pattern = source =>\r\n        (source === \">\") || source.startsWith(\"> \")\r\n}\r\n\r\nexport class Divider {\r\n    toHTML = () => el(\"hr\")\r\n    static pattern = source =>\r\n        source.match(/(-\\s*-\\s*-)|(\\*\\s*\\*\\s*\\*)/) && !source.match(/[a-zA-Z0-9]/)\r\n}\r\n\r\nexport class List {\r\n    children = []\r\n\r\n    constructor(content) {\r\n        this.isOrdered = Boolean(List.orderedPattern(content))\r\n        this.tagName   = (this.isOrdered) ? \"ol\" : \"ul\"\r\n        this.children  = [List.getContent(content, this.isOrdered)]\r\n    }\r\n\r\n    push = child => this.children.push(child)\r\n\r\n    toHTML() {\r\n        const childrenHTML = []\r\n        for (const child of this.children) {\r\n            if (typeof child === \"string\") {\r\n                const inline = inlineResolver(child)\r\n                childrenHTML.push(el(\"li\", inline))\r\n            } else {\r\n                childrenHTML.push(child.toHTML())\r\n            }\r\n        }\r\n        return el(this.tagName, childrenHTML)\r\n    }\r\n\r\n    static unorderedPattern = (source) => Boolean(source.match(/^([\\s\\t]*[+-]+ )/))\r\n    static orderedPattern = (source) => Boolean(source.match(/^([\\s\\t]*[0-9]+. )/))\r\n\r\n    static isListPattern = (source) =>\r\n        List.orderedPattern(source) || List.unorderedPattern(source)\r\n\r\n    static getContent(line, isOrdered) {\r\n        if (isOrdered) {\r\n            // \"1. ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[0-9]+. )).+$/g)[0]\r\n        } else {\r\n            // \"- ...\" => \"...\"\r\n            return line.match(/(?<=^([\\s\\t]*[+-]+ )).+$/g)[0]\r\n        }\r\n    }\r\n}\r\n\r\nexport class Table {\r\n    headerCells = [\"\"]   // [string]\r\n    bodyRows    = [[\"\"]] // [[string]]\r\n\r\n    constructor(headerCells, bodyRows) {\r\n        this.headerCells = headerCells\r\n        this.bodyRows    = bodyRows\r\n    }\r\n\r\n    #tableHeaderCell = content => el(\"th\", content)\r\n    #tableBodyCell   = content => el(\"td\", inlineResolver(content))\r\n    #tableHeaderRow  = row => el(\"tr\", row.map(this.#tableHeaderCell))\r\n    #tableBodyRow    = row => el(\"tr\", row.map(this.#tableBodyCell))\r\n\r\n    toHTML() {\r\n        const tableHeader = el(\r\n            \"thead\",\r\n            this.#tableHeaderRow(this.headerCells)\r\n        )\r\n        const tableBody = el(\r\n            \"tbody\",\r\n            this.bodyRows\r\n                .map(this.#tableBodyRow)\r\n        )\r\n        return el(\"div\", el(\"table\", [tableHeader, tableBody]), {\r\n            \"class\": \"table\"\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"| \")\r\n}\r\n\r\n// --- --- --- --- -\r\n// media nodes start\r\n// --- --- --- --- -\r\n\r\nclass MediaNode {\r\n    source = \"\"\r\n    description = \"\"    \r\n    constructor(mdText) {\r\n        mdText = mdText.substr(2)\r\n        this.description = getInterval(mdText, \"]\")\r\n        mdText = mdText.substr(this.description.length + 2)\r\n        this.source = getInterval(mdText, \")\")\r\n    }\r\n\r\n    static containerGenerator(content) {\r\n        return el(\"div\", content, {\r\n            \"class\": \"media-container\"\r\n        })\r\n    }\r\n\r\n    static patternGenerator(identifierSign) {\r\n        return (source) =>\r\n            source.startsWith(identifierSign + \"[\") && source.endsWith(\")\")\r\n    }\r\n\r\n    static replaceContentGenerator(href, description) {\r\n        const downloadEl = el(\"a\", languageSelector(\"从这里下载！\", \"Download Here!\"), { href })\r\n        const replaceContent = `${description}<br>${downloadEl}`\r\n        return replaceContent\r\n    }\r\n\r\n    static srcUrlResolver(rawUrl) {\r\n        let actualUrl\r\n        if (rawUrl.startsWith(\"http\")) {\r\n            actualUrl = rawUrl\r\n        } else {\r\n            if (\"location\" in globalThis) {\r\n                // in browser\r\n                const hash = location.hash.slice(1)\r\n                // get the parent directory path\r\n                const currentPath = hash.split(\"/\").slice(0, -1).join(\"/\")\r\n                actualUrl = currentPath + \"/\" + rawUrl\r\n            } else {\r\n                // in nodejs\r\n                const path = globalThis.__ResourcePath__\r\n                actualUrl = path + \"/\" + rawUrl\r\n            }\r\n        }\r\n        return actualUrl\r\n    }\r\n}\r\n\r\nexport class Image extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"!\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const imageEl = el(\"img\", \"\", {\r\n            src: actualUrl,\r\n            alt: this.description,\r\n            loading: \"lazy\",\r\n            tabindex: 0,\r\n        })\r\n        if (typeof window === \"object\") {\r\n            // in browser\r\n            imageEl.onclick = e =>\r\n                window.open(e.target.src)\r\n            imageEl.onerror = e => {\r\n                const target = e.target\r\n                target.onclick = null\r\n                target.title = this.description\r\n                target.classList.add(\"load-error\")\r\n            }\r\n        }\r\n        return MediaNode.containerGenerator(imageEl)\r\n    }\r\n}\r\n\r\nexport class Audio extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\":\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const audioEl = el(\"audio\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: true,\r\n        })\r\n        return MediaNode.containerGenerator(audioEl)\r\n    }\r\n}\r\n\r\nexport class Video extends MediaNode {\r\n    static pattern = MediaNode.patternGenerator(\"?\")\r\n\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const replaceContent = MediaNode.replaceContentGenerator(actualUrl, this.description)\r\n        const videoEl = el(\"video\", replaceContent, {\r\n            src: actualUrl,\r\n            controls: \"true\",\r\n        })\r\n        return MediaNode.containerGenerator(videoEl)\r\n    }\r\n}\r\n\r\nexport const isIframePattern = (source) =>\r\n    MediaNode.patternGenerator(\"@\")(source)\r\n    || source.startsWith(\"@@@\")\r\n\r\nexport class Iframe extends MediaNode {\r\n    toHTML() {\r\n        const actualUrl = MediaNode.srcUrlResolver(this.source)\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            src: actualUrl,\r\n            title: this.description,\r\n            sandbox: \"allow-scripts\",\r\n            loading: \"lazy\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// media nodes end\r\n// --- --- --- ---\r\n\r\n// --- --- --- --- -\r\n// block nodes start\r\n// --- --- --- --- -\r\n\r\nexport class CodeBlock {\r\n    constructor(content, lang) {\r\n        this.lang = lang\r\n        if (typeof window === \"object\") {\r\n            // in browser\r\n            this.content = content\r\n        } else {\r\n            // in node.js\r\n            this.content = content\r\n                .replaceAll(\"<\", \"&lt;\")\r\n                .replaceAll(\">\", \"&gt;\")\r\n        }\r\n    }\r\n    append(content) {\r\n        this.content += content\r\n    }\r\n    toHTML() {\r\n        const isPlaintext = [\"plaintext\", \"text\", \"\"].includes(this.lang)\r\n        if (typeof window === \"object\" && !isPlaintext) {\r\n            globalThis.__LanguageList__.add(this.lang)\r\n        }\r\n        \r\n        let langName\r\n        let langClass\r\n        if (isPlaintext) {\r\n            langClass = \"nohighlight\"\r\n            langName  = \"PLAINTEXT\"\r\n        } else {\r\n            langClass = `language-${this.lang}`\r\n            langName  = this.lang.toUpperCase()\r\n        }\r\n\r\n        const codeEl = el(\"code\", this.content, {\r\n            \"class\": langClass,\r\n            tabindex: 0\r\n        })\r\n        return el(\"pre\", codeEl, {\r\n            \"data-language\": langName\r\n        })\r\n    }\r\n\r\n    static pattern = source => source.startsWith(\"```\")\r\n}\r\n\r\nexport class DetailsBlock {\r\n    summary = \"\"\r\n    content = \"\"\r\n\r\n    constructor(content, summary) {   \r\n        this.summary = summary\r\n        this.content = mdResolver(content)\r\n    }\r\n    toHTML() {\r\n        const summaryEl = el(\"summary\", this.summary)\r\n        const detailsEl = el(\"details\", summaryEl)\r\n\r\n        const innerNodes = this.content\r\n            .map(node => node.toHTML())\r\n        const childrenEl = el(\"div\", el(\"div\", innerNodes, {\r\n            \"class\": \"details-children\"\r\n        }), {\r\n            \"class\": \"details-children-container\"\r\n        })\r\n        return el(\"div\", [detailsEl, childrenEl], {\r\n            \"class\": \"details\"\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\">>>\")\r\n}\r\n\r\nexport class FormulaBlock {\r\n    content = \"\"\r\n    description = \"\"\r\n\r\n    constructor(content, description) {\r\n        this.content = content\r\n        this.description = description\r\n    }\r\n    toHTML() {\r\n        globalThis.__ContainsFormula__ = true\r\n        return el(\"div\", this.content, {\r\n            \"class\": \"math\",\r\n            title: this.description,\r\n        })\r\n    }\r\n\r\n    static pattern = source =>\r\n        source.startsWith(\"$$$\")\r\n}\r\n\r\nexport class IframeBlock {\r\n    // injected html codes, used to auto darkmode and send height message\r\n    static #injectedCodes = id => `\\\r\n<style>\r\n@media (prefers-color-scheme: dark) {\r\n  :root {\r\n    color: white;\r\n    background-color: #121212;\r\n  }\r\n}\r\n</style>\r\n<script>\r\nconst rootEl = document.documentElement\r\nfunction postHeight() {\r\n    const parent = window.parent\r\n    const height = parseFloat(getComputedStyle(rootEl).height)\r\n    parent.postMessage({\r\n        height,\r\n        id: \"${id}\"\r\n    }, \"*\")\r\n}\r\nwindow.addEventListener(\"load\", postHeight)\r\nwindow.addEventListener(\"message\", e => {\r\n  const { fontSize } = e.data\r\n  rootEl.style.fontSize = fontSize\r\n  postHeight()\r\n})\r\n</script>`\r\n\r\n    constructor(content, description) {\r\n        globalThis.__IframeCounter__ += 1\r\n        this.id = \"iframe_\" + globalThis.__IframeCounter__\r\n        this.description = description\r\n\r\n        if (typeof window === \"object\") {\r\n            // in browser\r\n            this.content = content + IframeBlock.#injectedCodes(this.id)\r\n        } else {\r\n            // in node.js\r\n            this.content = content\r\n        }\r\n    }\r\n\r\n    toHTML() {\r\n        const iframeEl = el(\"iframe\", this.description, {\r\n            id: this.id,\r\n            title: this.description,\r\n            srcdoc: this.content,\r\n            sandbox: \"allow-scripts\",\r\n        })\r\n        return MediaNode.containerGenerator(iframeEl)\r\n    }\r\n}\r\n\r\n// --- --- --- ---\r\n// block nodes end\r\n// --- --- --- ---\r\n","export default function(line) {\r\n    let indentCount = 0\r\n    let spaceCount = 0\r\n\r\n    for (const ch of line) {\r\n        if (ch.match(/[^\\s\\t]/)) {\r\n            break\r\n        }\r\n\r\n        if (ch === \"\\t\") {\r\n            indentCount += 1\r\n            continue\r\n        }\r\n        if (ch === \" \") {\r\n            spaceCount += 1\r\n        }\r\n        if (spaceCount === 2) {\r\n            spaceCount = 0\r\n            indentCount += 1\r\n        }\r\n    }\r\n    return indentCount\r\n}\r\n","import { List } from \"../node.js\"\r\nimport getIndent from \"../utils/getIndent.js\"\r\n\r\nexport default function listResolver(currentLine, lines) {\r\n    const currentIndent = getIndent(currentLine)\r\n    const currentNode = new List(currentLine)\r\n\r\n    while (lines.length && List.isListPattern(lines[0])) {\r\n        const nextLine = lines.shift()\r\n        const nextIndent = getIndent(nextLine)\r\n        const isNextOrdered = List.orderedPattern(nextLine)\r\n\r\n        if (nextIndent > currentIndent) {\r\n            currentNode.push(listResolver(nextLine, lines))\r\n        } else if (nextIndent === currentIndent && isNextOrdered === currentNode.isOrdered) {\r\n            currentNode.push(List.getContent(nextLine, isNextOrdered))\r\n        } else {\r\n            lines.unshift(nextLine)\r\n            break\r\n        }\r\n    }\r\n    return currentNode\r\n}","import mdResolver from \"../index.js\"\r\nimport { Quote } from \"../node.js\"\r\n\r\nexport default function(firstLine, lines) {\r\n    let quotedContent = firstLine.slice(2) + \"\\n\"\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Quote.pattern(l)) {\r\n            quotedContent += l.slice(2) + \"\\n\"\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n    const children = mdResolver(quotedContent)\r\n    const node = new Quote(children)\r\n    return node\r\n}\r\n","import { Table } from \"../node.js\"\r\n\r\n// input: \"| content | content |\"\"\r\n// output: [\"content\",\"content\"]\r\nfunction tableLineConverter(tableLine) {\r\n    const splited = tableLine.split(\"|\")\r\n    const result = splited\r\n        .filter(item => item.length > 0)\r\n        .map(item => item.trim())\r\n    return result\r\n}\r\n\r\nexport default function(firstLine, lines) {\r\n    const headerText = firstLine\r\n    const contentLines = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (Table.pattern(l)) {\r\n            contentLines.push(l)\r\n        } else {\r\n            lines.unshift(l)\r\n            break\r\n        }\r\n    }\r\n\r\n    const headerCells = tableLineConverter(headerText)\r\n    const contentRows = contentLines.map(tableLineConverter)\r\n    const tableNode = new Table(headerCells, contentRows)\r\n    return tableNode\r\n}\r\n","import { CodeBlock, DetailsBlock, FormulaBlock, Iframe, IframeBlock } from \"../node.js\"\r\n\r\nfunction blockResolverGenerator(endSign, targetClass) {\r\n    return function(firstLine, lines) {\r\n        const description = firstLine.slice(3)\r\n\r\n        let content = \"\"\r\n        while (lines.length) {\r\n            const l = lines.shift()\r\n\r\n            if (l === endSign) {\r\n                break\r\n            }\r\n\r\n            content += l + \"\\n\"\r\n        }\r\n        return new targetClass(content, description)\r\n    }\r\n}\r\n\r\nexport const codeResolver = blockResolverGenerator(\"```\", CodeBlock)\r\nexport const detailsResolver = blockResolverGenerator(\">>>\", DetailsBlock)\r\nexport const formulaResolver = blockResolverGenerator(\"$$$\", FormulaBlock)\r\nexport function iframeResolver(firstLine, lines) {\r\n    const blockResolver = blockResolverGenerator(\"@@@\", IframeBlock)\r\n\r\n    if (!firstLine.startsWith(\"@@@\")) {\r\n        // link to out resource\r\n        return new Iframe(firstLine)\r\n    }\r\n    return blockResolver(firstLine, lines)\r\n}\r\n","import {\r\n    Headline, Quote, Divider,\r\n    List, Para, Table,\r\n    Image, Audio, Video,\r\n    FormulaBlock, CodeBlock,\r\n    isIframePattern,\r\n    DetailsBlock\r\n} from \"./node.js\"\r\nimport {\r\n    listResolver, quoteResolver, tableResolver,\r\n    codeResolver, formulaResolver, iframeResolver, detailsResolver,\r\n} from \"./resolvers/index.js\"\r\nimport getLines from \"./utils/getLines.js\"\r\n\r\nexport default function mdResolver(source) {\r\n    const lines = getLines(source)\r\n    const nodes = []\r\n\r\n    while (lines.length) {\r\n        const l = lines.shift()\r\n\r\n        if (!l.length) {\r\n            // skip empty line\r\n            continue\r\n        }\r\n\r\n        if (Headline.pattern(l)) {\r\n            nodes.push(new Headline(l))\r\n        } else\r\n        if (Divider.pattern(l)) {\r\n            nodes.push(new Divider)\r\n        } else\r\n        if (Quote.pattern(l)) {\r\n            nodes.push(quoteResolver(l, lines))\r\n        } else\r\n        if (List.isListPattern(l)) {\r\n            nodes.push(listResolver(l, lines))\r\n        } else\r\n        if (Table.pattern(l)) {\r\n            nodes.push(tableResolver(l, lines))\r\n        } else\r\n        if (Image.pattern(l)) {\r\n            nodes.push(new Image(l))\r\n        } else\r\n        if (Audio.pattern(l)) {\r\n            nodes.push(new Audio(l))\r\n        } else\r\n        if (Video.pattern(l)) {\r\n            nodes.push(new Video(l))\r\n        } else\r\n        if (DetailsBlock.pattern(l)) {\r\n            nodes.push(detailsResolver(l, lines))\r\n        } else\r\n        if (FormulaBlock.pattern(l)) {\r\n            nodes.push(formulaResolver(l, lines))\r\n        } else\r\n        if (CodeBlock.pattern(l)) {\r\n            nodes.push(codeResolver(l, lines))\r\n        } else\r\n        if (isIframePattern(l)) {\r\n            nodes.push(iframeResolver(l, lines))\r\n        } else {\r\n            nodes.push(new Para(l))\r\n        }\r\n    }\r\n    return nodes\r\n}","export default function(source) {\r\n    if (source.indexOf(\"\\r\") != -1) {\r\n        return source.split(\"\\r\\n\")\r\n    } else {\r\n        return source.split(\"\\n\")\r\n    }\r\n}","export default function(el) {\r\n    return function(e) {\r\n        // when Enter key or Space key\r\n        if (e.key === \"Enter\" || e.key === \" \") {\r\n            el.click()\r\n        }\r\n    }\r\n}\r\n","// return to the document top\r\nexport default function() {\r\n    document.body.scrollTop = 0\r\n    document.documentElement.scrollTop = 0\r\n}\r\n","import EventBus from \"./index.js\"\r\nconst eventbus = new EventBus()\r\nexport default eventbus\r\n","export default class EventBus {\r\n    // A map used to store events and handlers for events\r\n    events = new Map()\r\n\r\n    /**\r\n     * @name emit\r\n     * @description to trigger the handlers for the given event name\r\n     * @param { String | Symbol } name event name\r\n     * @param { Array<any> }      args use `...` to support multi-arg\r\n     */\r\n    emit(name, ...args) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            targetEvent.forEach((handler) => {\r\n                handler.apply(null, args)\r\n            })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @name on\r\n     * @description to add event listener & register the given event handler\r\n     * @param { String | Symbol } name event name\r\n     * @param { EventHandler } handler given handler to given event\r\n     */\r\n    on(name, handler) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            targetEvent.push(handler)\r\n        } else {\r\n            this.events.set(name, [handler])\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @name off\r\n     * @description remove the given handler to the given event\r\n     * @param { String | Symbol } name event name\r\n     * @param { EventHandler } handler given handler to given event\r\n     */\r\n    off(name, handler) {\r\n        const targetEvent = this.events.get(name)\r\n\r\n        if (targetEvent) {\r\n            if (targetEvent.length === 1) {\r\n                this.events.delete(name)\r\n            } else {\r\n                const handlerIndex = targetEvent.indexOf(handler)\r\n                targetEvent.splice(handlerIndex, 1)\r\n            }\r\n        }\r\n    }\r\n}","import { importHighlighter, importTexRenderer } from \"./importer.js\"\r\nimport mdResolver from \"../utils/markdown/index.js\"\r\nimport keydownEvent from \"../utils/keydownEvent.js\"\r\nimport backToTop from \"../utils/backToTop.js\"\r\nimport eventbus from \"../utils/eventbus/inst.js\"\r\nimport config from \"../../build.config.js\"\r\nimport { Headline } from \"../utils/markdown/node.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\n\r\nconst articleEl = document.querySelector(\"article\")\r\nconst emptyArticlePlaceHolder = languageSelector(\"空文章\", \"Empty Article\")\r\n\r\neventbus.on(\"catalog-toggle\", () => {\r\n    articleEl.classList.toggle(\"with-catalog\")\r\n})\r\neventbus.on(\"catalog-closed\", () => {\r\n    articleEl.classList.remove(\"with-catalog\")\r\n})\r\n\r\nfunction getHeadlines(structure) {\r\n    return structure\r\n        .filter(node => node instanceof Headline)\r\n        .map((node, index) => {\r\n            const id = node.id = \"headline-\" + index\r\n            const content = node.content.map(el => el.cloneNode(true))\r\n            return {\r\n                id, content,\r\n                level: node.tagName,\r\n            }\r\n        })\r\n}\r\n\r\nexport default function articleRender(articleEl, mdText) {\r\n    // language names to import\r\n    globalThis.__LanguageList__ = new Set()\r\n    // to deside whether to import `katex`\r\n    globalThis.__ContainsFormula__ = false\r\n    // used to dynamic generate iframe id\r\n    globalThis.__IframeCounter__ = 0\r\n\r\n    const structure = mdResolver(mdText)\r\n    if (config.enableCatalog) {\r\n        const headlineItems = getHeadlines(structure)\r\n        eventbus.emit(\"article-rendered\", headlineItems)\r\n    }\r\n\r\n    let resultNodes = structure.map(node => node.toHTML())\r\n    if (!resultNodes.length) {\r\n        resultNodes = el(\"h1\", emptyArticlePlaceHolder)\r\n    }\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    articleEl.innerHTML = \"\"\r\n    resultNodes.forEach(el => articleEl.appendChild(el))\r\n\r\n    articleEl.style.display = \"block\"\r\n    articleEl.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n    backToTop()\r\n\r\n    importHighlighter().then(() => globalThis.__LanguageList__ = null)\r\n    importTexRenderer().then(() => globalThis.__ContainsFormula__ = false)\r\n}\r\n","import articleRender from \"./articleRenderer.js\"\r\nimport el from \"../utils/el.js\"\r\nimport keydownEvent from \"../utils/keydownEvent.js\"\r\n\r\nexport function newestItemRenderer(item) {\r\n    const createDate = new Date(item.timestamp)\r\n    const formatedDate = new Intl.DateTimeFormat().format(createDate)\r\n    const dateEl  = el(\"code\", formatedDate)\r\n    const titleEl = el(\"span\", item.title, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    return el(\"li\",\r\n        [dateEl, el(\"text\", \": \"), titleEl],\r\n        {\r\n            tabindex: 0,\r\n            \"class\": \"underline-through\",\r\n            \"data-target-blog\": item.link,\r\n        }\r\n    )\r\n}\r\nexport function directoryItemRenderer(item) {\r\n    const contentEl = el(\"span\", item, {\r\n        \"class\": \"underline-target\"\r\n    })\r\n    return el(\"li\", contentEl, {\r\n        \"class\": \"underline-through\",\r\n        tabindex: 0,\r\n    })\r\n}\r\n\r\nconst mainEl           = document.querySelector(\"main\")\r\nconst articleEl        = document.querySelector(\"article\")\r\nconst articleList      = mainEl.querySelector(\"#article-list\")\r\nconst dirDescriptionEl = mainEl.querySelector(\"#directory-description\")\r\nconst pagingComponent  = mainEl.querySelector(\"paging-view\")\r\n\r\nexport default function indexRender(indexing, itemResolver) {\r\n    const {current, total} = indexing\r\n    pagingComponent.setPage(current, total)\r\n\r\n    // --- --- --- --- --- ---\r\n    \r\n    // reset directory description\r\n    dirDescriptionEl.innerHTML = \"\"\r\n    if (\"directoryDescription\" in indexing) {\r\n        articleRender(dirDescriptionEl, indexing.directoryDescription)\r\n    }\r\n\r\n    // reset articleList content\r\n    articleList.innerHTML = \"\"\r\n    indexing.content\r\n        .map(itemResolver)\r\n        .forEach(el =>\r\n            articleList.appendChild(el)\r\n        )\r\n\r\n    // set keyboard event\r\n    articleList.querySelectorAll(\"[tabindex='0']\").forEach((el) => {\r\n        el.onkeydown = keydownEvent(el)\r\n    })\r\n\r\n    // --- --- --- --- --- ---\r\n\r\n    articleEl.style.display = \"none\"\r\n    mainEl.style.display = \"block\"\r\n\r\n    // return to the top\r\n    document.body.scrollTop = 0\r\n    document.documentElement.scrollTop = 0\r\n}\r\n","import pageController from \"../components/paging.js\"\r\nimport { fetchJSON, fetchMD } from \"./fetchResources.js\"\r\nimport articleRender from \"./articleRenderer.js\"\r\nimport indexRender, { newestItemRenderer, directoryItemRenderer } from \"./indexRenderer.js\"\r\n\r\nexport async function hashChangeEvent(_) {\r\n    const mainEl = document.querySelector(\"main\")\r\n    const articleEl = document.querySelector(\"article\")\r\n    const indexDirPath = \"./.index/\"\r\n\r\n    if (!location.hash) {\r\n        pathManager.homepage()\r\n        return\r\n    }\r\n    const hash = location.hash.slice(1)\r\n    mainEl.classList.add(\"disabled\")\r\n\r\n    if (pathManager.isIn.newestPage()) {\r\n        // open newest page\r\n        const indexPath = indexDirPath\r\n            + \"newest_\"\r\n            + pageController.current()\r\n        const newestIndex = await fetchJSON(indexPath)\r\n        if (!newestIndex) return\r\n        indexRender(newestIndex, newestItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.directory()) {\r\n        // open directory\r\n        const splited = hash.split(\"/\").slice(0, -1)\r\n        const indexFilePath = indexDirPath\r\n            + splited.join(\"+\") + \"_\"\r\n            + pageController.current()\r\n        const index = await fetchJSON(indexFilePath)\r\n        if (!index) return\r\n        indexRender(index, directoryItemRenderer)\r\n    } else\r\n    if (pathManager.isIn.article()) {\r\n        // open article\r\n        const articleContent = await fetchMD(\"./\" + hash)\r\n        if (!articleContent) return\r\n        mainEl.style.display = \"none\"\r\n        articleRender(articleEl, articleContent)\r\n    } else {\r\n        pathManager.homepage()\r\n    }\r\n\r\n    mainEl.setAttribute(\"data-is-root\", hash === \"static/\")\r\n    mainEl.classList.remove(\"disabled\")\r\n}\r\n\r\nwindow.addEventListener(\"hashchange\", hashChangeEvent)\r\nwindow.addEventListener(\"load\", hashChangeEvent)\r\n\r\nconst homepagePath = \"static/\"\r\nconst newestPath = \"newest/\"\r\nconst pathManager = {\r\n    homepage() {\r\n        location.hash = homepagePath\r\n    },\r\n\r\n    open(name) {\r\n        location.hash += name\r\n    },\r\n    jumpTo(target) {\r\n        location.hash = target\r\n    },\r\n    parent() {\r\n        if (this.isIn.root() || this.isIn.newestPage()) {\r\n            return homepagePath\r\n        }\r\n        const splited = location.hash.slice(1).split(\"/\")\r\n        if (this.isIn.directory()) {\r\n            return splited.slice(0, -2).join(\"/\") + \"/\"\r\n        }\r\n        if (this.isIn.article()) {\r\n            return splited.slice(0, -1).join(\"/\") + \"/\"\r\n        }\r\n        throw new Error(\"Unexpected hash: \" + location.hash)\r\n    },\r\n    isIn: {\r\n        root() {\r\n            return location.hash === \"#\" + homepagePath\r\n        },\r\n        newestPage() {\r\n            return location.hash === \"#\" + newestPath\r\n        },\r\n        directory() {\r\n            return location.hash.startsWith(\"#static\")\r\n                && location.hash.endsWith(\"/\")\r\n        },\r\n        article() {\r\n            return location.hash.startsWith(\"#static\")\r\n                && location.hash.endsWith(\".md\")\r\n        }\r\n    }\r\n}\r\nexport default pathManager\r\n","import { hashChangeEvent } from \"../scripts/pathManager.js\"\r\nimport el from \"../utils/el.js\"\r\nimport languageSelector from \"../utils/languageSelector.js\"\r\n\r\nclass PageController {\r\n    #pageList = [1]\r\n\r\n    current = () => this.#pageList[this.length() - 1]\r\n    next    = () => this.#pageList[this.length() - 1] += 1\r\n    prev    = () => this.#pageList[this.length() - 1] -= 1\r\n    jumpTo  = targetPage => this.#pageList[this.length() - 1] = Number(targetPage)\r\n    length  = () => this.#pageList.length\r\n\r\n    back() {\r\n        // called when \"popstate\" event emited\r\n        this.#pageList.pop()\r\n        if (!this.#pageList.length) {\r\n            this.#pageList.push(1)\r\n        }\r\n    }\r\n    open() {\r\n        // called when enter directory\r\n        this.#pageList.push(1)\r\n    }\r\n}\r\nconst pageController = new PageController()\r\nexport default pageController\r\n\r\n// --- --- --- --- --- ---\r\n\r\nconst btn = content => el(\r\n    \"button\",\r\n    el(\"span\", content), {\r\n    \"class\": \"icon-btn\"\r\n})\r\n\r\nclass PagingView extends HTMLElement {\r\n    #elements = {}\r\n\r\n    constructor() {\r\n        super()\r\n\r\n        this.#elements.input = el(\"input\", \"1\", {\r\n            type: \"number\",\r\n            min: 1,\r\n            max: 1,\r\n        })\r\n        this.#elements.maxPage = el(\"span\", \"1\")\r\n        const prevBtn = this.#elements.prevBtn = btn(languageSelector(\"上一页\", \"Prev\"))\r\n        const nextBtn = this.#elements.nextBtn = btn(languageSelector(\"下一页\", \"Next\"))\r\n        prevBtn.id = \"prev-btn\"\r\n        nextBtn.id = \"next-btn\"\r\n        const labelEl = el(\"label\", [\r\n            this.#elements.input,\r\n            el(\"text\", \"/\"),\r\n            this.#elements.maxPage,\r\n        ])\r\n        this.#appendEvent()\r\n        for (const el of [prevBtn, labelEl, nextBtn]) {\r\n            this.appendChild(el)\r\n        }\r\n    }\r\n    #appendEvent() {\r\n        this.#elements.input.addEventListener(\"keydown\", e => {\r\n            if (e.key !== \"Enter\") {\r\n                return\r\n            }\r\n            const targetPageStr = e.target.value\r\n            if (!/^\\d+$/.test(targetPageStr)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            const targetPage = Number(targetPageStr)\r\n            if (!(targetPage > 0 && targetPage <= this.#elements.input.max)) {\r\n                e.target.value = 1\r\n                return\r\n            }\r\n            pageController.jumpTo(targetPage)\r\n            hashChangeEvent()\r\n        })\r\n        this.#elements.prevBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() > 0) {\r\n                pageController.prev()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n        this.#elements.nextBtn.addEventListener(\"click\", () => {\r\n            if (pageController.current() < this.#elements.input.max) {\r\n                pageController.next()\r\n                hashChangeEvent()\r\n            }\r\n        })\r\n    }\r\n    setPage(current, total) {\r\n        let isFirstPage = false\r\n        let isLastPage  = false\r\n        let isOnlyPage  = false\r\n        if (total === 1) {\r\n            isOnlyPage = true\r\n        } else {\r\n            if (current === 1) {\r\n                isFirstPage = true\r\n            }\r\n            if (current === total) {\r\n                isLastPage = true\r\n            }\r\n        }\r\n        this.#elements.prevBtn.disabled = isOnlyPage || isFirstPage\r\n        this.#elements.nextBtn.disabled = isOnlyPage || isLastPage\r\n        this.#elements.maxPage.textContent = total\r\n        this.#elements.input.value = current\r\n        this.#elements.input.max   = total\r\n        this.classList.toggle(\"hidden\", isOnlyPage)\r\n    }\r\n}\r\ncustomElements.define(\"paging-view\", PagingView)\r\n","import pageController from \"../components/paging.js\"\r\nimport pathManager from \"./pathManager.js\"\r\n\r\nconst mainEl       = document.querySelector(\"main\")\r\nconst parentDirBtn = mainEl.querySelector(\"#previous-dir li\")\r\nconst articleList  = mainEl.querySelector(\"#article-list\")\r\n\r\nparentDirBtn.addEventListener(\"click\", () => {\r\n    pageController.back()\r\n    pathManager.jumpTo(pathManager.parent())\r\n})\r\narticleList.addEventListener(\"click\", e => {\r\n    const target = e.target\r\n\r\n    if (target === articleList) {\r\n        // when click on the `articleList` itself\r\n        // ignore this event.\r\n        return\r\n    }\r\n\r\n    if (!target.getAttribute(\"data-target-blog\")) {\r\n        if (target.innerText.endsWith(\"/\")) {\r\n            // open directory\r\n            pageController.open()\r\n        }\r\n        pathManager.open(target.innerText)\r\n    } else {\r\n        // in `newest` page\r\n        pageController.open()\r\n        pathManager.jumpTo(target.getAttribute(\"data-target-blog\"))\r\n    }\r\n})\r\n","import \"./styles/style.css\"\r\n\r\nimport \"./scripts/mainManager.js\"\r\nimport config from \"../build.config.js\"\r\nimport pageController from \"./components/paging.js\"\r\nimport keydownEvent from \"./utils/keydownEvent.js\"\r\nimport { importComponent } from \"./scripts/importer\"\r\n\r\nif (config.enableFab) {\r\n    importComponent(\"fab\")\r\n}\r\nif (config.enableCatalog) {\r\n    importComponent(\"catalog\")\r\n}\r\n\r\nconst lightBtn = document.querySelector(\"#light-btn\")\r\nconst darkBtn = document.querySelector(\"#dark-btn\")\r\nlightBtn.onkeydown = keydownEvent(lightBtn)\r\ndarkBtn.onkeydown = keydownEvent(darkBtn)\r\n\r\nwindow.addEventListener(\"popstate\", () => {\r\n    if (location.hash.endsWith(\"/\")) {\r\n        // in a directory\r\n        pageController.back()\r\n    }\r\n})\r\nwindow.addEventListener(\"message\", e => {\r\n    if (e.origin != \"null\") {\r\n        return\r\n    }\r\n    const { id, height } = e.data\r\n    const targetIframeEl = document.getElementById(id)\r\n    targetIframeEl.style.height = height + \"px\"\r\n})\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n    // if support service worker, register\r\n    navigator.serviceWorker\r\n        .register(\"./sw.js\")\r\n        .catch(function(error) {\r\n            // registration failed\r\n            console.error(\"Registration failed with \" + error);\r\n        })\r\n}\r\n"],"names":["controller","async","fetchJSON","path","abort","AbortController","fetch","signal","then","json","res","catch","err","console","log","error","config","homepage","title","footer","language","enableFab","fabOrdering","enableCatalog","enableRSS","rssIgnoreDir","enableNewest","newestIgnoreDir","pageCapacity","RSSCapacity","previewPort","katexOptions","importStyle","linkEl","document","createElement","rel","href","head","appendChild","importComponent","name","__variableDynamicImportRuntime0__","hljs","katex","importHighlighter","importLangDefs","languageListArr","Array","from","globalThis","__LanguageList__","langDefImporters","filter","getLanguage","map","lang","__variableDynamicImportRuntime1__","toLowerCase","Promise","all","langDefs","forEach","defModule","index","def","default","registerLanguage","highlightAll","size","import","module","propToString","props","Object","entries","_","val","undefined","key","toString","replaceAll","htmlValueFormater","join","el","tagName","content","createTextNode","targetEl","Function","setAttribute","propSetter","childEl","HTMLElement","Error","textContent","contentSetter","getInterval","text","endSign","includes","intervalText","isEscape","length","ch","slice","substr","KeyToken_TagName_map","Map","PairedParenMap","TextToken","constructor","this","toHTML","KeyToken","tagSign","tag","get","realTagName","className","split","__ContainsFormula__","elOption","class","parseEntry","LinkToken","address","displayContent","startsWith","target","PhoneticToken","notation","ignoredLeftParenthesis","ignoredRightParenthesis","notationEl","concat","source","tokens","getFirstChar","charAt","substring","getSpecialTokenClass","tokenSign","targetTokenType","textTerm","keyTerm","keyStart","isInKey","has","nextCh","push","specialTokenSign","pairedTokenSign","removedContent","hiddenContent","parser","resultHTML","token","window","htmlEntityReplace","langList","languageSelector","langName","selections","warn","languageSelectorCreator","Headline","splited","numberSignStr","numberSignCount","rawContent","inlineResolver","options","id","static","match","Para","trimStart","inline","Quote","children","innerNodes","node","Divider","List","isOrdered","Boolean","orderedPattern","getContent","child","childrenHTML","unorderedPattern","line","Table","headerCells","bodyRows","tableHeaderCell","tableBodyCell","tableHeaderRow","row","tableBodyRow","tableHeader","tableBody","MediaNode","description","mdText","containerGenerator","patternGenerator","identifierSign","endsWith","replaceContentGenerator","srcUrlResolver","rawUrl","actualUrl","location","hash","__ResourcePath__","Image","imageEl","src","alt","loading","tabindex","onclick","e","open","onerror","classList","add","Audio","audioEl","controls","Video","videoEl","isIframePattern","Iframe","iframeEl","sandbox","CodeBlock","append","isPlaintext","langClass","toUpperCase","codeEl","DetailsBlock","summary","mdResolver","summaryEl","detailsEl","childrenEl","FormulaBlock","IframeBlock","__IframeCounter__","injectedCodes","srcdoc","getIndent","indentCount","spaceCount","listResolver","currentLine","lines","currentIndent","currentNode","isListPattern","nextLine","shift","nextIndent","isNextOrdered","unshift","quoteResolver","firstLine","quotedContent","l","pattern","tableLineConverter","tableLine","item","trim","tableResolver","headerText","contentLines","contentRows","blockResolverGenerator","targetClass","codeResolver","detailsResolver","formulaResolver","iframeResolver","blockResolver","indexOf","getLines","nodes","keydownEvent","click","backToTop","body","scrollTop","documentElement","eventbus","events","emit","args","targetEvent","handler","apply","on","set","off","delete","handlerIndex","splice","articleEl","querySelector","emptyArticlePlaceHolder","articleRender","Set","structure","headlineItems","cloneNode","level","getHeadlines","resultNodes","innerHTML","style","display","querySelectorAll","onkeydown","renderFormula","texString","render","ParseError","message","replace","katexModule","importTexRenderer","newestItemRenderer","createDate","Date","timestamp","dateEl","Intl","DateTimeFormat","format","titleEl","link","directoryItemRenderer","contentEl","toggle","remove","mainEl","articleList","dirDescriptionEl","pagingComponent","indexRender","indexing","itemResolver","current","total","setPage","directoryDescription","hashChangeEvent","indexDirPath","pathManager","isIn","newestPage","indexPath","pageController","newestIndex","directory","indexFilePath","article","articleContent","status","DOMException","fetchMD","addEventListener","homepagePath","jumpTo","parent","root","pageList","next","prev","targetPage","Number","back","pop","btn","PagingView","elements","super","input","type","min","max","maxPage","prevBtn","nextBtn","labelEl","appendEvent","targetPageStr","value","test","isFirstPage","isLastPage","isOnlyPage","disabled","customElements","define","parentDirBtn","getAttribute","innerText","lightBtn","darkBtn","origin","height","data","getElementById","navigator","serviceWorker","register"],"mappings":"AAAA,IAAIA,EAAa,KAEVC,eAAeC,EAAUC,GAI5B,OAHAH,GAAcA,EAAWI,QACzBJ,EAAa,IAAIK,sBAEJC,MAAMH,EAAM,CAAEI,OAAQP,EAAWO,SACzCC,MAAKP,UACF,MAAMQ,QAAaC,EAAID,OAEvB,OADAT,EAAa,KACNS,KAEVE,OAAMC,IACHC,QAAQC,IAAI,uBAAyBX,GACrCU,QAAQE,MAAMH,GACP,OAEnB,CCjBA,IAAeI,EAAA,CAMXC,SAAU,2CAOVC,MAAO,gBAOPC,OAAQ,0EAORC,SAAU,KAOVC,WAAW,EAMXC,YAAa,CACT,kBACA,eACA,cACA,eACA,aAQJC,eAAe,EAOfC,WAAW,EACXC,aAAc,CAEV,SAQJC,cAAc,EACdC,gBAAiB,GAOjBC,aAAc,GAOdC,YAAa,GAObC,YAAa,IAObC,aAAc,MClGlB,SAASC,EAAY7B,GACjB,MAAM8B,EAASC,SAASC,cAAc,QACtCF,EAAOG,IAAO,aACdH,EAAOI,KAAOlC,EACd+B,SAASI,KAAKC,YAAYN,EAC9B,CAEOhC,eAAeuC,EAAgBC,uaAC5BC,CAAO,iBAAiBD,QAC9BT,EAAY,iBAAiBS,YACjC,CAEA,MAAMV,aAAEA,GAAiBf,EACzB,IAAI2B,EAAQ,KACRC,EAAQ,KAEL3C,eAAe4C,IAClB,SAASC,IAEL,MAAMC,EAAkBC,MAAMC,KAAKC,WAAWC,kBACxCC,EAAmBL,EACpBM,QAAOZ,IAASE,EAAKW,YAAYb,KACjCc,KAAIC,o5MAAQC,CAAO,kCAAkCD,EAAKE,sBAE/DC,QAAQC,IAAIR,GACP5C,MAAKqD,GAAYA,EAASC,SAAQ,CAACC,EAAWC,KAC3C,MAAMvB,EAAOM,EAAgBiB,GACvBC,EAAOF,EAAUG,QACvBvB,EAAKwB,iBAAiB1B,EAAMwB,EAAI,MAEnCzD,MAAK,IAAMmC,EAAKyB,iBAChBzD,OAAMC,GAAOC,QAAQE,MAAMH,IACnC,CAEIsC,WAAWC,iBAAiBkB,OAI7B1B,EACAG,UAKEwB,OAAO,wCACR9D,MAAK+D,GAAU5B,EAAO4B,EAAOL,UAC7B1D,KAAKsC,GACLnC,OAAMC,GAAOC,QAAQE,MAAMH,KACpC,CClCA,SAAS4D,EAAaC,GAQlB,OAJsBC,OAAOC,QAAQF,GAChCpB,QAAO,EAAEuB,EAAGC,KAAgBC,MAAPD,IACrBtB,KAAI,EAAEwB,EAAKF,KAAS,GAAGE,MAHFF,IAAOA,EAAIG,WAAWC,WAAW,IAAM,UAG7BC,CAAkBL,QACjDM,KAAK,IAEd,CAmBe,SAASC,EAAGC,EAASC,EAAQ,GAAIb,EAAM,MAClD,GAAI,aAAcvB,WAAY,CAE1B,GAAgB,SAAZmC,EACA,OAAOnD,SAASqD,eAAeD,GAGnC,MAAME,EAAWtD,SAASC,cAAckD,GAGxC,OAtDR,SAAoBD,EAAIX,GACpB,GAAKA,EAGL,IAAK,MAAOM,EAAKF,KAAQH,OAAOC,QAAQF,QACxBK,IAARD,IAGAA,aAAeY,SACfL,EAAGL,GAAOF,EAEVO,EAAGM,aAAaX,EAAKF,GAGjC,CAsCQc,CAAWH,EAAUf,GAzB7B,SAAuBW,EAAIE,GACvB,GAAIA,aAAmBtC,MAEnB,IAAK,MAAM4C,KAAWN,EAClBF,EAAG7C,YAAYqD,QAEhB,GAAIN,aAAmBO,YAE1BT,EAAG7C,YAAY+C,OACZ,IAAuB,iBAAZA,EAId,MAAMQ,MAAM,+BAAiCR,GAF7CF,EAAGW,YAAcT,CAGpB,CACL,CAWQU,CAAcR,EAAUF,GACjBE,CACf,CAKQ,OAHIF,aAAmBtC,QACnBsC,EAAUA,EAAQH,KAAK,KAEnBE,GACJ,IAAK,OACD,OAAOC,EACX,IAAK,KACL,IAAK,KACD,MAAO,IAAID,KACf,IAAK,MACL,IAAK,QACD,MAAO,IAAIA,KAAWZ,EAAQD,EAAaC,GAAS,MAE5D,MAAO,IAAIY,IAAUZ,EAAQ,IAAMD,EAAaC,GAAS,MAAMa,MAAYD,IAEnF,CCvEe,SAASY,EAAYC,EAAMC,GACtC,IAAKD,EAAKE,SAASD,GACf,OAAO,KAGX,IAAIE,EAAe,GACfC,GAAW,EAEf,KAAOJ,EAAKK,QAAQ,CAChB,MAAMC,EAAKN,EAAKO,MAAM,EAAG,GAGzB,GAFAP,EAAOA,EAAKQ,OAAO,GAER,OAAPF,EAAJ,CAIA,GAAIA,IAAOL,IAAYG,EACnB,MAEJD,GAAgBG,EAChBF,GAAW,CALV,MAFGA,GAAYA,CAQnB,CAED,OAAOD,CACX,CCpBA,MAAMM,EAAuB,IAAIC,IAAI,CACjC,CAAC,IAAK,UACN,CAAC,IAAK,QACN,CAAC,IAAK,KACN,CAAC,IAAK,KACN,CAAC,IAAK,OACN,CAAC,IAAK,YACN,CAAC,IAAK,OACN,CAAC,IAAK,OACN,CAAC,IAAK,eAGJC,EAAiB,IAAID,IAAI,CAC3B,CAAC,IAAK,KACN,CAAC,IAAK,OAKV,MAAME,EACF,WAAAC,CAAYzB,GACR0B,KAAK1B,QAAUA,CAClB,CACD2B,OAAS,IAAM7B,EAAG,OAAQ4B,KAAK1B,SAEnC,MAAM4B,EACF,WAAAH,CAAYI,EAAS7B,GACjB,MAAM8B,EAAMT,EAAqBU,IAAIF,GACrC,GAAIC,EAAIhB,SAAS,KAAM,CACnB,MAAOkB,EAAaC,GAAaH,EAAII,MAAM,KAC3CR,KAAK3B,QAAUiC,EACfN,KAAKO,UAAYA,CAC7B,MACYP,KAAK3B,QAAU+B,EAEnBJ,KAAK1B,QAAUA,EAEQ,SAAnB0B,KAAKO,YAGLrE,WAAWuE,qBAAsB,EAExC,CAED,MAAAR,GACI,MAAMS,OAA8B5C,IAAnBkC,KAAKO,UAA0B,KAAO,CAACI,MAASX,KAAKO,WAEtE,OADenC,EAAG4B,KAAK3B,QAASuC,EAAWZ,KAAK1B,SAAUoC,EAE7D,EAGL,MAAMG,EACF,WAAAd,CAAYzB,EAASwC,GACjBd,KAAK1B,QAAUA,EACf0B,KAAKc,QAAUA,CAClB,CAED,MAAAb,GACI,MAAMc,EAAiBH,EAAWZ,KAAK1B,SACvC,GAAI0B,KAAKc,QAAQE,WAAW,QAExB,OAAO5C,EAAG,IAAK2C,EAAgB,CAC3B1F,KAAM2E,KAAKc,QACXG,OAAQ,WAMhB,OAAO7C,EAAG,IAAK2C,EAAgB,CAC3B1F,KAAM,KAFY,UAAY2E,KAAKc,UAI1C,EAEL,MAAMI,EACF,WAAAnB,CAAYzB,EAAS6C,GACjBnB,KAAK1B,QAAWA,EAChB0B,KAAKmB,SAAWA,CACnB,CACD,MAAAlB,GACI,MAAMmB,EAAyBhD,EAAG,KAAM,KAClCiD,EAA0BjD,EAAG,KAAM,KACnCkD,EAAalD,EAAG,KAAM4B,KAAKmB,UAOjC,OAAO/C,EAAG,OALMwC,EAAWZ,KAAK1B,SAASiD,OAAO,CAC5CH,EACAE,EACAD,IAEuB,CACvB,gBAAiBrB,KAAKmB,UAE7B,EAwIU,SAASP,EAAWY,GAC/B,MAAMC,EApIV,SAAgBD,GACZ,SAASE,IACL,MAAMlC,EAAKgC,EAAOG,OAAO,GAEzB,OADAH,EAASA,EAAOI,UAAU,GACnBpC,CACV,CACD,SAASqC,EAAqBC,GAC1B,IAAIC,EAMJ,MALkB,MAAdD,EACAC,EAAkBlB,EACG,MAAdiB,IACPC,EAAkBb,GAEfa,CACV,CAID,MAAMN,EAAS,GACf,IAAIO,EAAW,GACXC,EAAW,GACXC,EAAW,GACX5C,GAAW,EACX6C,GAAW,EAEf,KAAOX,EAAOjC,QAAQ,CAClB,MAAMC,EAAKkC,IAGX,GAAI/B,EAAqByC,IAAI5C,GAAK,CAC9B,GAAIF,EAAU,CACN6C,EACAF,GAAWzC,EAEXwC,GAAYxC,EAEhB,QACH,CAED,GAAI2C,GAAW3C,GAAM0C,EAAU,CAC3BD,GAAWzC,EACX,QACH,CAED,MAAM6C,EAASX,IACf,GAAIW,GAAU7C,EAAI,CACV2C,EACAF,GAAWzC,EAEXwC,GAAYxC,EAEhBgC,EAASa,EAASb,EAClB,QACH,CAEGW,GACAV,EAAOa,KAAK,IAAIpC,EAASV,EAAIyC,IAC7BA,EAAW,GACXC,EAAW,KAEXT,EAAOa,KAAK,IAAIxC,EAAUkC,IAC1BA,EAAW,GACXE,EAAW1C,GAEf2C,GAAWA,EACX,QACH,CAGD,GAAI,CAAC,IAAK,KAAK/C,SAASI,KAAQ2C,IAAY7C,EAAU,CAClD,MAAMiD,EAAmB/C,EACnBgD,EAAkB3C,EAAeQ,IAAIkC,GAE3Cd,EAAOa,KAAK,IAAIxC,EAAUkC,IAC1BA,EAAW,GAEX,IAAIS,EAAiBF,EAErB,MAAMxB,EAAiB9B,EAAYuC,EAAQgB,GAC3C,GAAsB,MAAlBzB,EAAwB,CACxB0B,GAAkBjB,EAAO/B,MAAM,EAAGsB,EAAexB,OAAS,GAC1DiC,EAASA,EAAO9B,OAAOqB,EAAexB,OAAS,GAE/C,MAAM8C,EAASX,IAEf,GADAe,GAAkBJ,EACH,MAAXA,EAAgB,CAEhB,MAAMK,EAAgBzD,EAAYuC,EAAQ,KAC1C,GAAqB,MAAjBkB,EAAuB,CACvB,IAAIX,EAAkBF,EAAqBU,GAC3Cf,EAASA,EAAO9B,OAAOgD,EAAcnD,OAAS,GAC9CkC,EAAOa,KAAK,IAAIP,EAAgBhB,EAAgB2B,IAChD,QACH,CACJ,CACJ,CACDV,GAAYS,EACZ,QACH,CAID,GAAW,OAAPjD,EAAa,CACbF,GAAYA,EACZ,QACH,CAED,IAAIJ,EACAI,GACAJ,EAAO,KAAOM,EACdF,GAAW,GAEXJ,EAAOM,EAGP2C,EACAF,GAAW/C,EAEX8C,GAAY9C,CAEnB,CAQD,OANI+C,EAAQ1C,QACRkC,EAAOa,KAAK,IAAIpC,EAASgC,EAAUD,IAEnCD,EAASzC,QACTkC,EAAOa,KAAK,IAAIxC,EAAUkC,IAEvBP,CACX,CAGmBkB,CAAOnB,GACtB,IAAIoB,EAAanB,EACZpF,QAAOwG,KAEFA,aAAiB/C,IAAc+C,EAAMvE,QAAQiB,UAClDhD,KAAIsG,GAASA,EAAM5C,WAExB,MAAsB,iBAAX6C,QAAuBtB,IAAWoB,EAAW,GCjP7CpB,IAAUA,EACpBvD,WAAW,IAAK,QAChBA,WAAW,IAAK,QDiPN8E,CAAkBvB,GAEtBoB,CACX,CEpPA,MACMI,EAAW,CAAC,KAAM,MAWnB,MAACC,EAVN,SAAiCzG,GAC7B,IAAK,MAAOQ,EAAOkG,KAAaxF,OAAOC,QAAQqF,GAC3C,GAAIxG,IAAS0G,EACT,MAAO,IAAIC,IAAeA,EAAWnG,GAK7C,OAFAnD,QAAQuJ,KAAK,wBAA0B5G,GAEhC,IAAI2G,IAAeA,EAAW,EACzC,CACyBE,CAZLrJ,EAAOI,UCIpB,MAAMkJ,EACT,WAAAvD,CAAYzB,GAER,MAAMiF,EAAUjF,EAAQkC,MAAM,KACxBgD,EAAgBD,EAAQ,GAC9B,IAAIE,EAAkB,EACtB,IAAK,MAAMjE,KAAMgE,EACF,MAAPhE,IACAiE,GAAmB,GAIvBA,EAAkB,IAClBA,EAAkB,GAGtB,MAAMC,EAAaH,EAAQ9D,MAAM,GAAGtB,KAAK,KACzC6B,KAAK3B,QAAU,IAAMoF,EACrBzD,KAAK1B,QAAUqF,EAAeD,EACjC,CACD,MAAAzD,GACI,MAAM2D,OAAsB9F,IAAZkC,KAAK6D,GACf,KACA,CAAEA,GAAI7D,KAAK6D,IACjB,OAAOzF,EAAG4B,KAAK3B,QAAS2B,KAAK1B,QAASsF,EACzC,CAEDE,eAAiBtC,GAAUA,EAAOuC,MAAM,UAGrC,MAAMC,EACT3F,QAAU,IAEV,WAAA0B,CAAYzB,GACR0B,KAAK1B,QAAUA,EAAQ2F,WAC1B,CACD,MAAAhE,GACI,MAAMiE,EAASP,EAAe3D,KAAK1B,SACnC,OAAOF,EAAG4B,KAAK3B,QAAS6F,EAC3B,EAGE,MAAMC,EACT9F,QAAU,aACV+F,SAAW,GAEX,WAAArE,CAAYqE,GACRpE,KAAKoE,SAAWA,CACnB,CACD,MAAAnE,GACI,MAAMoE,EAAarE,KAAKoE,SACnB7H,KAAI+H,GAAQA,EAAKrE,WACtB,OAAO7B,EAAG4B,KAAK3B,QAASgG,EAC3B,CAEDP,eAAiBtC,GACD,MAAXA,GAAmBA,EAAOR,WAAW,MAGvC,MAAMuD,EACTtE,OAAS,IAAM7B,EAAG,MAClB0F,eAAiBtC,GACbA,EAAOuC,MAAM,gCAAkCvC,EAAOuC,MAAM,eAG7D,MAAMS,EACTJ,SAAW,GAEX,WAAArE,CAAYzB,GACR0B,KAAKyE,UAAYC,QAAQF,EAAKG,eAAerG,IAC7C0B,KAAK3B,QAAa2B,KAAc,UAAI,KAAO,KAC3CA,KAAKoE,SAAY,CAACI,EAAKI,WAAWtG,EAAS0B,KAAKyE,WACnD,CAEDnC,KAAOuC,GAAS7E,KAAKoE,SAAS9B,KAAKuC,GAEnC,MAAA5E,GACI,MAAM6E,EAAe,GACrB,IAAK,MAAMD,KAAS7E,KAAKoE,SACrB,GAAqB,iBAAVS,EAAoB,CAC3B,MAAMX,EAASP,EAAekB,GAC9BC,EAAaxC,KAAKlE,EAAG,KAAM8F,GAC3C,MACgBY,EAAaxC,KAAKuC,EAAM5E,UAGhC,OAAO7B,EAAG4B,KAAK3B,QAASyG,EAC3B,CAEDhB,wBAA2BtC,GAAWkD,QAAQlD,EAAOuC,MAAM,qBAC3DD,sBAAyBtC,GAAWkD,QAAQlD,EAAOuC,MAAM,uBAEzDD,qBAAwBtC,GACpBgD,EAAKG,eAAenD,IAAWgD,EAAKO,iBAAiBvD,GAEzD,iBAAOoD,CAAWI,EAAMP,GACpB,OAAIA,EAEOO,EAAKjB,MAAM,+BAA+B,GAG1CiB,EAAKjB,MAAM,6BAA6B,EAEtD,EAGE,MAAMkB,EACTC,YAAc,CAAC,IACfC,SAAc,CAAC,CAAC,KAEhB,WAAApF,CAAYmF,EAAaC,GACrBnF,KAAKkF,YAAcA,EACnBlF,KAAKmF,SAAcA,CACtB,CAEDC,GAAmB9G,GAAWF,EAAG,KAAME,GACvC+G,GAAmB/G,GAAWF,EAAG,KAAMuF,EAAerF,IACtDgH,GAAmBC,GAAOnH,EAAG,KAAMmH,EAAIhJ,IAAIyD,MAAKoF,IAChDI,GAAmBD,GAAOnH,EAAG,KAAMmH,EAAIhJ,IAAIyD,MAAKqF,IAEhD,MAAApF,GACI,MAAMwF,EAAcrH,EAChB,QACA4B,MAAKsF,EAAgBtF,KAAKkF,cAExBQ,EAAYtH,EACd,QACA4B,KAAKmF,SACA5I,IAAIyD,MAAKwF,IAElB,OAAOpH,EAAG,MAAOA,EAAG,QAAS,CAACqH,EAAaC,IAAa,CACpD/E,MAAS,SAEhB,CAEDmD,eAAiBtC,GAAUA,EAAOR,WAAW,MAOjD,MAAM2E,EACFnE,OAAS,GACToE,YAAc,GACd,WAAA7F,CAAY8F,GACRA,EAASA,EAAOnG,OAAO,GACvBM,KAAK4F,YAAc3G,EAAY4G,EAAQ,KACvCA,EAASA,EAAOnG,OAAOM,KAAK4F,YAAYrG,OAAS,GACjDS,KAAKwB,OAASvC,EAAY4G,EAAQ,IACrC,CAED,yBAAOC,CAAmBxH,GACtB,OAAOF,EAAG,MAAOE,EAAS,CACtBqC,MAAS,mBAEhB,CAED,uBAAOoF,CAAiBC,GACpB,OAAQxE,GACJA,EAAOR,WAAWgF,EAAiB,MAAQxE,EAAOyE,SAAS,IAClE,CAED,8BAAOC,CAAwB7K,EAAMuK,GAGjC,MADuB,GAAGA,QADPxH,EAAG,IAAK6E,EAAiB,SAAU,kBAAmB,CAAE5H,UAG9E,CAED,qBAAO8K,CAAeC,GAClB,IAAIC,EACJ,GAAID,EAAOpF,WAAW,QAClBqF,EAAYD,OAEZ,GAAI,aAAclK,WAAY,CAK1BmK,EAHaC,SAASC,KAAK9G,MAAM,GAERe,MAAM,KAAKf,MAAM,GAAI,GAAGtB,KAAK,KAC5B,IAAMiI,CAChD,KAAmB,CAGHC,EADanK,WAAWsK,iBACL,IAAMJ,CAC5B,CAEL,OAAOC,CACV,EAGE,MAAMI,UAAcd,EACvB7B,eAAiB6B,EAAUI,iBAAiB,KAE5C,MAAA9F,GACI,MACMyG,EAAUtI,EAAG,MAAO,GAAI,CAC1BuI,IAFchB,EAAUQ,eAAenG,KAAKwB,QAG5CoF,IAAK5G,KAAK4F,YACViB,QAAS,OACTC,SAAU,IAad,MAXsB,iBAAXhE,SAEP4D,EAAQK,QAAUC,GACdlE,OAAOmE,KAAKD,EAAE/F,OAAO0F,KACzBD,EAAQQ,QAAUF,IACd,MAAM/F,EAAS+F,EAAE/F,OACjBA,EAAO8F,QAAU,KACjB9F,EAAO/G,MAAQ8F,KAAK4F,YACpB3E,EAAOkG,UAAUC,IAAI,aAAa,GAGnCzB,EAAUG,mBAAmBY,EACvC,EAGE,MAAMW,UAAc1B,EACvB7B,eAAiB6B,EAAUI,iBAAiB,KAE5C,MAAA9F,GACI,MAAMoG,EAAYV,EAAUQ,eAAenG,KAAKwB,QAE1C8F,EAAUlJ,EAAG,QADIuH,EAAUO,wBAAwBG,EAAWrG,KAAK4F,aAC7B,CACxCe,IAAKN,EACLkB,UAAU,IAEd,OAAO5B,EAAUG,mBAAmBwB,EACvC,EAGE,MAAME,UAAc7B,EACvB7B,eAAiB6B,EAAUI,iBAAiB,KAE5C,MAAA9F,GACI,MAAMoG,EAAYV,EAAUQ,eAAenG,KAAKwB,QAE1CiG,EAAUrJ,EAAG,QADIuH,EAAUO,wBAAwBG,EAAWrG,KAAK4F,aAC7B,CACxCe,IAAKN,EACLkB,SAAU,SAEd,OAAO5B,EAAUG,mBAAmB2B,EACvC,EAGE,MAAMC,EAAmBlG,GAC5BmE,EAAUI,iBAAiB,IAA3BJ,CAAgCnE,IAC7BA,EAAOR,WAAW,OAElB,MAAM2G,UAAehC,EACxB,MAAA1F,GACI,MAAMoG,EAAYV,EAAUQ,eAAenG,KAAKwB,QAC1CoG,EAAWxJ,EAAG,SAAU4B,KAAK4F,YAAa,CAC5Ce,IAAKN,EACLnM,MAAO8F,KAAK4F,YACZiC,QAAS,gBACThB,QAAS,SAEb,OAAOlB,EAAUG,mBAAmB8B,EACvC,EAWE,MAAME,EACT,WAAA/H,CAAYzB,EAAS9B,GACjBwD,KAAKxD,KAAOA,EACU,iBAAXsG,OAEP9C,KAAK1B,QAAUA,EAGf0B,KAAK1B,QAAUA,EACVL,WAAW,IAAK,QAChBA,WAAW,IAAK,OAE5B,CACD,MAAA8J,CAAOzJ,GACH0B,KAAK1B,SAAWA,CACnB,CACD,MAAA2B,GACI,MAAM+H,EAAc,CAAC,YAAa,OAAQ,IAAI5I,SAASY,KAAKxD,MAK5D,IAAI0G,EACA+E,EALkB,iBAAXnF,QAAwBkF,GAC/B9L,WAAWC,iBAAiBiL,IAAIpH,KAAKxD,MAKrCwL,GACAC,EAAY,cACZ/E,EAAY,cAEZ+E,EAAY,YAAYjI,KAAKxD,OAC7B0G,EAAYlD,KAAKxD,KAAK0L,eAG1B,MAAMC,EAAS/J,EAAG,OAAQ4B,KAAK1B,QAAS,CACpCqC,MAASsH,EACTnB,SAAU,IAEd,OAAO1I,EAAG,MAAO+J,EAAQ,CACrB,gBAAiBjF,GAExB,CAEDY,eAAiBtC,GAAUA,EAAOR,WAAW,OAG1C,MAAMoH,EACTC,QAAU,GACV/J,QAAU,GAEV,WAAAyB,CAAYzB,EAAS+J,GACjBrI,KAAKqI,QAAUA,EACfrI,KAAK1B,QAAUgK,EAAWhK,EAC7B,CACD,MAAA2B,GACI,MAAMsI,EAAYnK,EAAG,UAAW4B,KAAKqI,SAC/BG,EAAYpK,EAAG,UAAWmK,GAI1BE,EAAarK,EAAG,MAAOA,EAAG,MAFb4B,KAAK1B,QACnB/B,KAAI+H,GAAQA,EAAKrE,WAC6B,CAC/CU,MAAS,qBACT,CACAA,MAAS,+BAEb,OAAOvC,EAAG,MAAO,CAACoK,EAAWC,GAAa,CACtC9H,MAAS,WAEhB,CAEDmD,eAAiBtC,GACbA,EAAOR,WAAW,OAGnB,MAAM0H,EACTpK,QAAU,GACVsH,YAAc,GAEd,WAAA7F,CAAYzB,EAASsH,GACjB5F,KAAK1B,QAAUA,EACf0B,KAAK4F,YAAcA,CACtB,CACD,MAAA3F,GAEI,OADA/D,WAAWuE,qBAAsB,EAC1BrC,EAAG,MAAO4B,KAAK1B,QAAS,CAC3BqC,MAAS,OACTzG,MAAO8F,KAAK4F,aAEnB,CAED9B,eAAiBtC,GACbA,EAAOR,WAAW,OAGnB,MAAM2H,EAET7E,SAAwBD,GAAM,yWAgBnBA,gNAWX,WAAA9D,CAAYzB,EAASsH,GACjB1J,WAAW0M,mBAAqB,EAChC5I,KAAK6D,GAAK,UAAY3H,WAAW0M,kBACjC5I,KAAK4F,YAAcA,EAEG,iBAAX9C,OAEP9C,KAAK1B,QAAUA,EAAUqK,GAAYE,EAAe7I,KAAK6D,IAGzD7D,KAAK1B,QAAUA,CAEtB,CAED,MAAA2B,GACI,MAAM2H,EAAWxJ,EAAG,SAAU4B,KAAK4F,YAAa,CAC5C/B,GAAI7D,KAAK6D,GACT3J,MAAO8F,KAAK4F,YACZkD,OAAQ9I,KAAK1B,QACbuJ,QAAS,kBAEb,OAAOlC,EAAUG,mBAAmB8B,EACvC,EClaU,SAAQmB,EAAC/D,GACpB,IAAIgE,EAAc,EACdC,EAAa,EAEjB,IAAK,MAAMzJ,KAAMwF,EAAM,CACnB,GAAIxF,EAAGuE,MAAM,WACT,MAGO,OAAPvE,GAIO,MAAPA,IACAyJ,GAAc,GAEC,IAAfA,IACAA,EAAa,EACbD,GAAe,IARfA,GAAe,CAUtB,CACD,OAAOA,CACX,CCnBe,SAASE,EAAaC,EAAaC,GAC9C,MAAMC,EAAgBN,EAAUI,GAC1BG,EAAc,IAAI9E,EAAK2E,GAE7B,KAAOC,EAAM7J,QAAUiF,EAAK+E,cAAcH,EAAM,KAAK,CACjD,MAAMI,EAAWJ,EAAMK,QACjBC,EAAaX,EAAUS,GACvBG,EAAgBnF,EAAKG,eAAe6E,GAE1C,GAAIE,EAAaL,EACbC,EAAYhH,KAAK4G,EAAaM,EAAUJ,QACrC,IAAIM,IAAeL,GAAiBM,IAAkBL,EAAY7E,UAElE,CACH2E,EAAMQ,QAAQJ,GACd,KACH,CAJGF,EAAYhH,KAAKkC,EAAKI,WAAW4E,EAAUG,GAI9C,CACJ,CACD,OAAOL,CACX,CCnBe,SAAAO,EAASC,EAAWV,GAC/B,IAAIW,EAAgBD,EAAUrK,MAAM,GAAK,KAEzC,KAAO2J,EAAM7J,QAAQ,CACjB,MAAMyK,EAAIZ,EAAMK,QAEhB,IAAItF,EAAM8F,QAAQD,GAEX,CACHZ,EAAMQ,QAAQI,GACd,KACH,CAJGD,GAAiBC,EAAEvK,MAAM,GAAK,IAKrC,CACD,MAAM2E,EAAWkE,EAAWyB,GAE5B,OADa,IAAI5F,EAAMC,EAE3B,CCfA,SAAS8F,EAAmBC,GAKxB,OAJgBA,EAAU3J,MAAM,KAE3BnE,QAAO+N,GAAQA,EAAK7K,OAAS,IAC7BhD,KAAI6N,GAAQA,EAAKC,QAE1B,CAEe,SAAAC,EAASR,EAAWV,GAC/B,MAAMmB,EAAaT,EACbU,EAAe,GAErB,KAAOpB,EAAM7J,QAAQ,CACjB,MAAMyK,EAAIZ,EAAMK,QAEhB,IAAIxE,EAAMgF,QAAQD,GAEX,CACHZ,EAAMQ,QAAQI,GACd,KACH,CAJGQ,EAAalI,KAAK0H,EAKzB,CAED,MAAM9E,EAAcgF,EAAmBK,GACjCE,EAAcD,EAAajO,IAAI2N,GAErC,OADkB,IAAIjF,EAAMC,EAAauF,EAE7C,CC7BA,SAASC,EAAuBvL,EAASwL,GACrC,OAAO,SAASb,EAAWV,GACvB,MAAMxD,EAAckE,EAAUrK,MAAM,GAEpC,IAAInB,EAAU,GACd,KAAO8K,EAAM7J,QAAQ,CACjB,MAAMyK,EAAIZ,EAAMK,QAEhB,GAAIO,IAAM7K,EACN,MAGJb,GAAW0L,EAAI,IAClB,CACD,OAAO,IAAIW,EAAYrM,EAASsH,EACnC,CACL,CAEO,MAAMgF,EAAeF,EAAuB,MAAO5C,GAC7C+C,EAAkBH,EAAuB,MAAOtC,GAChD0C,EAAkBJ,EAAuB,MAAOhC,GACtD,SAASqC,EAAejB,EAAWV,GACtC,MAAM4B,EAAgBN,EAAuB,MAAO/B,GAEpD,OAAKmB,EAAU9I,WAAW,OAInBgK,EAAclB,EAAWV,GAFrB,IAAIzB,EAAOmC,EAG1B,CCjBe,SAASxB,EAAW9G,GAC/B,MAAM4H,ECfK,SAAS5H,GACpB,OAA6B,GAAzBA,EAAOyJ,QAAQ,MACRzJ,EAAOhB,MAAM,QAEbgB,EAAOhB,MAAM,KAE5B,CDSkB0K,CAAS1J,GACjB2J,EAAQ,GAEd,KAAO/B,EAAM7J,QAAQ,CACjB,MAAMyK,EAAIZ,EAAMK,QAEXO,EAAEzK,SAKH+D,EAAS2G,QAAQD,GACjBmB,EAAM7I,KAAK,IAAIgB,EAAS0G,IAExBzF,EAAQ0F,QAAQD,GAChBmB,EAAM7I,KAAK,IAAIiC,GAEfJ,EAAM8F,QAAQD,GACdmB,EAAM7I,KAAKuH,EAAcG,EAAGZ,IAE5B5E,EAAK+E,cAAcS,GACnBmB,EAAM7I,KAAK4G,EAAac,EAAGZ,IAE3BnE,EAAMgF,QAAQD,GACdmB,EAAM7I,KAAKgI,EAAcN,EAAGZ,IAE5B3C,EAAMwD,QAAQD,GACdmB,EAAM7I,KAAK,IAAImE,EAAMuD,IAErB3C,EAAM4C,QAAQD,GACdmB,EAAM7I,KAAK,IAAI+E,EAAM2C,IAErBxC,EAAMyC,QAAQD,GACdmB,EAAM7I,KAAK,IAAIkF,EAAMwC,IAErB5B,EAAa6B,QAAQD,GACrBmB,EAAM7I,KAAKuI,EAAgBb,EAAGZ,IAE9BV,EAAauB,QAAQD,GACrBmB,EAAM7I,KAAKwI,EAAgBd,EAAGZ,IAE9BtB,EAAUmC,QAAQD,GAClBmB,EAAM7I,KAAKsI,EAAaZ,EAAGZ,IAE3B1B,EAAgBsC,GAChBmB,EAAM7I,KAAKyI,EAAef,EAAGZ,IAE7B+B,EAAM7I,KAAK,IAAI0B,EAAKgG,IAE3B,CACD,OAAOmB,CACX,CElEe,SAAQC,EAAChN,GACpB,OAAO,SAAS4I,GAEE,UAAVA,EAAEjJ,KAA6B,MAAViJ,EAAEjJ,KACvBK,EAAGiN,OAEV,CACL,CCNe,SAAAC,IACXpQ,SAASqQ,KAAKC,UAAY,EAC1BtQ,SAASuQ,gBAAgBD,UAAY,CACzC,CCHK,MAACE,EAAW,ICDF,MAEXC,OAAS,IAAI/L,IAQb,IAAAgM,CAAKnQ,KAASoQ,GACV,MAAMC,EAAc9L,KAAK2L,OAAOtL,IAAI5E,GAEhCqQ,GACAA,EAAYhP,SAASiP,IACjBA,EAAQC,MAAM,KAAMH,EAAK,GAGpC,CAQD,EAAAI,CAAGxQ,EAAMsQ,GACL,MAAMD,EAAc9L,KAAK2L,OAAOtL,IAAI5E,GAEhCqQ,EACAA,EAAYxJ,KAAKyJ,GAEjB/L,KAAK2L,OAAOO,IAAIzQ,EAAM,CAACsQ,GAE9B,CAQD,GAAAI,CAAI1Q,EAAMsQ,GACN,MAAMD,EAAc9L,KAAK2L,OAAOtL,IAAI5E,GAEpC,GAAIqQ,EACA,GAA2B,IAAvBA,EAAYvM,OACZS,KAAK2L,OAAOS,OAAO3Q,OAChB,CACH,MAAM4Q,EAAeP,EAAYb,QAAQc,GACzCD,EAAYQ,OAAOD,EAAc,EACpC,CAER,GC5CCE,EAAYrR,SAASsR,cAAc,WACnCC,EAA0BxJ,EAAiB,MAAO,iBAsBzC,SAASyJ,EAAcH,EAAW1G,GAE7C3J,WAAWC,iBAAmB,IAAIwQ,IAElCzQ,WAAWuE,qBAAsB,EAEjCvE,WAAW0M,kBAAoB,EAE/B,MAAMgE,EAAYtE,EAAWzC,GACH,CACtB,MAAMgH,EAvBd,SAAsBD,GAClB,OAAOA,EACFvQ,QAAOiI,GAAQA,aAAgBhB,IAC/B/G,KAAI,CAAC+H,EAAMtH,KAGD,CACH6G,GAHOS,EAAKT,GAAK,YAAc7G,EAG3BsB,QAFQgG,EAAKhG,QAAQ/B,KAAI6B,GAAMA,EAAG0O,WAAU,KAGhDC,MAAOzI,EAAKjG,WAG5B,CAY8B2O,CAAaJ,GACnClB,EAASE,KAAK,mBAAoBiB,EACrC,CAED,IAAII,EAAcL,EAAUrQ,KAAI+H,GAAQA,EAAKrE,WACxCgN,EAAY1N,SACb0N,EAAc7O,GAAG,KAAMqO,IAK3BF,EAAUW,UAAY,GACtBD,EAAYnQ,SAAQsB,GAAMmO,EAAUhR,YAAY6C,KAEhDmO,EAAUY,MAAMC,QAAU,QAC1Bb,EAAUc,iBAAiB,kBAAkBvQ,SAASsB,IAClDA,EAAGkP,UAAYlC,EAAahN,EAAG,IAEnCkN,IAEAzP,IAAoBrC,MAAK,IAAM0C,WAAWC,iBAAmB,OlBV1DlD,iBACH,SAASsU,IAELrS,SAASmS,iBAAiB,SACrBvQ,SAAQsB,IACL,MAAMoP,EAAYpP,EAAGW,YACrB,IACInD,EAAM6R,OAAOD,EAAWpP,EAAIrD,EAC/B,CAAC,MAAMiM,GACJ,KAAIA,aAAapL,EAAM8R,YAMnB,MAAM1G,EAJN5I,EAAG8O,WAAa,mBAAqBM,EAAY,MAAQxG,EAAE2G,SACtDC,QAAQ,KAAM,SAASA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,OAKvE,IAEZ,CAED,GAAK1R,WAAWuE,oBAIhB,GAAI7E,EACA2R,QADJ,CAMAvS,EAAY,mCACZ,IACI,MAAM6S,QAAoBvQ,OAAO,6BACjC1B,EAAQiS,EAAY3Q,QACpBqQ,GACH,CAAC,MAAMvG,GACJnN,QAAQE,MAAMiN,EACjB,CAVA,CAWL,CkB5BI8G,GAAoBtU,MAAK,IAAM0C,WAAWuE,qBAAsB,GACpE,CC5DO,SAASsN,GAAmB3D,GAC/B,MAAM4D,EAAa,IAAIC,KAAK7D,EAAK8D,WAE3BC,EAAU/P,EAAG,QADE,IAAIgQ,KAAKC,gBAAiBC,OAAON,IAEhDO,EAAUnQ,EAAG,OAAQgM,EAAKlQ,MAAO,CACnCyG,MAAS,qBAEb,OAAOvC,EAAG,KACN,CAAC+P,EAAQ/P,EAAG,OAAQ,MAAOmQ,GAC3B,CACIzH,SAAU,EACVnG,MAAS,oBACT,mBAAoByJ,EAAKoE,MAGrC,CACO,SAASC,GAAsBrE,GAClC,MAAMsE,EAAYtQ,EAAG,OAAQgM,EAAM,CAC/BzJ,MAAS,qBAEb,OAAOvC,EAAG,KAAMsQ,EAAW,CACvB/N,MAAS,oBACTmG,SAAU,GAElB,CDhBA4E,EAASO,GAAG,kBAAkB,KAC1BM,EAAUpF,UAAUwH,OAAO,eAAe,IAE9CjD,EAASO,GAAG,kBAAkB,KAC1BM,EAAUpF,UAAUyH,OAAO,eAAe,ICc9C,MAAMC,GAAmB3T,SAASsR,cAAc,QAC1CD,GAAmBrR,SAASsR,cAAc,WAC1CsC,GAAmBD,GAAOrC,cAAc,iBACxCuC,GAAmBF,GAAOrC,cAAc,0BACxCwC,GAAmBH,GAAOrC,cAAc,eAE/B,SAASyC,GAAYC,EAAUC,GAC1C,MAAMC,QAACA,EAAOC,MAAEA,GAASH,EACzBF,GAAgBM,QAAQF,EAASC,GAKjCN,GAAiB7B,UAAY,GACzB,yBAA0BgC,GAC1BxC,EAAcqC,GAAkBG,EAASK,sBAI7CT,GAAY5B,UAAY,GACxBgC,EAAS5Q,QACJ/B,IAAI4S,GACJrS,SAAQsB,GACL0Q,GAAYvT,YAAY6C,KAIhC0Q,GAAYzB,iBAAiB,kBAAkBvQ,SAASsB,IACpDA,EAAGkP,UAAYlC,EAAahN,EAAG,IAKnCmO,GAAUY,MAAMC,QAAU,OAC1ByB,GAAO1B,MAAMC,QAAU,QAGvBlS,SAASqQ,KAAKC,UAAY,EAC1BtQ,SAASuQ,gBAAgBD,UAAY,CACzC,CChEOvS,eAAeuW,GAAgB5R,GAClC,MAAMiR,EAAS3T,SAASsR,cAAc,QAChCD,EAAYrR,SAASsR,cAAc,WACnCiD,EAAe,YAErB,IAAKnJ,SAASC,KAEV,YADAmJ,GAAYzV,WAGhB,MAAMsM,EAAOD,SAASC,KAAK9G,MAAM,GAGjC,GAFAoP,EAAO1H,UAAUC,IAAI,YAEjBsI,GAAYC,KAAKC,aAAc,CAE/B,MAAMC,EAAYJ,EACZ,UACAK,GAAeV,UACfW,QAAoB7W,EAAU2W,GACpC,IAAKE,EAAa,OAClBd,GAAYc,EAAahC,GAC5B,MACD,GAAI2B,GAAYC,KAAKK,YAAa,CAE9B,MACMC,EAAgBR,EADNlJ,EAAK/F,MAAM,KAAKf,MAAM,GAAI,GAE5BtB,KAAK,KAAO,IACpB2R,GAAeV,UACfpS,QAAc9D,EAAU+W,GAC9B,IAAKjT,EAAO,OACZiS,GAAYjS,EAAOyR,GACtB,MACD,GAAIiB,GAAYC,KAAKO,UAAW,CAE5B,MAAMC,QtBnBPlX,eAAuBE,GAI1B,OAHAH,GAAcA,EAAWI,QACzBJ,EAAa,IAAIK,sBAEJC,MAAMH,EAAM,CAAEI,OAAQP,EAAWO,SACzCC,MAAKP,UACF,GAAkB,KAAdS,EAAI0W,OACJ,MAAM1W,EAAI0W,OAEd,MAAMlR,QAAaxF,EAAIwF,OAEvB,OADAlG,EAAa,KACNkG,KAEVvF,OAAMC,IACH,GAAkB,iBAAPA,EAEP,OADAC,QAAQE,MAAMH,GACP,KAGX,OAAQA,GAEJ,KAAK,IACD,MAAO,kBACX,KAAK,IACD,MAAO,8BACX,KAAKyW,aACDxW,QAAQE,MAAMH,GACd,MACJ,QAGI,OAFAC,QAAQC,IAAI,2BAA6BX,GACzCU,QAAQE,MAAMH,GACP,6BACd,GAEb,CsBfqC0W,CAAQ,KAAO/J,GAC5C,IAAK4J,EAAgB,OACrBtB,EAAO1B,MAAMC,QAAU,OACvBV,EAAcH,EAAW4D,EACjC,MACQT,GAAYzV,WAGhB4U,EAAOnQ,aAAa,eAAyB,YAAT6H,GACpCsI,EAAO1H,UAAUyH,OAAO,WAC5B,CAEA9L,OAAOyN,iBAAiB,aAAcf,IACtC1M,OAAOyN,iBAAiB,OAAQf,IAEhC,MAAMgB,GAAe,UAEfd,GAAc,CAChB,QAAAzV,GACIqM,SAASC,KAAOiK,EACnB,EAED,IAAAvJ,CAAKxL,GACD6K,SAASC,MAAQ9K,CACpB,EACD,MAAAgV,CAAOxP,GACHqF,SAASC,KAAOtF,CACnB,EACD,MAAAyP,GACI,GAAI1Q,KAAK2P,KAAKgB,QAAU3Q,KAAK2P,KAAKC,aAC9B,OAAOY,GAEX,MAAMjN,EAAU+C,SAASC,KAAK9G,MAAM,GAAGe,MAAM,KAC7C,GAAIR,KAAK2P,KAAKK,YACV,OAAOzM,EAAQ9D,MAAM,GAAI,GAAGtB,KAAK,KAAO,IAE5C,GAAI6B,KAAK2P,KAAKO,UACV,OAAO3M,EAAQ9D,MAAM,GAAI,GAAGtB,KAAK,KAAO,IAE5C,MAAM,IAAIW,MAAM,oBAAsBwH,SAASC,KAClD,EACDoJ,KAAM,CACFgB,KAAI,IACOrK,SAASC,OAAS,IAAMiK,GAEnCZ,WAAU,IACmB,aAAlBtJ,SAASC,KAEpByJ,UAAS,IACE1J,SAASC,KAAKvF,WAAW,YACzBsF,SAASC,KAAKN,SAAS,KAElCiK,QAAO,IACI5J,SAASC,KAAKvF,WAAW,YACzBsF,SAASC,KAAKN,SAAS,SCnE1C,MAAM6J,GAAiB,IArBvB,MACIc,GAAY,CAAC,GAEbxB,QAAU,IAAMpP,MAAK4Q,EAAU5Q,KAAKT,SAAW,GAC/CsR,KAAU,IAAM7Q,MAAK4Q,EAAU5Q,KAAKT,SAAW,IAAM,EACrDuR,KAAU,IAAM9Q,MAAK4Q,EAAU5Q,KAAKT,SAAW,IAAM,EACrDkR,OAAUM,GAAc/Q,MAAK4Q,EAAU5Q,KAAKT,SAAW,GAAKyR,OAAOD,GACnExR,OAAU,IAAMS,MAAK4Q,EAAUrR,OAE/B,IAAA0R,GAEIjR,MAAK4Q,EAAUM,MACVlR,MAAK4Q,EAAUrR,QAChBS,MAAK4Q,EAAUtO,KAAK,EAE3B,CACD,IAAA2E,GAEIjH,MAAK4Q,EAAUtO,KAAK,EACvB,GAOC6O,GAAM7S,GAAWF,EACnB,SACAA,EAAG,OAAQE,GAAU,CACrBqC,MAAS,aAGb,MAAMyQ,WAAmBvS,YACrBwS,GAAY,CAAE,EAEd,WAAAtR,GACIuR,QAEAtR,MAAKqR,EAAUE,MAAQnT,EAAG,QAAS,IAAK,CACpCoT,KAAM,SACNC,IAAK,EACLC,IAAK,IAET1R,MAAKqR,EAAUM,QAAUvT,EAAG,OAAQ,KACpC,MAAMwT,EAAU5R,MAAKqR,EAAUO,QAAUT,GAAIlO,EAAiB,MAAO,SAC/D4O,EAAU7R,MAAKqR,EAAUQ,QAAUV,GAAIlO,EAAiB,MAAO,SACrE2O,EAAQ/N,GAAK,WACbgO,EAAQhO,GAAK,WACb,MAAMiO,EAAU1T,EAAG,QAAS,CACxB4B,MAAKqR,EAAUE,MACfnT,EAAG,OAAQ,KACX4B,MAAKqR,EAAUM,UAEnB3R,MAAK+R,IACL,IAAK,MAAM3T,IAAM,CAACwT,EAASE,EAASD,GAChC7R,KAAKzE,YAAY6C,EAExB,CACD,EAAA2T,GACI/R,MAAKqR,EAAUE,MAAMhB,iBAAiB,WAAWvJ,IAC7C,GAAc,UAAVA,EAAEjJ,IACF,OAEJ,MAAMiU,EAAgBhL,EAAE/F,OAAOgR,MAC/B,IAAK,QAAQC,KAAKF,GAEd,YADAhL,EAAE/F,OAAOgR,MAAQ,GAGrB,MAAMlB,EAAaC,OAAOgB,GACpBjB,EAAa,GAAKA,GAAc/Q,MAAKqR,EAAUE,MAAMG,KAI3D5B,GAAeW,OAAOM,GACtBvB,MAJIxI,EAAE/F,OAAOgR,MAAQ,CAIJ,IAErBjS,MAAKqR,EAAUO,QAAQrB,iBAAiB,SAAS,KACzCT,GAAeV,UAAY,IAC3BU,GAAegB,OACftB,KACH,IAELxP,MAAKqR,EAAUQ,QAAQtB,iBAAiB,SAAS,KACzCT,GAAeV,UAAYpP,MAAKqR,EAAUE,MAAMG,MAChD5B,GAAee,OACfrB,KACH,GAER,CACD,OAAAF,CAAQF,EAASC,GACb,IAAI8C,GAAc,EACdC,GAAc,EACdC,GAAc,EACJ,IAAVhD,EACAgD,GAAa,GAEG,IAAZjD,IACA+C,GAAc,GAEd/C,IAAYC,IACZ+C,GAAa,IAGrBpS,MAAKqR,EAAUO,QAAQU,SAAWD,GAAcF,EAChDnS,MAAKqR,EAAUQ,QAAQS,SAAWD,GAAcD,EAChDpS,MAAKqR,EAAUM,QAAQ5S,YAAcsQ,EACrCrP,MAAKqR,EAAUE,MAAMU,MAAQ7C,EAC7BpP,MAAKqR,EAAUE,MAAMG,IAAQrC,EAC7BrP,KAAKmH,UAAUwH,OAAO,SAAU0D,EACnC,EAELE,eAAeC,OAAO,cAAepB,sDChHrC,MAAMvC,GAAe3T,SAASsR,cAAc,QACtCiG,GAAe5D,GAAOrC,cAAc,oBACpCsC,GAAeD,GAAOrC,cAAc,iBAE1CiG,GAAalC,iBAAiB,SAAS,KACnCT,GAAemB,OACfvB,GAAYe,OAAOf,GAAYgB,SAAS,IAE5C5B,GAAYyB,iBAAiB,SAASvJ,IAClC,MAAM/F,EAAS+F,EAAE/F,OAEbA,IAAW6N,KAMV7N,EAAOyR,aAAa,qBAQrB5C,GAAe7I,OACfyI,GAAYe,OAAOxP,EAAOyR,aAAa,uBARnCzR,EAAO0R,UAAU1M,SAAS,MAE1B6J,GAAe7I,OAEnByI,GAAYzI,KAAKhG,EAAO0R,YAK3B,ICrBDnX,EAAgB,OAGhBA,EAAgB,WAGpB,MAAMoX,GAAW1X,SAASsR,cAAc,cAClCqG,GAAU3X,SAASsR,cAAc,aACvCoG,GAAStF,UAAYlC,EAAawH,IAClCC,GAAQvF,UAAYlC,EAAayH,IAEjC/P,OAAOyN,iBAAiB,YAAY,KAC5BjK,SAASC,KAAKN,SAAS,MAEvB6J,GAAemB,MAClB,IAELnO,OAAOyN,iBAAiB,WAAWvJ,IAC/B,GAAgB,QAAZA,EAAE8L,OACF,OAEJ,MAAMjP,GAAEA,EAAEkP,OAAEA,GAAW/L,EAAEgM,KACF9X,SAAS+X,eAAepP,GAChCsJ,MAAM4F,OAASA,EAAS,IAAI,IAG3C,kBAAmBG,WAEnBA,UAAUC,cACLC,SAAS,WACTzZ,OAAM,SAASI,GAEZF,QAAQE,MAAM,4BAA8BA,EACxD"}